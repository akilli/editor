var Js=Object.defineProperty;var h=(r,t,e)=>(typeof t!="symbol"&&(t+=""),t in r?Js(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e),gt=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)},u=(r,t,e)=>(gt(r,t,"read from private field"),e?e.call(r):t.get(r)),E=(r,t,e,i)=>(gt(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),m=(r,t,e)=>(gt(r,t,"access private method"),e);var I,v,bt=class{constructor(t,e,i=null){I.set(this,void 0);v.set(this,void 0);h(this,"_tag",null);h(this,"_dialog",null);if(!(t instanceof L)||!e||typeof e!="string"||i&&typeof i!="string")throw"Invalid argument";E(this,I,t),E(this,v,e),this._tag=i?this.editor.tags.get(i):null,this._dialog=this.editor.dialogs.get(e)}get editor(){return u(this,I)}get name(){return u(this,v)}execute(){this._dialog?this._openDialog():this._insert(this._selectedAttributes())}_insert(t={}){if(this._tag){Object.keys(t).forEach(i=>this._tag.attributes.includes(i)&&t[i]||delete t[i]);let e=this._selectedElement();this._tag.group!=="format"?this.editor.insert(this.editor.createElement(this._tag.name,{attributes:t})):e&&Object.keys(t).length>0?e.parentElement.replaceChild(this.editor.createElement(this._tag.name,{attributes:t,html:e.textContent}),e):e?e.parentElement.replaceChild(this.editor.createText(e.textContent),e):this.editor.format(this.editor.createElement(this._tag.name,{attributes:t}))}}_openDialog(){this._dialog.open(t=>this._insert(t),this._selectedAttributes())}_selectedElement(){let t=this.editor.getSelectedElement();return t&&t.localName===this._tag?.name?t:null}_selectedAttributes(){let t=this._selectedElement(),e={};return t&&this._tag&&Array.from(t.attributes).forEach(i=>{this._tag.attributes.includes(i.nodeName)&&(e[i.nodeName]=i.nodeValue)}),e}};I=new WeakMap,v=new WeakMap;var S=bt;var R,Et=class{constructor(t=[]){R.set(this,new Map);t.forEach(e=>this.set(e))}get(t){return u(this,R).get(t)||null}set(t){if(!(t instanceof S))throw"Invalid argument";u(this,R).set(t.name,t)}execute(t){this.get(t).execute()}};R=new WeakMap;var bi=Et;var F,wt=class{constructor(t=[]){F.set(this,new Map);t.forEach(e=>this.set(e))}get(t){return u(this,F).get(t)||null}set(t){if(!(t instanceof p))throw"Invalid argument";u(this,F).set(t.name,t)}};F=new WeakMap;var Ei=wt;var P,H,xt,ot,Xs,jt=class{constructor(t){H.add(this);ot.add(this);P.set(this,void 0);if(!(t instanceof HTMLElement))throw"Invalid argument";E(this,P,t),this.register(m(this,ot,Xs).bind(this))}dispatch(t,e,i){if(!t||typeof t!="string"||!(e instanceof HTMLElement)||!(i instanceof HTMLElement))throw"Invalid argument";u(this,P).dispatchEvent(new CustomEvent(t,{detail:{element:e,target:i}}))}register(t,e={childList:!0,subtree:!0}){if(typeof t!="function")throw"Invalid argument";new MutationObserver(t).observe(u(this,P),e)}};P=new WeakMap,H=new WeakSet,xt=function(t,e,i){e instanceof HTMLElement&&i instanceof HTMLElement&&(this.dispatch(t,e,i),this.dispatch(`${t}${e.localName.replace("-","")}`,e,i))},ot=new WeakSet,Xs=function(t){t.forEach(e=>{e.addedNodes.forEach(i=>{i instanceof HTMLElement&&(m(this,H,xt).call(this,"insert",i,e.target),Array.from(i.getElementsByTagName("*")).forEach(s=>m(this,H,xt).call(this,"insert",s,e.target)))}),e.removedNodes.forEach(i=>i instanceof HTMLElement&&m(this,H,xt).call(this,"delete",i,e.target))})};var at=jt;var q,Lt=class{constructor(t){q.set(this,void 0);if(!(t instanceof L))throw"Invalid argument";E(this,q,t)}get editor(){return u(this,q)}filter(t){throw"Not implemented"}};q=new WeakMap;var w=Lt;var N,_t=class{constructor(){N.set(this,new Set)}add(t){if(!(t instanceof w))throw"Invalid argument";u(this,N).add(t)}filter(t){if(!(t instanceof HTMLElement))throw"Invalid argument";u(this,N).forEach(e=>{t.normalize(),e.filter(t)})}};N=new WeakMap;var wi=_t;var yt=class{constructor({name:t,group:e,...i}={}){h(this,"name");h(this,"group");h(this,"children",[]);h(this,"attributes",[]);h(this,"alignable",!1);h(this,"arbitrary",!1);h(this,"deletable",!1);h(this,"editable",!1);h(this,"empty",!1);h(this,"focusable",!1);h(this,"navigable",!1);h(this,"slotable",!1);h(this,"sortable",!1);h(this,"enter",null);let s=l=>l&&typeof l=="string",n=l=>typeof l=="undefined"||l&&typeof l=="string",d=l=>typeof l=="undefined"||Array.isArray(l)&&!l.find(f=>!s(f));if(!s(t)||!s(e)||!n(i.enter)||!d(i.children)||!d(i.attributes))throw"Invalid argument";this.name=t,this.group=e,this.children=i.children||[],this.attributes=i.attributes||[],this.arbitrary=i.arbitrary===!0,this.alignable=i.alignable===!0,this.deletable=i.deletable===!0,this.editable=i.editable===!0,this.empty=i.empty===!0,this.focusable=i.focusable===!0,this.navigable=i.navigable===!0,this.slotable=i.slotable===!0,this.sortable=i.sortable===!0,this.enter=i.enter||null}},nt=yt;var U,At=class{constructor(t){U.set(this,void 0);if(!(t instanceof L))throw"Invalid argument";E(this,U,t)}get editor(){return u(this,U)}static get name(){throw"Missing plugin name"}static get dependencies(){return[]}static get config(){return{}}init(){throw"Not implemented"}_(t){return this.editor.translator.translate(this.constructor.name,t)}_i18n(t){t[this.editor.config.base.lang]&&this.editor.translator.set(this.constructor.name,t[this.editor.config.base.lang])}_command(t){this.editor.commands.set(new S(this.editor,this.constructor.name,t))}_tag(t){this.editor.tags.set(new nt(t))}_toolbar(t,e=null,i=!1){if(!t||typeof t!="string"||e&&typeof e!="string")throw"Invalid argument";t=this._(t);let s=this.editor.createElement("button",{attributes:{type:"button","data-command":this.constructor.name,title:t,"data-key":e},html:t});i?this.editor.formats.appendChild(s):this.editor.toolbar.appendChild(s)}};U=new WeakMap;var o=At;var D,Ct=class{constructor(t=[]){D.set(this,new Map);t.forEach(e=>this.set(e))}get(t){return u(this,D).get(t)||null}set(t){if(!(t instanceof o))throw"Invalid argument";u(this,D).set(t.constructor.name,t)}init(){u(this,D).forEach(t=>t.init())}};D=new WeakMap;var ji=Ct;var z,kt=class{constructor(t=[]){z.set(this,new Map);t.forEach(e=>this.set(e))}get(t){return u(this,z).get(t instanceof HTMLElement?t.localName:t)||null}set(t){if(!(t instanceof nt))throw"Invalid argument";u(this,z).set(t.name,t)}allowed(t,e,i=!1){let s=i?e:this.get(e)?.group;return!!this.get(t)?.children.includes(s)}};z=new WeakMap;var xi=kt;var O,Tt=class{constructor(){O.set(this,new Map)}get(t){return u(this,O).get(t)||null}set(t,e){if(!t||typeof t!="string"||!(e instanceof Object))throw"Invalid argument";u(this,O).set(t,e)}translate(t,e){return this.get(t)?.[e]||e}};O=new WeakMap;var Li=Tt;var Bt=class{constructor(t,e={}){h(this,"orig");h(this,"document");h(this,"window");h(this,"element");h(this,"toolbar");h(this,"toolbarEvents");h(this,"formats");h(this,"formatsEvents");h(this,"root");h(this,"rootEvents");h(this,"config",{});h(this,"translator",new Li);h(this,"tags",new xi);h(this,"filters",new wi);h(this,"dialogs",new Ei);h(this,"commands",new bi);h(this,"plugins",new ji);if(!(t instanceof HTMLElement)||!(e instanceof Object))throw"Invalid argument";this.orig=t,this.document=this.orig.ownerDocument,this.window=this.document.defaultView,this.element=this.createElement("akilli-editor"),this.toolbar=this.createElement("editor-toolbar",{attributes:{role:"toolbar"}}),this.element.appendChild(this.toolbar),this.toolbarEvents=new at(this.toolbar),this.formats=this.createElement("editor-formats",{attributes:{role:"toolbar"}}),this.formats.hidden=!0,this.element.appendChild(this.formats),this.formatsEvents=new at(this.formats),this.root=this.createElement("editor-root"),this.element.appendChild(this.root),this.rootEvents=new at(this.root),this.config=e}static get defaultConfig(){return{}}init(){let t=this.config;this.config={};let e=this.constructor.defaultConfig.base?.plugins||[],i=e;Array.isArray(t.base?.plugins)&&t.base.plugins.length>0&&(i=[],t.base.plugins.forEach(d=>{let l=e.find(f=>f.name===d);l&&i.push(l)}));let s=new Set,n=d=>{d.dependencies&&d.dependencies.forEach(n),s.add(d)};i.map(n),s.forEach(d=>{Object.entries(d.config).forEach(([l,f])=>{this.config.hasOwnProperty(d.name)||(this.config[d.name]={}),this.config[d.name][l]=t[d.name]?.[l]||this.constructor.defaultConfig[d.name]?.[l]||f}),this.plugins.set(new d(this))}),this.plugins.init()}load(){this.orig instanceof HTMLTextAreaElement?(this.orig.form.addEventListener("submit",()=>this.save()),this.setHtml(this.orig.value.replace("/&nbsp;/g"," "))):this.setHtml(this.orig.innerHTML),this.orig.insertAdjacentElement("afterend",this.element),this.orig.hidden=!0}destroy(){this.element.parentElement.removeChild(this.element),this.orig.hidden=!1}getHtml(){let t=this.createElement(this.root.localName,{html:this.root.innerHTML});return this.filters.filter(t),this.rootEvents.dispatch("gethtml",t,this.root),t.innerHTML}setHtml(t){let e=this.createElement(this.root.localName,{html:t});this.rootEvents.dispatch("sethtml",e,this.root),this.filters.filter(e),this.root.innerHTML=e.innerHTML}save(){this.orig instanceof HTMLTextAreaElement?this.orig.value=this.getHtml():this.orig.innerHTML=this.getHtml()}insert(t){if(!(t instanceof HTMLElement))throw"Invalid argument";let e=this.getSelectedEditable();if(e&&e instanceof HTMLSlotElement&&this.tags.allowed(e.parentElement,t))e.insertAdjacentElement("beforebegin",t);else if(e)this.closest(e,t)?.insertAdjacentElement("afterend",t),e.hasAttribute("data-deletable")&&!e.textContent.trim()&&e.parentElement.removeChild(e);else if(this.tags.allowed(this.root,t))this.root.appendChild(t);else throw"Invalid argument"}insertText(t){let e=this.getSelectedEditable();if(e){let i=this.window.getSelection().getRangeAt(0);i.deleteContents(),i.insertNode(this.createText(t)),i.collapse(),e.normalize()}}format(t){if(!(t instanceof HTMLElement))throw"Invalid argument";let e=this.window.getSelection(),i=e.rangeCount>0?e.getRangeAt(0):null,s=this.getSelectedEditable();if(!i||i.collapsed||!i.toString().trim()||!s||!this.tags.allowed(s,t))return;i.startContainer instanceof Text&&i.startContainer.parentElement!==s&&i.setStartBefore(i.startContainer.parentElement),i.endContainer instanceof Text&&i.endContainer.parentElement!==s&&i.setEndAfter(i.endContainer.parentElement);let n=i.toString(),d=Array.from(i.cloneContents().childNodes).every(l=>l instanceof Text&&!l.textContent.trim()||l instanceof HTMLElement&&l.localName===t.localName);i.deleteContents(),d?i.insertNode(this.createText(n)):(t.textContent=n,i.insertNode(t)),s.normalize()}arbitrary(t){return t instanceof HTMLElement&&(t===this.root||t.hasAttribute("data-arbitrary"))}closest(t,e){if(!(t instanceof HTMLElement)||!this.contains(t.parentElement))throw"Invalid argument";let i=t,s=t.parentElement;do if(this.arbitrary(s)&&this.tags.allowed(s,e))return i;while((i=s)&&(s=s.parentElement)&&this.contains(s));return null}wrap(t,e,i={}){let s;if(t instanceof HTMLElement){if(t.parentElement.localName!==e&&(s=this.closest(t,e))){let n=this.createElement(e,i);s.insertAdjacentElement("afterend",n),n.appendChild(t)}}else throw"Invalid argument"}contains(t){if(!(t instanceof HTMLElement))throw"Invalid argument";return this.root.contains(t)||t.closest(this.root.localName)?.parentElement===null}registerElement(t,e,i=null){typeof this.window.customElements.get(t)=="undefined"&&this.window.customElements.define(t,e,i?{extends:i}:null)}createElement(t,{attributes:e={},html:i=""}={}){let s=this.document.createElement(t);return s.innerHTML=i,Object.entries(e).forEach(([n,d])=>d&&s.setAttribute(n,`${d}`)),s}createText(t){return this.document.createTextNode(t)}getSelectedElement(){try{let t=this.window.getSelection(),e=t.anchorNode instanceof Text?t.anchorNode.parentElement:t.anchorNode,i=t.focusNode instanceof Text?t.focusNode.parentElement:t.focusNode;if(e instanceof HTMLElement&&i instanceof HTMLElement&&e===i&&this.contains(e))return e}catch(t){this.window.console.error(t)}return null}getSelectedEditable(){try{let t=this.window.getSelection(),e=t.anchorNode instanceof Text?t.anchorNode.parentElement:t.anchorNode,i=t.focusNode instanceof Text?t.focusNode.parentElement:t.focusNode;if(e instanceof HTMLElement&&i instanceof HTMLElement){let s=e.closest("[contenteditable=true]"),n=i.closest("[contenteditable=true]");if(s instanceof HTMLElement&&s===n&&this.contains(s))return s}}catch(t){this.window.console.error(t)}return null}focusEnd(t){if(!(t instanceof HTMLElement))throw"Invalid argument";let e=this.document.createRange(),i=this.window.getSelection();t.focus(),e.selectNodeContents(t),e.collapse(),i.removeAllRanges(),i.addRange(e)}isKey(t,e,{alt:i=!1,ctrl:s=!1,shift:n=!1}={}){return(Array.isArray(e)&&e.includes(t.key)||t.key===e)&&t.altKey===i&&t.ctrlKey===s&&t.shiftKey===n}url(t){let e=this.window.origin||this.window.location.origin,i=this.createElement("a",{attributes:{href:t}});return e===i.origin?i.pathname:i.href}static create(t,e={}){let i=new this(t,e);return i.init(),i.load(),i}},L=Bt;var K,V,St=class{constructor(t,e){K.set(this,void 0);V.set(this,void 0);if(!(t instanceof L)||!e||typeof e!="string")throw"Invalid argument";E(this,K,t),E(this,V,e)}get editor(){return u(this,K)}get name(){return u(this,V)}open(t,e={}){let i=()=>Array.from(this.editor.element.getElementsByTagName("editor-dialog")).forEach(g=>{g.parentElement.removeChild(g)}),s=this.editor.window.getSelection(),n=s.rangeCount>0?s.getRangeAt(0):null,d=()=>{n&&(s.removeAllRanges(),s.addRange(n)),i()};i();let l=this.editor.createElement("form",{attributes:{method:"dialog"}}),f=this.editor.createElement("fieldset"),_=this.editor.createElement("button",{attributes:{type:"button"},html:this._("Cancel")});_.addEventListener("click",d),l.appendChild(f),l.appendChild(_),l.appendChild(this.editor.createElement("button",{html:this._("Save")})),this._initFieldset(f),l.addEventListener("submit",g=>{g.preventDefault(),g.stopPropagation(),d();let j={};Array.from(f.elements).forEach(k=>j[k.name]=k.value),t(j)}),Object.entries(e).forEach(([g,j])=>f.elements[g]&&(f.elements[g].value=j));let T=this.editor.createElement("editor-dialog");T.addEventListener("close",d),T.appendChild(l),T.show(),this.editor.element.appendChild(T)}_(t){return this.editor.translator.translate(this.name,t)}_initFieldset(t){throw"Not implemented"}_createInput(t,e,i,s={}){if(!t||typeof t!="string"||!e||typeof e!="string"||!i||typeof i!="string")throw"Invalid argument";Object.assign(s,{id:`editor-${t}`,name:t,type:e});let n=this.editor.createElement("div");return n.appendChild(this.editor.createElement("label",{attributes:{for:s.id},html:i})),n.appendChild(this.editor.createElement("input",{attributes:s})),s.required&&n.setAttribute("data-required",""),n}};K=new WeakMap,V=new WeakMap;var p=St;var Pt=class extends p{constructor(t){super(t,"abbreviation")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Abbreviation")})),t.appendChild(this._createInput("title","text",this._("Full term"),{placeholder:this._("Insert full term or leave empty to remove it")}))}},_i=Pt;var $,Ht=class{constructor(t){$.set(this,void 0);if(!(t instanceof L))throw"Invalid argument";E(this,$,t)}get editor(){return u(this,$)}handleEvent(t){typeof this[t.type]=="function"&&this[t.type](t)}};$=new WeakMap;var c=Ht;var Dt=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insert",this)}insert(t){t.detail.element.hasAttribute("data-alignable")&&t.detail.element.addEventListener("keydown",this)}keydown(t){let e={ArrowUp:null,ArrowLeft:"left",ArrowDown:"center",ArrowRight:"right"};t.target===t.currentTarget&&this.editor.isKey(t,Object.keys(e),{shift:!0})&&(t.preventDefault(),t.stopPropagation(),t.target.classList.remove(...Object.values(e)),e[t.key]&&t.target.classList.add(e[t.key]))}},yi=Dt;var lt,Ys,Q,Ai,Mt=class extends w{constructor(){super(...arguments);lt.add(this);Q.add(this)}filter(t){let e=this.editor.tags.get(t),i=this.editor.tags.allowed(t,"p"),s=e.editable||e.group==="format",n=[],d=(l=null)=>{i&&n.length>0&&(t.insertBefore(this.editor.createElement("p",{html:n.join(" ")}),l),n=[])};Array.from(t.childNodes).forEach(l=>{let f=l.textContent.trim();if(l instanceof HTMLElement){l=m(this,lt,Ys).call(this,l);let _=this.editor.tags.get(l);_&&this.editor.tags.allowed(t,l)?(d(l),m(this,Q,Ai).call(this,l,_)):_&&_.group==="format"&&i?(l=m(this,Q,Ai).call(this,l,_))&&(n.push(l.outerHTML),t.removeChild(l)):!s&&f&&i?(n.push(f),t.removeChild(l)):s&&f?t.replaceChild(this.editor.createText(f),l):t.removeChild(l)}else l instanceof Text?(!s&&f&&i&&n.push(f),(!s||!f)&&t.removeChild(l)):l instanceof Node&&t.removeChild(l)}),d()}};lt=new WeakSet,Ys=function(t){let e=this.editor.config.base.filter[t.localName];if(!e)return t;let i=this.editor.createElement(e,{html:t.innerHTML});return t.parentElement.replaceChild(i,t),i},Q=new WeakSet,Ai=function(t,e){return Array.from(t.attributes).forEach(i=>!e.attributes.includes(i.name)&&t.removeAttribute(i.name)),t.hasChildNodes()&&this.editor.filters.filter(t),t.hasChildNodes()||e.empty?t:(t.parentElement.removeChild(t),null)};var Ci=Mt;var It=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insert",this)}insert(t){t.detail.element.hasAttribute("data-deletable")&&t.detail.element.addEventListener("keydown",this)}keydown(t){t.target===t.currentTarget&&this.editor.isKey(t,"Delete",{ctrl:!0})&&(t.target.previousElementSibling instanceof HTMLElement&&this.editor.focusEnd(t.target.previousElementSibling),t.target.parentElement.removeChild(t.target),t.preventDefault(),t.stopPropagation())}},ki=It;var vt=class extends HTMLElement{constructor(){super();this.addEventListener("keydown",t=>t.key==="Escape"&&this.close()),this.addEventListener("click",t=>t.target===this&&this.close())}connectedCallback(){this.setAttribute("role","dialog"),this.tabIndex=-1,this.focus()}get open(){return this.hasAttribute("open")}set open(t){t===!0?this.setAttribute("open",""):this.removeAttribute("open")}show(){this.open=!0,this.dispatchEvent(new CustomEvent("show",{detail:{element:this,target:this}}))}close(){this.open=!1,this.dispatchEvent(new CustomEvent("close",{detail:{element:this,target:this}}))}},Ti=vt;var Rt=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insert",this)}insert(t){t.detail.element.contentEditable==="true"&&t.detail.element.addEventListener("keydown",this)}keydown(t){if(this.editor.isKey(t,"Enter",{shift:!0})&&!this.editor.tags.allowed(t.target,"br"))t.preventDefault(),t.stopPropagation();else if(this.editor.isKey(t,"Enter")){t.preventDefault(),t.stopPropagation();let e=this.editor.tags.get(t.target)?.enter;e&&(t.target.textContent.trim()||!t.target.hasAttribute("data-deletable")?this.editor.closest(t.target,e)?.insertAdjacentElement("afterend",this.editor.createElement(e)):t.target instanceof HTMLParagraphElement||(this.editor.closest(t.target,"p")?.insertAdjacentElement("afterend",this.editor.createElement("p")),t.target.parentElement.removeChild(t.target)))}else this.editor.isKey(t,"Backspace")&&!t.target.textContent&&t.target.hasAttribute("data-deletable")?(t.target.previousElementSibling instanceof HTMLElement&&this.editor.focusEnd(t.target.previousElementSibling),t.target.parentElement.removeChild(t.target),t.preventDefault(),t.stopPropagation()):/^[A-Z]$/.test(t.key)&&this.editor.isKey(t,t.key,{alt:!0,shift:!0})&&(t.preventDefault(),t.stopPropagation(),this.editor.formats.querySelector(`button[data-key=${t.key.toLowerCase()}]`)?.click())}},Bi=Rt;var Ft=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insert",this)}insert(t){t.detail.element.hasAttribute("data-focusable")&&t.detail.element.focus()}},Si=Ft;var dt,to,qt=class extends c{constructor(t){super(t);dt.add(this);this.editor.root.addEventListener("insert",this)}insert(t){t.detail.element.hasAttribute("data-navigable")&&(t.detail.element.tabIndex=0,t.detail.element.addEventListener("keydown",this))}keydown(t){if(t.target===t.currentTarget&&this.editor.isKey(t,["ArrowUp","ArrowDown","Home","End"])&&m(this,dt,to).call(this,t.target)){let e=t.target.previousElementSibling,i=t.target.nextElementSibling,s=t.target.parentElement.firstElementChild,n=t.target.parentElement.lastElementChild,d=t.target===s,l=t.target===n;t.key==="ArrowUp"&&!d&&e.hasAttribute("data-navigable")?e.focus():t.key==="ArrowDown"&&!l&&i.hasAttribute("data-navigable")?i.focus():(t.key==="Home"||t.key==="ArrowDown"&&l)&&s.hasAttribute("data-navigable")?s.focus():(t.key==="End"||t.key==="ArrowUp"&&d)&&n.hasAttribute("data-navigable")&&n.focus(),t.preventDefault(),t.stopPropagation()}}};dt=new WeakSet,to=function(t){if(t.contentEditable!=="true")return!0;let e=this.editor.window.getSelection(),i=this.editor.getSelectedEditable(),s=this.editor.getSelectedElement();return e.isCollapsed&&e.anchorOffset===0&&[i,t.firstChild].includes(s)};var Pi=qt;var Nt=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insert",this)}insert(t){t.detail.element instanceof HTMLSlotElement?t.detail.element.addEventListener("keydown",this):t.detail.element.hasAttribute("data-slotable")&&!t.detail.element.querySelector(":scope > slot")&&t.detail.element.appendChild(this.editor.createElement("slot"))}keydown(t){t.preventDefault(),t.stopPropagation()}},Hi=Nt;var W,Di,Z,Mi,Ut=class extends c{constructor(t){super(t);W.add(this);Z.add(this);this.editor.root.addEventListener("insert",this)}insert(t){t.detail.element.hasAttribute("data-sortable")&&(t.detail.element.addEventListener("keydown",this),t.detail.element.addEventListener("pointerdown",this),t.detail.element.addEventListener("pointermove",this),t.detail.element.addEventListener("pointerup",this))}keydown(t){if(t.target===t.currentTarget&&this.editor.isKey(t,["ArrowUp","ArrowDown","Home","End"],{ctrl:!0})){let e=t.target.parentElement,i=t.target.previousElementSibling,s=t.target.nextElementSibling,n=e.firstElementChild,d=e.lastElementChild,l=t.target===n,f=t.target===d;t.key==="ArrowUp"&&!l&&i.hasAttribute("data-sortable")?(i.insertAdjacentHTML("beforebegin",t.target.outerHTML),e.removeChild(t.target)):t.key==="ArrowDown"&&!f&&s.hasAttribute("data-sortable")?(s.insertAdjacentHTML("afterend",t.target.outerHTML),e.removeChild(t.target)):(t.key==="Home"&&!l||t.key==="ArrowDown"&&f)&&n.hasAttribute("data-sortable")?(n.insertAdjacentHTML("beforebegin",t.target.outerHTML),e.removeChild(t.target)):(t.key==="End"&&!f||t.key==="ArrowUp"&&l)&&d.hasAttribute("data-sortable")&&(d.insertAdjacentHTML("afterend",t.target.outerHTML),e.removeChild(t.target)),t.preventDefault(),t.stopPropagation()}}pointerdown(t){t.target.hasAttribute("data-sortable")&&(t.target.setAttribute("data-sort",""),t.target.setPointerCapture(t.pointerId))}pointermove(t){let e=this.editor.document.elementFromPoint(t.x,t.y);m(this,W,Di).call(this),m(this,Z,Mi).call(this,t.target,e)&&e.setAttribute("data-sortover","")}pointerup(t){if(t.target.hasAttribute("data-sortable")){let e=this.editor.document.elementFromPoint(t.x,t.y);m(this,W,Di).call(this),t.target.removeAttribute("data-sort"),t.target.releasePointerCapture(t.pointerId),m(this,Z,Mi).call(this,t.target,e)&&e.insertAdjacentElement("beforebegin",t.target)}}};W=new WeakSet,Di=function(){this.editor.root.querySelectorAll("[data-sortover]").forEach(t=>t.removeAttribute("data-sortover"))},Z=new WeakSet,Mi=function(t,e){return t instanceof HTMLElement&&e instanceof HTMLElement&&this.editor.contains(e)&&![this.editor.root,t].includes(e)&&e.hasAttribute("data-sortable")&&(t.parentElement===e.parentElement||this.editor.arbitrary(t.parentElement)&&this.editor.arbitrary(e.parentElement))&&this.editor.tags.allowed(e.parentElement,t)};var Ii=Ut;var zt=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insert",this)}insert(t){let e=this.editor.tags.get(t.detail.element);e&&(e.editable&&(t.detail.element.contentEditable="true"),["alignable","arbitrary","deletable","focusable","navigable","slotable","sortable"].forEach(i=>{e[i]&&(t.detail.element.dataset[i]="")}))}},vi=zt;var Ot=class extends c{constructor(t){super(t);this.editor.toolbar.addEventListener("insertbutton",this),this.editor.formats.addEventListener("insertbutton",this),this.editor.document.addEventListener("selectionchange",this)}insertbutton(t){let e=t.detail.element.getAttribute("data-key");if(e){let i=this.editor.translator.translate("base","Alt"),s=this.editor.translator.translate("base","Shift");t.detail.element.title+=` [${i} + ${s} + ${e}]`}t.detail.element.getAttribute("data-command")&&t.detail.element.addEventListener("click",this),t.detail.element.parentElement===this.editor.toolbar&&(t.detail.element.tabIndex=-1,t.detail.element.addEventListener("keydown",this))}click(t){this.editor.commands.execute(t.target.getAttribute("data-command"))}keydown(t){if(this.editor.isKey(t,["ArrowLeft","ArrowRight","Home","End"])){let e=t.target.previousElementSibling,i=t.target.nextElementSibling,s=t.target.parentElement.firstElementChild,n=t.target.parentElement.lastElementChild,d=t.target===s,l=t.target===n;t.key==="ArrowLeft"&&!d?e.focus():t.key==="ArrowRight"&&!l?i.focus():t.key==="Home"||t.key==="ArrowRight"&&l?s.focus():(t.key==="End"||t.key==="ArrowLeft"&&d)&&n.focus(),t.preventDefault(),t.stopPropagation()}}selectionchange(){let t=this.editor.getSelectedEditable();t&&!this.editor.window.getSelection().isCollapsed&&this.editor.tags.allowed(t,"format",!0)?(this.editor.formats.hidden=!1,this.editor.formats.style.top=`${t.offsetTop+t.offsetParent.offsetTop-this.editor.formats.clientHeight}px`):(this.editor.formats.hidden=!0,this.editor.formats.removeAttribute("style"))}},Ri=Ot;var Fi={de:{Alt:"Alt",Shift:"Umschalt"}};var Kt=class extends o{static get name(){return"base"}static get config(){return{browser:{},filter:{},lang:null,plugins:[]}}init(){this._i18n(Fi),this.editor.registerElement("editor-dialog",Ti),this._tag({name:"editor-root",group:"root",children:["audio","block","container","figure","heading","iframe","image","list","paragraph","preformat","quote","rule","table","video"]}),this._tag({name:"slot",group:"slot",editable:!0,focusable:!0,navigable:!0,sortable:!0}),new Ri(this.editor),new vi(this.editor),new Bi(this.editor),new ki(this.editor),new Pi(this.editor),new Ii(this.editor),new yi(this.editor),new Si(this.editor),new Hi(this.editor),this.editor.filters.add(new Ci(this.editor))}},a=Kt;var qi={de:{Abbreviation:"Abk\xFCrzung",Cancel:"Abbrechen","Full term":"Langform","Insert full term or leave empty to remove it":"Langform eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var Vt=class extends o{static get name(){return"abbreviation"}static get dependencies(){return[a]}init(){this._i18n(qi),this._tag({name:"abbr",group:"format",attributes:["title"]}),this.editor.dialogs.set(new _i(this.editor)),this._command("abbr"),this._toolbar("Abbreviation","a",!0)}},Ni=Vt;var $t=class extends p{constructor(t){super(t,"audio")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Audio")})),t.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to audio"),required:"required"}))}},Ui=$t;var G,zi,Qt=class extends c{constructor(t){super(t);G.add(this);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertaudio",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("audio")).forEach(e=>m(this,G,zi).call(this,e))}insertaudio(t){m(this,G,zi).call(this,t.detail.element)}};G=new WeakSet,zi=function(t){let e=t.getAttribute("src");e?(t.setAttribute("src",this.editor.url(e)),t.controls=!0,this.editor.wrap(t,"figure",{attributes:{class:"audio"}})):t.parentElement.removeChild(t)};var Oi=Qt;var J,Wt=class extends p{constructor(t,e,i){super(t,e);J.set(this,void 0);h(this,"opts",Object.assign({alwaysRaised:"yes",dependent:"yes",height:`${this.editor.window.screen.height}`,location:"no",menubar:"no",minimizable:"no",modal:"yes",resizable:"yes",scrollbars:"yes",toolbar:"no",width:`${this.editor.window.screen.width}`},this.editor.config.base.browser));if(!i||typeof i!="string")throw"Invalid argument";E(this,J,i)}open(t,e={}){let i=Object.entries(this.opts).map(l=>`${l[0]}=${l[1]}`).join(","),s=this.editor.createElement("a",{attributes:{href:u(this,J)}}),n=new URL(s.href);Object.entries(e).forEach(([l,f])=>n.searchParams.set(l,`${f}`));let d=this.editor.window.open(n.toString(),this.name,i);this.editor.window.addEventListener("message",l=>{l.origin===n.origin&&l.source===d&&(t(l.data),d.close())},!1)}};J=new WeakMap;var A=Wt;var Zt=class extends w{filter(t){t.querySelectorAll("figure > figcaption:only-child").forEach(e=>e.parentElement.removeChild(e))}},Ki=Zt;var Gt=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insertfigure",this)}insertfigure(t){t.detail.element.querySelector(":scope > figcaption")||t.detail.element.appendChild(this.editor.createElement("figcaption"))}},Vi=Gt;var Jt=class extends o{static get name(){return"figure"}static get dependencies(){return[a]}init(){this._tag({name:"figure",group:"figure",children:["audio","caption","iframe","image","preformat","quote","table","video"],attributes:["class"],alignable:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._tag({name:"figcaption",group:"caption",children:["format"],editable:!0,navigable:!0,enter:"p"}),new Vi(this.editor),this.editor.filters.add(new Ki(this.editor))}},x=Jt;var $i={de:{Audio:"Audio",Cancel:"Abbrechen","Insert URL to audio":"URL zur Audiodatei eingeben",Save:"Speichern",URL:"URL"}};var Xt=class extends o{static get name(){return"audio"}static get dependencies(){return[a,x]}static get config(){return{browser:null}}init(){this._i18n($i),this._tag({name:"audio",group:"audio",attributes:["controls","src"],empty:!0,navigable:!0}),new Oi(this.editor),this.editor.config.audio.browser?this.editor.dialogs.set(new A(this.editor,"audio",this.editor.config.audio.browser)):this.editor.dialogs.set(new Ui(this.editor)),this._command("audio"),this._toolbar("Audio")}},Qi=Xt;var Yt=class extends p{constructor(t){super(t,"block")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Block")})),t.appendChild(this._createInput("id","text",this._("ID"),{required:"required"}))}},Wi=Yt;var te=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}get content(){return this.shadowRoot.innerHTML}set content(t){this.shadowRoot.innerHTML=t}},Zi=te;var ee=class extends c{constructor(t){super(t);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertappblock",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("app-block")).forEach(e=>e.id||e.parentElement.removeChild(e))}async insertappblock(t){if(t.detail.element.id){if(!this.editor.config.block.api)return}else{t.detail.element.parentElement.removeChild(t.detail.element);return}try{let e=await fetch(this.editor.config.block.api.replace("{id}",t.detail.element.id),{mode:"no-cors"});if(e.ok){let i="";this.editor.config.block.css&&(i=this.editor.config.block.css.split(",").map(n=>`<link rel="stylesheet" href="${n}">`).join(""));let s=await e.text();t.detail.element.content=i+s}}catch(e){this.editor.window.console.error(e)}}},Gi=ee;var mt={de:{Cancel:"Abbrechen",Height:"H\xF6he",Ifrane:"Iframe","Insert URL to embedded page":"URL zur eingebetteten Seite eingeben",Save:"Speichern",URL:"URL",Width:"Breite"}};var ie=class extends o{static get name(){return"block"}static get dependencies(){return[a]}static get config(){return{api:null,browser:null,css:null}}init(){this._i18n(mt),this.editor.registerElement("app-block",Zi),this._tag({name:"app-block",group:"block",attributes:["id"],deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),new Gi(this.editor),this.editor.config.block.browser?this.editor.dialogs.set(new A(this.editor,"block",this.editor.config.block.browser)):this.editor.dialogs.set(new Wi(this.editor)),this._command("app-block"),this._toolbar("Block")}},Ji=ie;var re=class extends w{filter(t){t instanceof HTMLElement&&t.localName==="figure"&&t.classList.contains("quote")&&t.querySelector(":scope > blockquote")&&!t.querySelector(":scope > figcaption")&&(t.insertAdjacentElement("beforebegin",t.querySelector(":scope > blockquote")),t.innerHTML="")}},Xi=re;var se=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insertblockquote",this),this.editor.root.addEventListener("deleteblockquote",this)}insertblockquote(t){this.editor.wrap(t.detail.element,"figure",{attributes:{class:"quote"}})}deleteblockquote(t){t.detail.target.localName==="figure"&&t.detail.target.classList.contains("quote")&&t.detail.target.parentElement.removeChild(t.detail.target)}},Yi=se;var oe=class extends w{filter(t){if(t instanceof HTMLPreElement){t.outerHTML=t.outerHTML.replace(/(<br\s*\/?>)/gi,`
`);return}t.innerHTML=t.innerHTML.replace(/^\s*(<br\s*\/?>\s*)+/gi,"").replace(/\s*(<br\s*\/?>\s*)+$/gi,""),t instanceof HTMLParagraphElement?t.outerHTML=t.outerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"</p><p>"):t.innerHTML=t.innerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"<br>")}},tr=oe;var ae=class extends o{static get name(){return"break"}static get dependencies(){return[a]}init(){this._tag({name:"br",group:"break",empty:!0}),this.editor.filters.add(new tr(this.editor))}},C=ae;var er={de:{"Block Quote":"Blockzitat"}};var ne=class extends o{static get name(){return"blockquote"}static get dependencies(){return[a,C,x]}init(){this._i18n(er),this._tag({name:"blockquote",group:"quote",children:["break","format"],deletable:!0,editable:!0,navigable:!0,enter:"p"}),new Yi(this.editor),this._command("blockquote"),this._toolbar("Block Quote"),this.editor.filters.add(new Xi(this.editor))}},ir=ne;var rr={de:{bold:"fett"}};var le=class extends o{static get name(){return"bold"}static get dependencies(){return[a]}init(){this._i18n(rr),this._tag({name:"b",group:"format"}),this._command("b"),this._toolbar("bold","b",!0)}},sr=le;var or={de:{Citation:"Zitatquelle"}};var de=class extends o{static get name(){return"cite"}static get dependencies(){return[a]}init(){this._i18n(or),this._tag({name:"cite",group:"format"}),this._command("cite"),this._toolbar("Citation","z",!0)}},ar=de;var nr={de:{Code:"Quelltext"}};var me=class extends o{static get name(){return"code"}static get dependencies(){return[a]}init(){this._i18n(nr),this._tag({name:"code",group:"format"}),this._command("code"),this._toolbar("Code","c",!0)}},lr=me;var ce=class extends p{constructor(t){super(t,"data")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Data")})),t.appendChild(this._createInput("value","text",this._("Machine-readable Value"),{placeholder:this._("Insert value or leave empty to remove it")}))}},dr=ce;var mr={de:{Cancel:"Abbrechen",Data:"Data","Machine-readable Value":"Maschinenlesbarer Wert","Insert value or leave empty to remove it":"Wert eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var he=class extends o{static get name(){return"data"}static get dependencies(){return[a]}init(){this._i18n(mr),this._tag({name:"data",group:"format",attributes:["value"]}),this.editor.dialogs.set(new dr(this.editor)),this._command("data"),this._toolbar("Data","j",!0)}},cr=he;var hr={de:{Definition:"Definition"}};var ue=class extends o{static get name(){return"definition"}static get dependencies(){return[a]}init(){this._i18n(hr),this._tag({name:"dfn",group:"format"}),this._command("dfn"),this._toolbar("Definition","d",!0)}},ur=ue;var fr={de:{"Text Deletion":"Textl\xF6schung"}};var fe=class extends o{static get name(){return"deletion"}static get dependencies(){return[a]}init(){this._i18n(fr),this._tag({name:"del",group:"format"}),this._command("del"),this._toolbar("Text Deletion","g",!0)}},pr=fe;var pe=class extends w{filter(t){t.querySelectorAll("summary:not(:first-child)").forEach(e=>e.parentElement.removeChild(e)),t.querySelectorAll("summary:only-child").forEach(e=>e.parentElement.removeChild(e))}},gr=pe;var X,br,ge=class extends c{constructor(t){super(t);X.add(this);this.editor.root.addEventListener("insertdetails",this),this.editor.root.addEventListener("insertsummary",this)}insertdetails(t){t.detail.element.open=!0,t.detail.element.querySelector(":scope > summary:first-child")||t.detail.element.insertAdjacentElement("afterbegin",this.editor.createElement("summary"))}insertsummary(t){m(this,X,br).call(this,t.detail.element),t.detail.element.addEventListener("blur",this),t.detail.element.addEventListener("keydown",this)}blur(t){m(this,X,br).call(this,t.target)}keydown(t){this.editor.isKey(t," ")?(t.preventDefault(),t.stopPropagation(),this.editor.insertText(" ")):this.editor.isKey(t,"Enter")&&(t.preventDefault(),t.stopPropagation(),t.target.parentElement.open=!0)}};X=new WeakSet,br=function(t){t.textContent.trim()?t.querySelectorAll("br:not(:last-child)").forEach(e=>e.parentElement.removeChild(e)):t.textContent=this.editor.translator.translate("details","Details"),t.lastElementChild instanceof HTMLBRElement||t.appendChild(this.editor.createElement("br"))};var Er=ge;var wr={de:{Details:"Details"}};var be=class extends o{static get name(){return"details"}static get dependencies(){return[a]}init(){this._i18n(wr),this._tag({name:"details",group:"container",children:["audio","figure","iframe","image","list","paragraph","preformat","quote","rule","summary","table","video"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._tag({name:"summary",group:"summary",editable:!0,navigable:!0,enter:"p"}),new Er(this.editor),this._command("details"),this._toolbar("Details"),this.editor.filters.add(new gr(this.editor))}},jr=be;var Ee=class extends p{constructor(t){super(t,"division")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Division")})),t.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}},xr=Ee;var Lr={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse",Division:"Division","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern"}};var we=class extends o{static get name(){return"division"}static get dependencies(){return[a]}init(){this._i18n(Lr),this._tag({name:"div",group:"container",children:["audio","block","figure","iframe","image","preformat","quote","rule","table","video"],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new xr(this.editor)),this._command("div"),this._toolbar("Division")}},_r=we;var yr={de:{emphasized:"betont"}};var je=class extends o{static get name(){return"emphasis"}static get dependencies(){return[a]}init(){this._i18n(yr),this._tag({name:"em",group:"format"}),this._command("em"),this._toolbar("emphasized","e",!0)}},Ar=je;var Cr={de:{Heading:"\xDCberschrift"}};var xe=class extends o{static get name(){return"heading"}static get dependencies(){return[a]}init(){this._i18n(Cr),this._tag({name:"h2",group:"heading",deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"p"}),this._command("h2"),this._toolbar("Heading")}},kr=xe;var Tr={de:{"Horizontal Rule":"Horizontale Linie"}};var Le=class extends o{static get name(){return"horizontalrule"}static get dependencies(){return[a]}init(){this._i18n(Tr),this._tag({name:"hr",group:"rule",deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),this._command("hr"),this._toolbar("Horizontal Rule")}},Br=Le;var _e=class extends p{constructor(t){super(t,"iframe")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Iframe")})),t.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to embedded page"),required:"required"})),t.appendChild(this._createInput("width","number",this._("Width"))),t.appendChild(this._createInput("height","number",this._("Height")))}},Sr=_e;var Y,Pr,ye=class extends c{constructor(t){super(t);Y.add(this);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertiframe",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("iframe")).forEach(e=>m(this,Y,Pr).call(this,e))}insertiframe(t){m(this,Y,Pr).call(this,t.detail.element)}};Y=new WeakSet,Pr=function(t){let e=t.getAttribute("src");e?(t.setAttribute("src",this.editor.url(e)),t.allowFullscreen=!0,this.editor.wrap(t,"figure",{attributes:{class:"iframe"}})):t.parentElement.removeChild(t)};var Hr=ye;var Ae=class extends o{static get name(){return"iframe"}static get dependencies(){return[a,x]}static get config(){return{browser:null}}init(){this._i18n(mt),this._tag({name:"iframe",group:"iframe",attributes:["allowfullscreen","height","src","width"],empty:!0,navigable:!0}),new Hr(this.editor),this.editor.config.iframe.browser?this.editor.dialogs.set(new A(this.editor,"iframe",this.editor.config.iframe.browser)):this.editor.dialogs.set(new Sr(this.editor)),this._command("iframe"),this._toolbar("Iframe")}},Dr=Ae;var Ce=class extends p{constructor(t){super(t,"image")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Image")})),t.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to image"),required:"required"})),t.appendChild(this._createInput("alt","text",this._("Alternative text"),{placeholder:this._("Replacement text for use when media elements are not available")})),t.appendChild(this._createInput("width","number",this._("Width"))),t.appendChild(this._createInput("height","number",this._("Height")))}},Mr=Ce;var tt,Ir,ke=class extends c{constructor(t){super(t);tt.add(this);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertimg",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("img")).forEach(e=>m(this,tt,Ir).call(this,e))}insertimg(t){m(this,tt,Ir).call(this,t.detail.element)}};tt=new WeakSet,Ir=function(t){let e=t.getAttribute("src");e?(t.setAttribute("src",this.editor.url(e)),this.editor.wrap(t,"figure",{attributes:{class:"image"}})):t.parentElement.removeChild(t)};var vr=ke;var Rr={de:{"Alternative text":"Alternativtext",Cancel:"Abbrechen",Height:"H\xF6he",Image:"Bild","Insert URL to image":"URL zur Bilddatei eingeben","Replacement text for use when media elements are not available":"Ersatztext, falls Medienelemente nicht verf\xFCgbar sind",Save:"Speichern",URL:"URL",Width:"Breite"}};var Te=class extends o{static get name(){return"image"}static get dependencies(){return[a,x]}static get config(){return{browser:null}}init(){this._i18n(Rr),this._tag({name:"img",group:"image",attributes:["alt","height","src","width"],empty:!0,navigable:!0}),new vr(this.editor),this.editor.config.image.browser?this.editor.dialogs.set(new A(this.editor,"image",this.editor.config.image.browser)):this.editor.dialogs.set(new Mr(this.editor)),this._command("img"),this._toolbar("Image")}},Fr=Te;var qr={de:{"Text Insertion":"Texteinf\xFCgung"}};var Be=class extends o{static get name(){return"insertion"}static get dependencies(){return[a]}init(){this._i18n(qr),this._tag({name:"ins",group:"format"}),this._command("ins"),this._toolbar("Text Insertion","f",!0)}},Nr=Be;var Ur={de:{italic:"kursiv"}};var Se=class extends o{static get name(){return"italic"}static get dependencies(){return[a]}init(){this._i18n(Ur),this._tag({name:"i",group:"format"}),this._command("i"),this._toolbar("italic","i",!0)}},zr=Se;var Or={de:{"User Input":"Benutzereingabe"}};var Pe=class extends o{static get name(){return"keyboard"}static get dependencies(){return[a]}init(){this._i18n(Or),this._tag({name:"kbd",group:"format"}),this._command("kbd"),this._toolbar("User Input","k",!0)}},Kr=Pe;var He=class extends p{constructor(t){super(t,"link")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Link")})),t.appendChild(this._createInput("href","text",this._("URL"),{pattern:"(https?|/|mailto:|tel:).+",placeholder:this._("Insert URL to add a link or leave empty to unlink")}))}},Vr=He;var et,$r,De=class extends c{constructor(t){super(t);et.add(this);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("inserta",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("a")).forEach(e=>m(this,et,$r).call(this,e))}inserta(t){m(this,et,$r).call(this,t.detail.element)}};et=new WeakSet,$r=function(t){let e=t.getAttribute("href");e?t.setAttribute("href",this.editor.url(e)):t.parentElement.replaceChild(this.editor.createText(t.textContent),t)};var Qr=De;var Wr={de:{Cancel:"Abbrechen","Insert URL to add a link or leave empty to unlink":"URL zum Verlinken eingeben oder zum Entfernen leer lassen",Link:"Link",Save:"Speichern",URL:"URL"}};var Me=class extends o{static get name(){return"link"}static get dependencies(){return[a]}init(){this._i18n(Wr),this._tag({name:"a",group:"format",attributes:["href"]}),new Qr(this.editor),this.editor.dialogs.set(new Vr(this.editor)),this._command("a"),this._toolbar("Link","l",!0)}},Zr=Me;var Gr={de:{mark:"markiert"}};var Ie=class extends o{static get name(){return"mark"}static get dependencies(){return[a]}init(){this._i18n(Gr),this._tag({name:"mark",group:"format"}),this._command("mark"),this._toolbar("mark","m",!0)}},Jr=Ie;var it,Xr,ve=class extends c{constructor(t){super(t);it.add(this);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertli",this),this.editor.root.addEventListener("deleteli",this),this.editor.root.addEventListener("insertol",this),this.editor.root.addEventListener("insertul",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("li")).forEach(e=>m(this,it,Xr).call(this,e))}insertli(t){m(this,it,Xr).call(this,t.detail.element)}deleteli(t){t.detail.target.children.length===0&&t.detail.target.parentElement.removeChild(t.detail.target)}insertol(t){t.detail.element.children.length===0&&t.detail.element.appendChild(this.editor.createElement("li"))}insertul(t){this.insertol(t)}};it=new WeakSet,Xr=function(t){!(t.parentElement instanceof HTMLOListElement)&&!(t.parentElement instanceof HTMLUListElement)&&this.editor.wrap(t,"ul")};var Yr=ve;var Re=class extends o{static get name(){return"list"}static get dependencies(){return[a,C]}init(){this._tag({name:"li",group:"listitem",children:["break","format"],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"li"}),new Yr(this.editor)}},ct=Re;var ts={de:{"Ordered List":"Geordnete Liste"}};var Fe=class extends o{static get name(){return"orderedlist"}static get dependencies(){return[a,ct]}init(){this._i18n(ts),this._tag({name:"ol",group:"list",children:["listitem"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command("ol"),this._toolbar("Ordered List")}},es=Fe;var rt,is,qe=class extends c{constructor(t){super(t);rt.add(this);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertp",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("p")).forEach(e=>m(this,rt,is).call(this,e))}insertp(t){m(this,rt,is).call(this,t.detail.element)}paste(t){this.editor.window.setTimeout(()=>this.editor.filters.filter(t.target))}};rt=new WeakSet,is=function(t){t.addEventListener("paste",this)};var rs=qe;var ss={de:{Paragraph:"Absatz"}};var Ne=class extends o{static get name(){return"paragraph"}static get dependencies(){return[a,C]}init(){this._i18n(ss),this._tag({name:"p",group:"paragraph",children:["break","format"],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"p"}),new rs(this.editor),this._command("p"),this._toolbar("Paragraph")}},os=Ne;var Ue=class extends w{filter(t){t instanceof HTMLElement&&t.localName==="figure"&&t.classList.contains("preformat")&&t.querySelector(":scope > pre")&&!t.querySelector(":scope > figcaption")&&(t.insertAdjacentElement("beforebegin",t.querySelector(":scope > pre")),t.innerHTML="")}},as=Ue;var ze=class extends c{constructor(t){super(t);this.editor.root.addEventListener("insertpre",this),this.editor.root.addEventListener("deletepre",this)}insertpre(t){this.editor.wrap(t.detail.element,"figure",{attributes:{class:"preformat"}})}deletepre(t){t.detail.target.localName==="figure"&&t.detail.target.classList.contains("preformat")&&t.detail.target.parentElement.removeChild(t.detail.target)}},ns=ze;var ls={de:{"Preformatted Text":"Vorformatierter Text"}};var Oe=class extends o{static get name(){return"preformat"}static get dependencies(){return[a,C,x]}init(){this._i18n(ls),this._tag({name:"pre",group:"preformat",children:["break"],deletable:!0,editable:!0,navigable:!0,enter:"p"}),new ns(this.editor),this._command("pre"),this._toolbar("Preformatted Text"),this.editor.filters.add(new as(this.editor))}},ds=Oe;var ms={de:{Quote:"Zitat"}};var Ke=class extends o{static get name(){return"quote"}static get dependencies(){return[a]}init(){this._i18n(ms),this._tag({name:"q",group:"format"}),this._command("q"),this._toolbar("Quote","q",!0)}},cs=Ke;var hs={de:{"Sample Output":"Beispielausgabe"}};var Ve=class extends o{static get name(){return"sample"}static get dependencies(){return[a]}init(){this._i18n(hs),this._tag({name:"samp",group:"format"}),this._command("samp"),this._toolbar("Sample Output","o",!0)}},us=Ve;var $e=class extends p{constructor(t){super(t,"section")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Section")})),t.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}},fs=$e;var ps={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern",Section:"Sektion"}};var Qe=class extends o{static get name(){return"section"}static get dependencies(){return[a]}init(){this._i18n(ps),this._tag({name:"section",group:"container",children:["audio","figure","heading","iframe","image","list","paragraph","preformat","quote","rule","table","video"],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new fs(this.editor)),this._command("section"),this._toolbar("Section")}},gs=Qe;var bs={de:{small:"klein"}};var We=class extends o{static get name(){return"small"}static get dependencies(){return[a]}init(){this._i18n(bs),this._tag({name:"small",group:"format"}),this._command("small"),this._toolbar("small","w",!0)}},Es=We;var ws={de:{strikethrough:"durchgestrichen"}};var Ze=class extends o{static get name(){return"strikethrough"}static get dependencies(){return[a]}init(){this._i18n(ws),this._tag({name:"s",group:"format"}),this._command("s"),this._toolbar("strikethrough","r",!0)}},js=Ze;var xs={de:{"strongly emphasized":"stark betont"}};var Ge=class extends o{static get name(){return"strong"}static get dependencies(){return[a]}init(){this._i18n(xs),this._tag({name:"strong",group:"format"}),this._command("strong"),this._toolbar("strongly emphasized","s",!0)}},Ls=Ge;var _s={de:{Subheading:"Unter\xFCberschrift"}};var Je=class extends o{static get name(){return"subheading"}static get dependencies(){return[a]}init(){this._i18n(_s),this._tag({name:"h3",group:"heading",deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"p"}),this._command("h3"),this._toolbar("Subheading")}},ys=Je;var As={de:{subscript:"tiefgestellt"}};var Xe=class extends o{static get name(){return"subscript"}static get dependencies(){return[a]}init(){this._i18n(As),this._tag({name:"sub",group:"format"}),this._command("sub"),this._toolbar("subscript","x",!0)}},Cs=Xe;var ks={de:{superscript:"hochgestellt"}};var Ye=class extends o{static get name(){return"superscript"}static get dependencies(){return[a]}init(){this._i18n(ks),this._tag({name:"sup",group:"format"}),this._command("sup"),this._toolbar("superscript","y",!0)}},Ts=Ye;var ti=class extends S{constructor(t){super(t,"table","table")}_insert({rows:t=1,cols:e=1}={}){t=t>1?t:1,e=e>1?e:1;let i=this.editor.createElement("figure",{attributes:{class:"table"}}),s=this.editor.createElement("table"),n=this.editor.createElement("tbody");for(let d=0;d<t;d++){let l=this.editor.createElement("tr");n.appendChild(l);for(let f=0;f<e;++f)l.appendChild(this.editor.createElement("td"))}s.appendChild(n),i.appendChild(s),this.editor.insert(i)}},Bs=ti;var ei=class extends p{constructor(t){super(t,"table")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Table")})),t.appendChild(this._createInput("rows","number",this._("Rows"),{min:"1",required:"required",value:"1"})),t.appendChild(this._createInput("cols","number",this._("Columns"),{min:"1",required:"required",value:"1"}))}},Ss=ei;var ii=class extends w{filter(t){t instanceof HTMLElement&&t.localName==="figure"&&t.classList.contains("table")&&t.querySelector(":scope > table")&&!t.querySelector(":scope > figcaption")?(t.insertAdjacentElement("beforebegin",t.querySelector(":scope > table")),t.innerHTML=""):(t instanceof HTMLTableElement&&t.querySelector(":scope > thead, :scope > tfoot")&&!t.querySelector(":scope > tbody")||t instanceof HTMLTableSectionElement&&t.rows.length<=0||t instanceof HTMLTableRowElement&&!t.querySelector(":scope > th:not(:empty), :scope > td:not(:empty)"))&&(t.innerHTML="")}},Ps=ii;var B,ht,M,si,ut,eo,ri=class extends c{constructor(t){super(t);B.add(this);M.add(this);ut.add(this);this.editor.root.addEventListener("inserttable",this),this.editor.root.addEventListener("inserttd",this),this.editor.root.addEventListener("insertth",this)}inserttable(t){this.editor.wrap(t.detail.element,"figure",{attributes:{class:"table"}}),t.detail.element.tBodies.length>0&&t.detail.element.tBodies[0].rows[0]&&(!t.detail.element.tHead||!t.detail.element.tFoot)&&(t.detail.element.tHead||m(this,B,ht).call(this,t.detail.element.createTHead(),t.detail.element.tBodies[0].rows[0].cells.length),t.detail.element.tFoot||m(this,B,ht).call(this,t.detail.element.createTFoot(),t.detail.element.tBodies[0].rows[0].cells.length))}inserttd(t){t.detail.element.addEventListener("keydown",this)}insertth(t){t.detail.element.addEventListener("keydown",this)}keydown(t){let e=t.target,i=e.parentElement,s=i.parentElement,n=s instanceof HTMLTableElement?s:s.parentElement,d=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],l=this.editor.isKey(t,d),f=this.editor.isKey(t,d,{ctrl:!0}),_=this.editor.isKey(t,d,{alt:!0}),T=this.editor.isKey(t,d,{alt:!0,shift:!0});if(e instanceof HTMLTableCellElement&&i instanceof HTMLTableRowElement&&(s instanceof HTMLTableElement||s instanceof HTMLTableSectionElement)&&n instanceof HTMLTableElement&&(l&&m(this,ut,eo).call(this,e,t.key)||f||_||T)){let g=e.cellIndex,j=i.cells.length,k=s.rows.length,y=s instanceof HTMLTableElement?i.rowIndex:i.sectionRowIndex,ft=g===0,pt=g===j-1,Zs=y===0,Gs=y===k-1,pi=i.rowIndex===0,gi=i.rowIndex===n.rows.length-1;t.preventDefault(),t.stopPropagation(),l?t.key==="ArrowLeft"&&!ft?this.editor.focusEnd(i.cells[g-1]):t.key==="ArrowLeft"&&pi?this.editor.focusEnd(n.rows[n.rows.length-1].cells[j-1]):t.key==="ArrowLeft"?this.editor.focusEnd(n.rows[i.rowIndex-1].cells[j-1]):t.key==="ArrowRight"&&!pt?i.cells[g+1].focus():t.key==="ArrowRight"&&gi?n.rows[0].cells[0].focus():t.key==="ArrowRight"?n.rows[i.rowIndex+1].cells[0].focus():t.key==="ArrowUp"&&pi?n.rows[n.rows.length-1].cells[g].focus():t.key==="ArrowUp"?n.rows[i.rowIndex-1].cells[g].focus():t.key==="ArrowDown"&&gi?n.rows[0].cells[g].focus():t.key==="ArrowDown"&&n.rows[i.rowIndex+1].cells[g].focus():f?(t.key==="ArrowLeft"&&j>1&&ft?Array.from(n.rows).forEach(b=>b.appendChild(b.cells[g])):t.key==="ArrowLeft"&&j>1?Array.from(n.rows).forEach(b=>b.insertBefore(b.cells[g],b.cells[g-1])):t.key==="ArrowRight"&&j>1&&pt?Array.from(n.rows).forEach(b=>b.insertBefore(b.cells[g],b.cells[0])):t.key==="ArrowRight"&&j>1?Array.from(n.rows).forEach(b=>b.insertBefore(b.cells[g+1],b.cells[g])):t.key==="ArrowUp"&&k>1&&Zs?s.appendChild(i):t.key==="ArrowUp"&&k>1?s.insertBefore(i,s.rows[y-1]):t.key==="ArrowDown"&&k>1&&Gs?s.insertBefore(i,s.rows[0]):t.key==="ArrowDown"&&k>1&&s.insertBefore(s.rows[y+1],i),e.focus()):_?t.key==="ArrowLeft"?Array.from(n.rows).forEach(b=>m(this,M,si).call(this,b,b.cells[g])):t.key==="ArrowRight"?Array.from(n.rows).forEach(b=>m(this,M,si).call(this,b,b.cells[g+1])):t.key==="ArrowUp"?m(this,B,ht).call(this,s,j,y):t.key==="ArrowDown"&&m(this,B,ht).call(this,s,j,y+1):T&&(t.key==="ArrowLeft"&&!ft?Array.from(n.rows).forEach(b=>b.deleteCell(g-1)):t.key==="ArrowRight"&&!pt?Array.from(n.rows).forEach(b=>b.deleteCell(g+1)):t.key==="ArrowUp"&&y>0?s.deleteRow(y-1):t.key==="ArrowDown"&&y<k-1&&s.deleteRow(y+1))}}};B=new WeakSet,ht=function(t,e,i=0){let s=t.insertRow(i);for(let n=0;n<e;n++)m(this,M,si).call(this,s)},M=new WeakSet,si=function(t,e=null){let i=t.parentElement.localName==="thead"?"th":"td";t.insertBefore(this.editor.createElement(i),e)},ut=new WeakSet,eo=function(t,e){if(["ArrowUp","ArrowDown"].includes(e))return!0;let i=this.editor.window.getSelection();if(!i.isCollapsed)return!1;if(e==="ArrowLeft"){let n=t.firstChild instanceof HTMLElement?t.firstChild.firstChild:t.firstChild;return i.anchorOffset===0&&[t,n].includes(i.anchorNode)}let s=t.lastChild;return t.lastChild instanceof HTMLBRElement&&t.lastChild.previousSibling&&(s=t.lastChild.previousSibling),s instanceof HTMLElement&&(s=s.lastChild),i.anchorOffset===i.anchorNode.textContent.length&&[t,s].includes(i.anchorNode)};var Hs=ri;var Ds={de:{Cancel:"Abbrechen",Columns:"Spalten",Rows:"Zeilen",Save:"Speichern",Table:"Tabelle"}};var oi=class extends o{static get name(){return"table"}static get dependencies(){return[a,C,x]}init(){this._i18n(Ds),this._tag({name:"table",group:"table",children:["tablesection"],deletable:!0,navigable:!0}),this._tag({name:"thead",group:"tablesection",children:["tablerow"]}),this._tag({name:"tbody",group:"tablesection",children:["tablerow"]}),this._tag({name:"tfoot",group:"tablesection",children:["tablerow"]}),this._tag({name:"tr",group:"tablerow",children:["tablecell"]}),this._tag({name:"th",group:"tablecell",children:["break","format"],editable:!0,empty:!0}),this._tag({name:"td",group:"tablecell",children:["break","format"],editable:!0,empty:!0}),new Hs(this.editor),this.editor.filters.add(new Ps(this.editor)),this.editor.dialogs.set(new Ss(this.editor)),this.editor.commands.set(new Bs(this.editor)),this._toolbar("Table")}},Ms=oi;var ai=class extends p{constructor(t){super(t,"time")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Time")})),t.appendChild(this._createInput("datetime","text",this._("Machine-readable Datetime"),{placeholder:this._("Insert date and/or time or leave empty to remove it")}))}},Is=ai;var vs={de:{Cancel:"Abbrechen","Machine-readable Datetime":"Maschinenlesbare Datums-/Zeitangabe","Insert date and/or time or leave empty to remove it":"Datum und/oder Zeit eingeben oder zum Entfernen leer lassen",Save:"Speichern",Time:"Zeit"}};var ni=class extends o{static get name(){return"time"}static get dependencies(){return[a]}init(){this._i18n(vs),this._tag({name:"time",group:"format",attributes:["datetime"]}),this.editor.dialogs.set(new Is(this.editor)),this._command("time"),this._toolbar("Time","t",!0)}},Rs=ni;var Fs={de:{underline:"unterstrichen"}};var li=class extends o{static get name(){return"underline"}static get dependencies(){return[a]}init(){this._i18n(Fs),this._tag({name:"u",group:"format"}),this._command("u"),this._toolbar("underline","u",!0)}},qs=li;var Ns={de:{"Unordered List":"Ungeordnete Liste"}};var di=class extends o{static get name(){return"unorderedlist"}static get dependencies(){return[a,ct]}init(){this._i18n(Ns),this._tag({name:"ul",group:"list",children:["listitem"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command("ul"),this._toolbar("Unordered List")}},Us=di;var zs={de:{Variable:"Variable"}};var mi=class extends o{static get name(){return"variable"}static get dependencies(){return[a]}init(){this._i18n(zs),this._tag({name:"var",group:"format"}),this._command("var"),this._toolbar("Variable","v",!0)}},Os=mi;var ci=class extends p{constructor(t){super(t,"video")}_initFieldset(t){t.appendChild(this.editor.createElement("legend",{html:this._("Video")})),t.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to video"),required:"required"})),t.appendChild(this._createInput("width","number",this._("Width"))),t.appendChild(this._createInput("height","number",this._("Height")))}},Ks=ci;var st,Vs,hi=class extends c{constructor(t){super(t);st.add(this);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertvideo",this)}sethtml(t){Array.from(t.detail.element.getElementsByTagName("video")).forEach(e=>m(this,st,Vs).call(this,e))}insertvideo(t){m(this,st,Vs).call(this,t.detail.element)}};st=new WeakSet,Vs=function(t){let e=t.getAttribute("src");e?(t.setAttribute("src",this.editor.url(e)),t.controls=!0,this.editor.wrap(t,"figure",{attributes:{class:"video"}})):t.parentElement.removeChild(t)};var $s=hi;var Qs={de:{Cancel:"Abbrechen",Height:"H\xF6he","Insert URL to video":"URL zur Videodatei eingeben",Save:"Speichern",URL:"URL",Video:"Video",Width:"Breite"}};var ui=class extends o{static get name(){return"video"}static get dependencies(){return[a,x]}static get config(){return{browser:null}}init(){this._i18n(Qs),this._tag({name:"video",group:"video",attributes:["controls","height","src","width"],empty:!0,navigable:!0}),new $s(this.editor),this.editor.config.video.browser?this.editor.dialogs.set(new A(this.editor,"video",this.editor.config.video.browser)):this.editor.dialogs.set(new Ks(this.editor)),this._command("video"),this._toolbar("Video")}},Ws=ui;var fi=class extends L{static get defaultConfig(){return{base:{plugins:[sr,zr,Ls,Ar,qs,js,Zr,Jr,Es,ur,Ni,cs,ar,lr,Kr,us,Os,Cs,Ts,Rs,cr,Nr,pr,os,kr,ys,Us,es,Br,ir,Fr,Ws,Qi,Dr,Ms,ds,gs,jr,_r,Ji]}}}},io=fi;export{io as default};
