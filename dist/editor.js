var Go=Object.defineProperty;var Ko=(s,t,e)=>t in s?Go(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var N=(s,t,e)=>(Ko(s,typeof t!="symbol"?t+"":t,e),e),gi=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var h=(s,t,e)=>(gi(s,t,"read from private field"),e?e.call(s):t.get(s)),d=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},g=(s,t,e,r)=>(gi(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e);var f=(s,t,e)=>(gi(s,t,"access private method"),e);var o=Object.freeze({AUDIO:"audio",BLOCK:"block",BREAK:"break",CAPTION:"caption",CONTAINER:"container",FIGURE:"figure",FORMAT:"format",HEADING:"heading",IFRAME:"iframe",IMAGE:"image",LIST:"list",LISTITEM:"listitem",PARAGRAPH:"paragraph",PREFORMAT:"preformat",QUOTE:"quote",ROOT:"root",RULE:"rule",SLOT:"slot",SUMMARY:"summary",TABLE:"table",TABLECELL:"tablecell",TABLEROW:"tablerow",TABLESECTION:"tablesection",VIDEO:"video"}),i=Object.freeze({A:"a",ABBR:"abbr",ALL:"*",AUDIO:"audio",B:"b",BLOCK:"app-block",BLOCKQUOTE:"blockquote",BR:"br",BUTTON:"button",CITE:"cite",CODE:"code",DATA:"data",DEL:"del",DETAILS:"details",DFN:"dfn",DIALOG:"editor-dialog",DIV:"div",EDITOR:"akilli-editor",EM:"em",FIELDSET:"fieldset",FIGCAPTION:"figcaption",FIGURE:"figure",FOCUSBAR:"editor-focusbar",FORM:"form",FORMATBAR:"editor-formatbar",H2:"h2",H3:"h3",HR:"hr",I:"i",IFRAME:"iframe",IMG:"img",INPUT:"input",INS:"ins",KBD:"kbd",LABEL:"label",LEGEND:"legend",LI:"li",MARK:"mark",OL:"ol",P:"p",PRE:"pre",Q:"q",ROOT:"editor-root",S:"s",SAMP:"samp",SECTION:"section",SLOT:"slot",SMALL:"small",STRONG:"strong",SUB:"sub",SUMMARY:"summary",SUP:"sup",TABLE:"table",TBODY:"tbody",TD:"td",TFOOT:"tfoot",TH:"th",THEAD:"thead",TIME:"time",TOOLBAR:"editor-toolbar",TR:"tr",U:"u",UL:"ul",VAR:"var",VIDEO:"video"});function It(s){return typeof s>"u"}function q(s){return typeof s=="function"}function x(s){return s&&typeof s=="string"}function j(s){return It(s)||x(s)}function Ei(s){return It(s)||Array.isArray(s)&&s.length>0}function bi(s){return It(s)||s instanceof HTMLElement}var _t,yt,Rt,Ot,Nt,Ti,Ct,Li,C=class{constructor(t,e,r=void 0){d(this,Nt);d(this,Ct);d(this,_t,void 0);d(this,yt,void 0);d(this,Rt,void 0);d(this,Ot,void 0);if(!(t instanceof _)||!x(e)||!j(r))throw new TypeError("Invalid argument");g(this,_t,t),g(this,yt,e),g(this,Rt,r&&this.editor.tags.get(r)),g(this,Ot,this.editor.dialogs.get(e))}get editor(){return h(this,_t)}get name(){return h(this,yt)}get tag(){return h(this,Rt)}get dialog(){return h(this,Ot)}execute(){this.dialog?this.openDialog():this.insert(f(this,Nt,Ti).call(this))}insert(t={}){if(!this.tag)return;f(this,Ct,Li).call(this,t);let e=this.editor.dom.getSelectedElementByName(this.tag.name);this.tag.group!==o.FORMAT?this.editor.dom.insert(this.editor.dom.createElement(this.tag.name,{attributes:t})):e&&Object.keys(t).length>0?e.parentElement.replaceChild(this.editor.dom.createElement(this.tag.name,{attributes:t,html:e.textContent}),e):e?e.parentElement.replaceChild(this.editor.dom.createText(e.textContent),e):this.editor.dom.format(this.editor.dom.createElement(this.tag.name,{attributes:t}))}openDialog(){this.dialog?.open(t=>this.insert(t),f(this,Nt,Ti).call(this))}};_t=new WeakMap,yt=new WeakMap,Rt=new WeakMap,Ot=new WeakMap,Nt=new WeakSet,Ti=function(){if(!this.tag)return{};let t=this.editor.dom.getSelectedAttributesByName(this.tag.name);return f(this,Ct,Li).call(this,t),t},Ct=new WeakSet,Li=function(t){Object.keys(t).forEach(e=>this.tag.attributes.includes(e)&&t[e]||delete t[e])};var V,St=class{constructor(t=[]){d(this,V,new Map);t.forEach(e=>this.set(e))}get(t){return h(this,V).get(t)}set(t){if(!(t instanceof C))throw new TypeError("Invalid argument");h(this,V).set(t.name,t)}find(t){return Array.from(h(this,V).values()).find(e=>e.tag?.name===t)}execute(t){this.get(t).execute()}freeze(){h(this,V).forEach(t=>Object.freeze(t)),Object.freeze(h(this,V)),Object.freeze(this)}};V=new WeakMap;var Z,Mt=class{constructor(t=[]){d(this,Z,new Map);t.forEach(e=>this.set(e))}get(t){return h(this,Z).get(t)}set(t){if(!(t instanceof L))throw new TypeError("Invalid argument");h(this,Z).set(t.name,t)}freeze(){h(this,Z).forEach(t=>Object.freeze(t)),Object.freeze(h(this,Z)),Object.freeze(this)}};Z=new WeakMap;var gt,Et,Wr,$r,Gi,W=class{constructor(t){d(this,Et);d(this,$r);d(this,gt,void 0);if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");g(this,gt,t),this.register(f(this,$r,Gi).bind(this))}dispatch(t,e=void 0,r=void 0){if(!x(t)||!bi(e)||!bi(r))throw new TypeError("Invalid argument");h(this,gt).dispatchEvent(new CustomEvent(t,{detail:{element:e,target:r}}))}register(t,e={childList:!0,subtree:!0}){if(!q(t))throw new TypeError("Invalid argument");new MutationObserver(t).observe(h(this,gt),e)}};gt=new WeakMap,Et=new WeakSet,Wr=function(t,e,r){e instanceof HTMLElement&&r instanceof HTMLElement&&(this.dispatch(t,e,r),this.dispatch(`${t}${e.localName.replace("-","")}`,e,r))},$r=new WeakSet,Gi=function(t){t.forEach(e=>{e.addedNodes.forEach(r=>{r instanceof HTMLElement&&(f(this,Et,Wr).call(this,"insert",r,e.target),Array.from(r.getElementsByTagName(i.ALL)).forEach(n=>f(this,Et,Wr).call(this,"insert",n,e.target)))}),e.removedNodes.forEach(r=>r instanceof HTMLElement&&f(this,Et,Wr).call(this,"delete",r,e.target))})};var A=class{static get FIRST(){return"first"}static get PREV(){return"prev"}static get NEXT(){return"next"}static get LAST(){return"last"}static values(){return[this.FIRST,this.PREV,this.NEXT,this.LAST]}};var Dt,Ft,vt,Ht,Yr,bt,Qr,Zr,Ki,Bt=class{constructor(t,e){d(this,bt);d(this,Zr);d(this,Dt,void 0);d(this,Ft,void 0);d(this,vt,void 0);d(this,Ht,void 0);d(this,Yr,{alwaysRaised:"yes",dependent:"yes",height:"",location:"no",menubar:"no",minimizable:"no",modal:"yes",resizable:"yes",scrollbars:"yes",toolbar:"no",width:""});if(!(t instanceof _)||!(e instanceof Document))throw new TypeError("Invalid argument");g(this,Dt,t),g(this,Ft,e),g(this,vt,this.document.defaultView),g(this,Ht,this.document.documentElement)}get editor(){return h(this,Dt)}get document(){return h(this,Ft)}get window(){return h(this,vt)}get root(){return h(this,Ht)}registerElement(t,e,r=void 0){It(this.window.customElements.get(t))&&this.window.customElements.define(t,e,r?{extends:r}:void 0)}createElement(t,{attributes:e={},html:r=""}={}){let n=this.document.createElement(t);return n.innerHTML=r,Object.entries(e).forEach(([u,c])=>c&&n.setAttribute(u,`${c}`)),n}insert(t){if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");let e=this.getSelectedEditable();if(e instanceof HTMLSlotElement&&this.editor.tags.allowed(e.parentElement,t))this.insertBefore(t,e);else if(e){let r=this.closest(e,t);r&&this.insertAfter(t,r),e.hasAttribute("data-deletable")&&!e.textContent.trim()&&e.parentElement.removeChild(e)}else if(this.editor.tags.allowed(this.editor.root,t))this.insertLastChild(t,this.editor.root);else throw new TypeError("Invalid argument")}insertText(t){let e=this.getSelectedEditable();if(e){let r=this.getRange();r.deleteContents(),r.insertNode(this.createText(t)),r.collapse(),e.normalize()}}format(t){if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");let e=this.getRange(),r=this.getSelectedEditable();if(!e||e.collapsed||!e.toString().trim()||!r||!this.editor.tags.allowed(r,t))return;e.startContainer instanceof Text&&e.startContainer.parentElement!==r&&e.setStartBefore(e.startContainer.parentElement),e.endContainer instanceof Text&&e.endContainer.parentElement!==r&&e.setEndAfter(e.endContainer.parentElement);let n=e.toString(),u=Array.from(e.cloneContents().childNodes).every(c=>c instanceof Text&&!c.textContent.trim()||c instanceof HTMLElement&&c.localName===t.localName);e.deleteContents(),u?e.insertNode(this.createText(n)):(t.textContent=n,e.insertNode(t)),r.normalize()}createText(t){return this.document.createTextNode(t)}createTable(t=1,e=1){let r=this.createElement(i.TABLE);return this.insertLastChild(this.createTableHeader(1,e),r),this.insertLastChild(this.createTableBody(t,e),r),this.insertLastChild(this.createTableFooter(1,e),r),r}createTableHeader(t=1,e=1){return f(this,bt,Qr).call(this,i.THEAD,t,e)}createTableBody(t=1,e=1){return f(this,bt,Qr).call(this,i.TBODY,t,e)}createTableFooter(t=1,e=1){return f(this,bt,Qr).call(this,i.TFOOT,t,e)}createTableHeaderRow(t){let e=this.createElement(i.TR);for(let r=0;r<t;r++)this.insertLastChild(this.createElement(i.TH),e);return e}createTableRow(t){let e=this.createElement(i.TR);for(let r=0;r<t;r++)this.insertLastChild(this.createElement(i.TD),e);return e}arbitrary(t){return t===this.editor.root||t?.hasAttribute("data-arbitrary")}contains(t){if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");if(this.editor.root.contains(t))return!0;let e=t.closest(this.editor.root.localName);return e&&!e.parentElement}closest(t,e){if(!(t instanceof HTMLElement)||!this.contains(t.parentElement))throw new TypeError("Invalid argument");let r=t,n=t.parentElement;do if(this.arbitrary(n)&&this.editor.tags.allowed(n,e))return r;while((r=n)&&(n=n.parentElement)&&this.contains(n))}wrap(t,e,r={}){let n;if(t instanceof HTMLElement){if(t.parentElement.localName!==e&&(n=this.closest(t,e))){let u=this.createElement(e,r);this.insertAfter(u,n),this.insertLastChild(t,u)}}else throw new TypeError("Invalid argument")}getActiveElement(){let t=this.document.activeElement;return t&&this.contains(t)?t:void 0}getSelectedElement(){let t=this.getSelection(),e=t.anchorNode instanceof Text?t.anchorNode.parentElement:t.anchorNode,r=t.focusNode instanceof Text?t.focusNode.parentElement:t.focusNode;if(e instanceof HTMLElement&&r instanceof HTMLElement&&e===r&&this.contains(e))return e}getSelectedElementByName(t){let e=this.getSelectedElement();return e?.localName===t&&e||void 0}getSelectedAttributesByName(t){let e=this.getSelectedElementByName(t),r={};return e&&Array.from(e.attributes).forEach(n=>r[n.nodeName]=n.nodeValue),r}getSelectedEditable(){let t=this.getSelection(),e=t.anchorNode instanceof Text?t.anchorNode.parentElement:t.anchorNode,r=t.focusNode instanceof Text?t.focusNode.parentElement:t.focusNode;if(e instanceof HTMLElement&&r instanceof HTMLElement){let n=e.closest("[contenteditable=true]"),u=r.closest("[contenteditable=true]");if(n instanceof HTMLElement&&n===u&&this.contains(n))return n}}getSelection(){return this.window.getSelection()}getRange(){let t=this.getSelection();return t.rangeCount>0?t.getRangeAt(0):void 0}setRange(t){let e=this.getSelection();e.removeAllRanges(),e.addRange(t)}selectContents(t){if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");let e=this.document.createRange();e.selectNodeContents(t),this.setRange(e)}focusEnd(t){if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");t.focus();let e=this.document.createRange();e.selectNodeContents(t),e.collapse(),this.setRange(e)}delete(t){if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");let e=t.previousElementSibling,r=t.nextElementSibling;t.parentElement.removeChild(t),e instanceof HTMLElement&&e.hasAttribute("data-focusable")?this.focusEnd(e):r instanceof HTMLElement&&r.hasAttribute("data-focusable")&&r.focus()}sort(t,e){if(!(t instanceof HTMLElement)||!A.values().includes(e))throw new TypeError("Invalid argument");let r=t.parentElement,n=t.previousElementSibling,u=t.nextElementSibling,c=r.firstElementChild,E=r.lastElementChild,b=t===c,T=t===E;e===A.PREV&&!b&&n.hasAttribute("data-sortable")?this.insertBefore(t,n):e===A.NEXT&&!T&&u.hasAttribute("data-sortable")?this.insertAfter(t,u):(e===A.FIRST&&!b||e===A.NEXT&&T)&&c.hasAttribute("data-sortable")?this.insertBefore(t,c):(e===A.LAST&&!T||e===A.PREV&&b)&&E.hasAttribute("data-sortable")&&this.insertAfter(t,E)}insertBefore(t,e){if(!(t instanceof HTMLElement)||!(e instanceof HTMLElement))throw new TypeError("Invalid argument");e.insertAdjacentElement("beforebegin",t)}insertAfter(t,e){if(!(t instanceof HTMLElement)||!(e instanceof HTMLElement))throw new TypeError("Invalid argument");e.insertAdjacentElement("afterend",t)}insertFirstChild(t,e){if(!(t instanceof HTMLElement)||!(e instanceof HTMLElement))throw new TypeError("Invalid argument");e.insertAdjacentElement("afterbegin",t)}insertLastChild(t,e){if(!(t instanceof HTMLElement)||!(e instanceof HTMLElement))throw new TypeError("Invalid argument");e.insertAdjacentElement("beforeend",t)}open({url:t,name:e,call:r,params:n={}}){if(!x(t)||!x(e)||!q(r))throw new TypeError("Invalid argument");let u=this.createElement(i.A,{attributes:{href:t}}),c=new URL(u.href);Object.entries(n).forEach(([b,T])=>c.searchParams.set(b,`${T}`));let E=this.window.open(c.toString(),e,f(this,Zr,Ki).call(this));this.window.addEventListener("message",b=>{b.origin===c.origin&&b.source===E&&(r(b.data),E.close())},!1)}getWidth(){return this.window.screen.width}getHeight(){return this.window.screen.height}};Dt=new WeakMap,Ft=new WeakMap,vt=new WeakMap,Ht=new WeakMap,Yr=new WeakMap,bt=new WeakSet,Qr=function(t,e,r){let n=this.createElement(t);for(let u=0;u<e;u++)this.insertLastChild(t===i.THEAD?this.createTableHeaderRow(r):this.createTableRow(r),n);return n},Zr=new WeakSet,Ki=function(){let t=Object.assign({},h(this,Yr),{height:`${this.getHeight()}`,width:`${this.getWidth()}`},this.editor.config.base.browser);return Object.entries(t).filter(([,e])=>!!e).map(([e,r])=>`${e}=${r}`).join(",")};var Pt,y=class{constructor(t){d(this,Pt,void 0);if(!(t instanceof _))throw new TypeError("Invalid argument");g(this,Pt,t)}get editor(){return h(this,Pt)}filter(t){throw new Error("Not implemented")}};Pt=new WeakMap;var X,kt=class{constructor(){d(this,X,new Set)}add(t){if(!(t instanceof y))throw new TypeError("Invalid argument");h(this,X).add(t)}filter(t){if(!(t instanceof HTMLElement))throw new TypeError("Invalid argument");h(this,X).forEach(e=>{t.normalize(),e.filter(t)})}freeze(){h(this,X).forEach(t=>Object.freeze(t)),Object.freeze(h(this,X)),Object.freeze(this)}};X=new WeakMap;var J=class{constructor({name:t,group:e,...r}={}){N(this,"name");N(this,"group");N(this,"children");N(this,"attributes");N(this,"alignable");N(this,"arbitrary");N(this,"deletable");N(this,"editable");N(this,"empty");N(this,"focusable");N(this,"navigable");N(this,"slotable");N(this,"sortable");N(this,"enter");if(!x(t)||!x(e)||!Ei(r.children)||!Ei(r.attributes)||!j(r.enter))throw new TypeError("Invalid argument");this.name=t,this.group=e,this.children=r.children||[],this.attributes=r.attributes||[],this.arbitrary=r.arbitrary===!0,this.alignable=r.alignable===!0,this.deletable=r.deletable===!0,this.editable=r.editable===!0,this.empty=r.empty===!0,this.focusable=r.focusable===!0,this.navigable=r.navigable===!0,this.slotable=r.slotable===!0,this.sortable=r.sortable===!0,this.enter=r.enter}};var Ut,Tt,Xr,m=class{constructor(t){d(this,Tt);d(this,Ut,void 0);if(!(t instanceof _))throw new TypeError("Invalid argument");g(this,Ut,t)}get editor(){return h(this,Ut)}static get name(){throw new Error("Missing name")}static get dependencies(){return[]}static get config(){return{}}init(){throw new Error("Not implemented")}_(t){return this.editor.translator.translate(this.constructor.name,t)}_base(t){return this.editor.translator.translate("base",t)}_i18n(t){t[this.editor.config.base.lang]&&this.editor.translator.set(this.constructor.name,t[this.editor.config.base.lang])}_tag(t){this.editor.tags.set(new J(t))}_command(t){this.editor.commands.set(new C(this.editor,this.constructor.name,t))}_toolbar(t,e=void 0){this.editor.dom.insertLastChild(f(this,Tt,Xr).call(this,t,t,void 0,e),this.editor.toolbar)}_formatbar(t,e=void 0,r=void 0){let n=this._base("Alt"),u=this._base("Shift"),c=t+(e?` [${n} + ${u} + ${e}]`:"");this.editor.dom.insertLastChild(f(this,Tt,Xr).call(this,t,c,e,r),this.editor.formatbar)}_focusbar(t,e=void 0){this.editor.dom.insertLastChild(f(this,Tt,Xr).call(this,t,t,void 0,e),this.editor.focusbar)}};Ut=new WeakMap,Tt=new WeakSet,Xr=function(t,e,r=void 0,n=void 0){if(!x(t)||!x(e)||!j(r))throw new TypeError("Invalid argument");return this.editor.dom.createElement(i.BUTTON,{attributes:{type:"button",title:e,"data-command":n||this.constructor.name,"data-key":r},html:t})};var $,Gt=class{constructor(t=[]){d(this,$,new Map);t.forEach(e=>this.set(e))}get(t){return h(this,$).get(t)}set(t){if(!(t instanceof m))throw new TypeError("Invalid argument");h(this,$).set(t.constructor.name,t)}init(){h(this,$).forEach(t=>t.init())}freeze(){h(this,$).forEach(t=>Object.freeze(t)),Object.freeze(h(this,$)),Object.freeze(this)}};$=new WeakMap;var tt,Kt=class{constructor(t=[]){d(this,tt,new Map);t.forEach(e=>this.set(e))}get(t){return h(this,tt).get(t instanceof HTMLElement?t.localName:t)}set(t){if(!(t instanceof J))throw new TypeError("Invalid argument");h(this,tt).set(t.name,t)}allowed(t,e,r=!1){let n=r?e:this.get(e)?.group;return!!this.get(t)?.children.includes(n)}freeze(){h(this,tt).forEach(t=>{Object.freeze(t.children),Object.freeze(t.attributes),Object.freeze(t)}),Object.freeze(h(this,tt)),Object.freeze(this)}};tt=new WeakMap;var et,zt=class{constructor(){d(this,et,new Map)}get(t){return h(this,et).get(t)}set(t,e){if(!x(t)||!(e instanceof Object))throw new TypeError("Invalid argument");h(this,et).set(t,e)}translate(t,e){return this.get(t)?.[e]||e}freeze(){h(this,et).forEach(t=>Object.freeze(t)),Object.freeze(h(this,et)),Object.freeze(this)}};et=new WeakMap;var qt,Lt,jt,Vt,Wt,$t,Qt,Yt,Zt,Xt,Jt,te,Jr,ti,ei,ri,ii,oi,_=class{constructor(t,e={}){d(this,qt,void 0);d(this,Lt,{});d(this,jt,void 0);d(this,Vt,void 0);d(this,Wt,void 0);d(this,$t,void 0);d(this,Qt,void 0);d(this,Yt,void 0);d(this,Zt,void 0);d(this,Xt,void 0);d(this,Jt,void 0);d(this,te,void 0);d(this,Jr,new zt);d(this,ti,new Kt);d(this,ei,new kt);d(this,ri,new Mt);d(this,ii,new St);d(this,oi,new Gt);if(!(t instanceof HTMLElement)||!(e instanceof Object))throw new TypeError("Invalid argument");g(this,qt,t),g(this,Lt,e),g(this,jt,new Bt(this,this.orig.ownerDocument)),g(this,Vt,this.dom.createElement(i.EDITOR)),g(this,Wt,this.dom.createElement(i.TOOLBAR,{attributes:{role:"toolbar"}})),this.dom.insertLastChild(this.toolbar,this.element),g(this,$t,new W(this.toolbar)),g(this,Qt,this.dom.createElement(i.FORMATBAR,{attributes:{role:"toolbar"}})),this.formatbar.hidden=!0,this.dom.insertLastChild(this.formatbar,this.element),g(this,Yt,new W(this.formatbar)),g(this,Zt,this.dom.createElement(i.FOCUSBAR,{attributes:{role:"toolbar"}})),this.focusbar.hidden=!0,this.dom.insertLastChild(this.focusbar,this.element),g(this,Xt,new W(this.focusbar)),g(this,Jt,this.dom.createElement(i.ROOT)),this.dom.insertLastChild(this.root,this.element),g(this,te,new W(this.root))}get orig(){return h(this,qt)}get config(){return h(this,Lt)}get dom(){return h(this,jt)}get element(){return h(this,Vt)}get toolbar(){return h(this,Wt)}get toolbarDispatcher(){return h(this,$t)}get formatbar(){return h(this,Qt)}get formatbarDispatcher(){return h(this,Yt)}get focusbar(){return h(this,Zt)}get focusbarDispatcher(){return h(this,Xt)}get root(){return h(this,Jt)}get rootDispatcher(){return h(this,te)}get translator(){return h(this,Jr)}get tags(){return h(this,ti)}get filters(){return h(this,ei)}get dialogs(){return h(this,ri)}get commands(){return h(this,ii)}get plugins(){return h(this,oi)}static get defaultConfig(){return{}}init(){let t=this.config;g(this,Lt,{});let e=this.constructor.defaultConfig.base?.plugins||[],r=e;if(Array.isArray(t.base?.plugins)&&t.base.plugins.length>0){let c=t.base.plugins;t.base?.pluginsDisabled?r=r.filter(E=>!c.includes(E.name)):(r=[],c.forEach(E=>{let b=e.find(T=>T.name===E);b&&r.push(b)}))}let n=new Set,u=c=>{c.dependencies?.forEach(u),n.add(c)};r.map(u),n.forEach(c=>{Object.entries(c.config).forEach(([E,b])=>{var T,S;(T=this.config)[S=c.name]??(T[S]={}),this.config[c.name][E]=t[c.name]?.[E]||this.constructor.defaultConfig[c.name]?.[E]||b}),this.plugins.set(new c(this))}),this.config.base.lang&&(this.element.lang=this.config.base.lang),this.plugins.init(),this.toolbarDispatcher.dispatch("init"),this.formatbarDispatcher.dispatch("init"),this.focusbarDispatcher.dispatch("init"),this.rootDispatcher.dispatch("init")}freeze(){Object.freeze(this.config),this.translator.freeze(),this.tags.freeze(),this.filters.freeze(),this.dialogs.freeze(),this.commands.freeze(),this.plugins.freeze()}load(){this.orig instanceof HTMLTextAreaElement?(this.orig.form.addEventListener("submit",()=>this.save()),this.setHtml(this.orig.value.replace("/&nbsp;/g"," "))):this.setHtml(this.orig.innerHTML),this.dom.insertAfter(this.element,this.orig),this.orig.hidden=!0,this.rootDispatcher.dispatch("load")}destroy(){this.element.parentElement.removeChild(this.element),this.orig.hidden=!1,this.rootDispatcher.dispatch("destroy")}getHtml(){let t=this.dom.createElement(this.root.localName,{html:this.root.innerHTML});return this.filters.filter(t),this.rootDispatcher.dispatch("gethtml",t),t.innerHTML}setHtml(t){let e=this.dom.createElement(this.root.localName,{html:t});this.rootDispatcher.dispatch("sethtml",e),this.filters.filter(e),this.root.innerHTML=e.innerHTML}save(){this.orig instanceof HTMLTextAreaElement?this.orig.value=this.getHtml():this.orig.innerHTML=this.getHtml(),this.rootDispatcher.dispatch("save")}url(t){let e=this.dom.window.origin||this.dom.window.location.origin,r=this.dom.createElement(i.A,{attributes:{href:t}});return e===r.origin?r.pathname:r.href}static create(t,e={}){let r=new this(t,e);return r.init(),r.freeze(),r.load(),r}};qt=new WeakMap,Lt=new WeakMap,jt=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,$t=new WeakMap,Qt=new WeakMap,Yt=new WeakMap,Zt=new WeakMap,Xt=new WeakMap,Jt=new WeakMap,te=new WeakMap,Jr=new WeakMap,ti=new WeakMap,ei=new WeakMap,ri=new WeakMap,ii=new WeakMap,oi=new WeakMap;var R=class{static get NONE(){return"none"}static get LEFT(){return"left"}static get CENTER(){return"center"}static get RIGHT(){return"right"}static values(){return[this.NONE,this.LEFT,this.CENTER,this.RIGHT]}};var a=class{static get A(){return"a"}static get B(){return"b"}static get BACKSPACE(){return"Backspace"}static get C(){return"c"}static get D(){return"d"}static get DEL(){return"Delete"}static get DOWN(){return"ArrowDown"}static get E(){return"e"}static get END(){return"End"}static get ENTER(){return"Enter"}static get ESC(){return"Escape"}static get F(){return"f"}static get G(){return"g"}static get HOME(){return"Home"}static get I(){return"i"}static get J(){return"j"}static get K(){return"k"}static get L(){return"l"}static get LEFT(){return"ArrowLeft"}static get M(){return"m"}static get O(){return"o"}static get Q(){return"q"}static get R(){return"r"}static get RIGHT(){return"ArrowRight"}static get S(){return"s"}static get SPACE(){return" "}static get T(){return"t"}static get TAB(){return"Tab"}static get U(){return"u"}static get UP(){return"ArrowUp"}static get V(){return"v"}static get W(){return"w"}static get X(){return"x"}static get Y(){return"y"}static get Z(){return"z"}static isEventFor(t,e,{alt:r=!1,ctrl:n=!1,shift:u=!1}={}){return(Array.isArray(e)&&e.includes(t.key)||t.key===e)&&t.altKey===r&&t.ctrlKey===n&&t.shiftKey===u}};var ee,p=class{constructor(t){d(this,ee,void 0);if(!(t instanceof _))throw new TypeError("Invalid argument");g(this,ee,t)}get editor(){return h(this,ee)}handleEvent(t){q(this[t.type])&&this[t.type](t)}};ee=new WeakMap;var re=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insert",this)}insert({detail:{element:t}}){t.hasAttribute("data-alignable")&&t.addEventListener("keydown",this)}keydown(t){let e={[a.UP]:R.NONE,[a.LEFT]:R.LEFT,[a.DOWN]:R.CENTER,[a.RIGHT]:R.RIGHT};t.target===t.currentTarget&&a.isEventFor(t,Object.keys(e),{shift:!0})&&(t.preventDefault(),t.stopPropagation(),t.target.classList.remove(...R.values()),e[t.key]!==R.NONE&&t.target.classList.add(e[t.key]))}};var si,zi,oe,xi,ie=class extends y{constructor(){super(...arguments);d(this,si);d(this,oe)}filter(e){let r=this.editor.tags.get(e),n=this.editor.tags.allowed(e,i.P),u=r.editable||r.group===o.FORMAT,c=[],E=(b=null)=>{if(n&&c.length>0){let T=this.editor.dom.createElement(i.P,{html:c.join(" ")});b?this.editor.dom.insertBefore(T,b):this.editor.dom.insertLastChild(T,e),c=[]}};Array.from(e.childNodes).forEach(b=>{let T=b.textContent.trim();if(b instanceof HTMLElement){let S=f(this,si,zi).call(this,b),K=this.editor.tags.get(S);if(K&&this.editor.tags.allowed(e,S))E(S),f(this,oe,xi).call(this,S,K);else if(K&&K.group===o.FORMAT&&n){let w=f(this,oe,xi).call(this,S,K);w&&(c.push(w.outerHTML),e.removeChild(w))}else!u&&T&&n?(c.push(T),e.removeChild(S)):u&&T?e.replaceChild(this.editor.dom.createText(T),S):e.removeChild(S)}else b instanceof Text?(!u&&T&&n&&c.push(T),(!u||!T)&&e.removeChild(b)):b instanceof Node&&e.removeChild(b)}),E()}};si=new WeakSet,zi=function(e){let r=this.editor.config.base.filter[e.localName];if(!r)return e;let n=this.editor.dom.createElement(r,{html:e.innerHTML});return e.parentElement.replaceChild(n,e),n},oe=new WeakSet,xi=function(e,r){if(Array.from(e.attributes).forEach(n=>!r.attributes.includes(n.name)&&e.removeAttribute(n.name)),e.hasChildNodes()&&this.editor.filters.filter(e),e.hasChildNodes()||r.empty)return e;e.parentElement?.removeChild(e)};var se=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insert",this)}insert({detail:{element:t}}){t.hasAttribute("data-deletable")&&t.addEventListener("keydown",this)}keydown(t){t.target===t.currentTarget&&a.isEventFor(t,a.DEL,{ctrl:!0})&&(this.editor.dom.delete(t.target),t.preventDefault(),t.stopPropagation())}};var ae=class extends HTMLElement{get open(){return this.hasAttribute("open")}set open(t){t===!0?this.setAttribute("open",""):this.removeAttribute("open")}constructor(){super(),this.addEventListener("keydown",t=>t.key===a.ESC&&this.close()),this.addEventListener("click",t=>t.target===this&&this.close())}connectedCallback(){this.setAttribute("role","dialog"),this.tabIndex=-1,this.focus()}show(){this.open=!0,this.dispatchEvent(new CustomEvent("show",{detail:{element:this,target:this}}))}close(){this.open=!1,this.dispatchEvent(new CustomEvent("close",{detail:{element:this,target:this}}))}};var ne=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insert",this)}insert({detail:{element:t}}){t.contentEditable==="true"?t.addEventListener("keydown",this):t.parentElement.contentEditable==="true"&&t.addEventListener("dblclick",this)}keydown(t){if(a.isEventFor(t,a.ENTER,{shift:!0})&&!this.editor.tags.allowed(t.target,i.BR))t.preventDefault(),t.stopPropagation();else if(a.isEventFor(t,a.ENTER)){t.preventDefault(),t.stopPropagation();let e=this.editor.tags.get(t.target)?.enter;if(e){if(t.target.textContent.trim()||!t.target.hasAttribute("data-deletable")){let r=this.editor.dom.closest(t.target,e);r&&this.editor.dom.insertAfter(this.editor.dom.createElement(e),r)}else if(!(t.target instanceof HTMLParagraphElement)){let r=this.editor.dom.closest(t.target,i.P);r&&this.editor.dom.insertAfter(this.editor.dom.createElement(i.P),r),t.target.parentElement.removeChild(t.target)}}}else a.isEventFor(t,a.BACKSPACE)&&!t.target.textContent&&t.target.hasAttribute("data-deletable")?(this.editor.dom.delete(t.target),t.preventDefault(),t.stopPropagation()):/^[A-Z]$/.test(t.key)&&a.isEventFor(t,t.key,{alt:!0,shift:!0})&&(t.preventDefault(),t.stopPropagation(),this.editor.formatbar.querySelector(`${i.BUTTON}[data-key=${t.key.toLowerCase()}]`)?.click())}dblclick(t){this.editor.dom.selectContents(t.target),this.editor.commands.find(t.target.localName)?.execute()}};var de=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insert",this)}insert({detail:{element:t}}){t.hasAttribute("data-focusable")&&t.focus()}};var H=class extends p{insertbutton({detail:{element:t}}){t.getAttribute("data-command")&&t.addEventListener("click",this)}click(t){this.editor.commands.execute(t.target.getAttribute("data-command"))}keydown(t){if(a.isEventFor(t,[a.LEFT,a.RIGHT,a.HOME,a.END])){let e=t.target.previousElementSibling,r=t.target.nextElementSibling,n=t.target.parentElement.firstElementChild,u=t.target.parentElement.lastElementChild,c=t.target===n,E=t.target===u;t.key===a.LEFT&&!c?e.focus():t.key===a.RIGHT&&!E?r.focus():t.key===a.HOME||t.key===a.RIGHT&&E?n.focus():(t.key===a.END||t.key===a.LEFT&&c)&&u.focus(),t.preventDefault(),t.stopPropagation()}}_show(t,e){if(!(t instanceof HTMLElement)||!(e instanceof HTMLElement))throw new TypeError("Invalid argument");t.hidden=!1;let{x:r,y:n}=e.getBoundingClientRect(),{x:u,y:c}=this.editor.root.getBoundingClientRect(),E=r-u+t.clientWidth-this.editor.root.clientWidth,b=n-c-e.scrollTop+this.editor.root.offsetTop-t.clientHeight,T=t.clientWidth<this.editor.root.clientWidth?r-u:0;T>0&&E>0&&(T=T>E?(T-E)/2:0),t.style.left=`${T}px`,t.style.top=`${b}px`}_hide(t){t.hidden=!0,t.removeAttribute("style")}};var le,Ai,he,wi,me=class extends H{constructor(e){super(e);d(this,le);d(this,he);this.editor.focusbar.addEventListener("insertbutton",this),this.editor.root.addEventListener("focusin",this),this.editor.root.addEventListener("focusout",this),this.editor.dom.document.addEventListener("selectionchange",this)}insertbutton({detail:{element:e}}){e.getAttribute("data-command")&&(e.addEventListener("click",this),e.addEventListener("mousedown",this))}mousedown(e){e.preventDefault(),e.stopPropagation()}focusin(e){e.target instanceof HTMLElement&&e.target.hasAttribute("data-focusable")&&f(this,le,Ai).call(this,e.target)}focusout(){f(this,he,wi).call(this)}selectionchange(){let e=this.editor.dom.getActiveElement();!this.editor.dom.getSelection().isCollapsed||!e?f(this,he,wi).call(this):e instanceof HTMLElement&&e.hasAttribute("data-focusable")&&f(this,le,Ai).call(this,e)}};le=new WeakSet,Ai=function(e){!this.editor.focusbar.children.length||(Object.keys(e.dataset).forEach(r=>this.editor.focusbar.dataset[r]=e.dataset[r]),this.editor.focusbar.dataset.tag=e.localName,this._show(this.editor.focusbar,e))},he=new WeakSet,wi=function(){this._hide(this.editor.focusbar),Object.keys(this.editor.focusbar.dataset).forEach(e=>delete this.editor.focusbar.dataset[e])};var ce=class extends H{constructor(t){super(t),this.editor.formatbar.addEventListener("insertbutton",this),this.editor.dom.document.addEventListener("selectionchange",this)}selectionchange(){let t=this.editor.dom.getSelectedEditable();t&&!this.editor.dom.getSelection().isCollapsed&&this.editor.tags.allowed(t,o.FORMAT,!0)?this._show(this.editor.formatbar,t):this._hide(this.editor.formatbar)}};var ai,qi,fe=class extends p{constructor(e){super(e);d(this,ai);this.editor.root.addEventListener("insert",this)}insert({detail:{element:e}}){e.hasAttribute("data-navigable")&&(e.tabIndex=0,e.addEventListener("keydown",this))}keydown(e){if(e.target===e.currentTarget&&a.isEventFor(e,[a.UP,a.DOWN,a.HOME,a.END])&&f(this,ai,qi).call(this,e.target)){let r=e.target.previousElementSibling,n=e.target.nextElementSibling,u=e.target.parentElement.firstElementChild,c=e.target.parentElement.lastElementChild,E=e.target===u,b=e.target===c;e.key===a.UP&&!E&&r.hasAttribute("data-navigable")?r.focus():e.key===a.DOWN&&!b&&n.hasAttribute("data-navigable")?n.focus():(e.key===a.HOME||e.key===a.DOWN&&b)&&u.hasAttribute("data-navigable")?u.focus():(e.key===a.END||e.key===a.UP&&E)&&c.hasAttribute("data-navigable")&&c.focus(),e.preventDefault(),e.stopPropagation()}}};ai=new WeakSet,qi=function(e){if(e.contentEditable!=="true")return!0;let r=this.editor.dom.getSelection(),n=this.editor.dom.getSelectedEditable(),u=this.editor.dom.getSelectedElement();return r.isCollapsed&&r.anchorOffset===0&&[n,e.firstChild].includes(u)};var ue=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insert",this)}insert({detail:{element:t}}){t instanceof HTMLSlotElement?t.addEventListener("keydown",this):t.hasAttribute("data-slotable")&&!t.querySelector(":scope > "+i.SLOT)&&this.editor.dom.insertLastChild(this.editor.dom.createElement(i.SLOT),t)}keydown(t){!a.isEventFor(t,a.TAB)&&!a.isEventFor(t,a.TAB,{shift:!0})&&(t.preventDefault(),t.stopPropagation())}};var ge,Ii,Ee,_i,pe=class extends p{constructor(e){super(e);d(this,ge);d(this,Ee);this.editor.root.addEventListener("insert",this)}insert({detail:{element:e}}){e.hasAttribute("data-sortable")&&(e.addEventListener("keydown",this),e.addEventListener("pointerdown",this),e.addEventListener("pointermove",this),e.addEventListener("pointerup",this))}keydown(e){let r={[a.HOME]:A.FIRST,[a.UP]:A.PREV,[a.DOWN]:A.NEXT,[a.END]:A.LAST};e.target===e.currentTarget&&a.isEventFor(e,Object.keys(r),{ctrl:!0})&&(this.editor.dom.sort(e.target,r[e.key]),e.preventDefault(),e.stopPropagation())}pointerdown(e){let r=e.target.closest("[data-sortable]");r&&this.editor.dom.contains(r)&&(r.setAttribute("data-sort",""),r.setPointerCapture(e.pointerId))}pointermove(e){let r=e.target.closest("[data-sortable][data-sort]"),n=this.editor.dom.document.elementFromPoint(e.x,e.y);f(this,ge,Ii).call(this),r&&this.editor.dom.contains(r)&&f(this,Ee,_i).call(this,r,n)&&n.setAttribute("data-sortover","")}pointerup(e){let r=e.target.closest("[data-sortable][data-sort]");if(r&&this.editor.dom.contains(r)){let n=this.editor.dom.document.elementFromPoint(e.x,e.y);f(this,ge,Ii).call(this),r.removeAttribute("data-sort"),r.releasePointerCapture(e.pointerId),f(this,Ee,_i).call(this,r,n)&&this.editor.dom.insertBefore(r,n)}}};ge=new WeakSet,Ii=function(){this.editor.root.querySelectorAll("[data-sortover]").forEach(e=>e.removeAttribute("data-sortover"))},Ee=new WeakSet,_i=function(e,r){return e instanceof HTMLElement&&r instanceof HTMLElement&&this.editor.dom.contains(r)&&![this.editor.root,e].includes(r)&&r.hasAttribute("data-sortable")&&(e.parentElement===r.parentElement||this.editor.dom.arbitrary(e.parentElement)&&this.editor.dom.arbitrary(r.parentElement))&&this.editor.tags.allowed(r.parentElement,e)};var be=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insert",this)}insert({detail:{element:t}}){let e=this.editor.tags.get(t);e&&(e.editable&&(t.contentEditable="true"),["alignable","arbitrary","deletable","focusable","navigable","slotable","sortable"].forEach(r=>{e[r]&&(t.dataset[r]="")}))}};var Te=class extends H{constructor(t){super(t),this.editor.toolbar.addEventListener("insertbutton",this)}insertbutton({detail:{element:t}}){t.getAttribute("data-command")&&t.addEventListener("click",this),t.tabIndex=t===this.editor.toolbar.firstElementChild?0:-1,t.addEventListener("keydown",this)}};var ji={de:{Alt:"Alt",Cancel:"Abbrechen",Shift:"Umschalt",Save:"Speichern"}};var l=class extends m{static get name(){return"base"}static get config(){return{browser:{},filter:{},lang:void 0,plugins:[],pluginsDisabled:!1}}init(){this._i18n(ji),this.editor.dom.registerElement(i.DIALOG,ae),this._tag({name:i.ROOT,group:o.ROOT,children:[o.AUDIO,o.BLOCK,o.CONTAINER,o.FIGURE,o.HEADING,o.IFRAME,o.IMAGE,o.LIST,o.PARAGRAPH,o.PREFORMAT,o.QUOTE,o.RULE,o.TABLE,o.VIDEO]}),this._tag({name:i.SLOT,group:o.SLOT,editable:!0,focusable:!0,navigable:!0,sortable:!0}),new be(this.editor),new Te(this.editor),new ce(this.editor),new me(this.editor),new ne(this.editor),new se(this.editor),new fe(this.editor),new pe(this.editor),new re(this.editor),new de(this.editor),new ue(this.editor),this.editor.filters.add(new ie(this.editor))}};var xe,Q,Y,ni,Vi,di,Wi,Ae,yi,Le=class{constructor(t,e){d(this,ni);d(this,di);d(this,Ae);d(this,xe,void 0);d(this,Q,void 0);d(this,Y,void 0);var r,n;if(!(t instanceof _)||!q(e))throw new TypeError("Invalid argument");g(this,xe,t),g(this,Q,this.editor.dom.createElement(i.FORM,{attributes:{method:"dialog"}})),f(n=f(r=this.addFieldset(),ni,Vi).call(r,e),di,Wi).call(n)}get editor(){return h(this,xe)}get form(){return h(this,Q)}addFieldset(){let t=this.editor.dom.createElement(i.FIELDSET);return h(this,Y)?this.editor.dom.insertAfter(t,h(this,Y)):this.editor.dom.insertFirstChild(t,h(this,Q)),g(this,Y,t),this}addLegend(t){if(!x(t))throw new TypeError("Invalid argument");return this.editor.dom.insertLastChild(this.editor.dom.createElement(i.LEGEND,{html:t}),h(this,Y)),this}addTextInput(t,e,r={}){return this.addInput(t,e,r,"text")}addNumberInput(t,e,r={}){return this.addInput(t,e,r,"number")}addInput(t,e,r={},n="text"){if(!x(t)||!x(e)||!x(n))throw new TypeError("Invalid argument");Object.assign(r,{id:`editor-${t}`,name:t,type:n});let u=this.editor.dom.createElement(i.DIV);return this.editor.dom.insertLastChild(this.editor.dom.createElement(i.LABEL,{attributes:{for:r.id},html:e}),u),this.editor.dom.insertLastChild(this.editor.dom.createElement(i.INPUT,{attributes:r}),u),r.required&&u.setAttribute("data-required",""),this.editor.dom.insertLastChild(u,h(this,Y)),this}};xe=new WeakMap,Q=new WeakMap,Y=new WeakMap,ni=new WeakSet,Vi=function(t){let e=f(this,Ae,yi).call(this,"Cancel"),r=this.editor.dom.createElement(i.BUTTON,{attributes:{type:"button"},html:e});return r.addEventListener("click",t),this.editor.dom.insertLastChild(r,h(this,Q)),this},di=new WeakSet,Wi=function(){let t=this.editor.dom.createElement(i.BUTTON,{html:f(this,Ae,yi).call(this,"Save")});return this.editor.dom.insertLastChild(t,h(this,Q)),this},Ae=new WeakSet,yi=function(t){return this.editor.translator.translate(l.name,t)};var we,Ie,_e,ye,mi,$i,li,Qi,Re,Ri,L=class{constructor(t,e,r=void 0){d(this,mi);d(this,li);d(this,Re);d(this,we,void 0);d(this,Ie,void 0);d(this,_e,void 0);d(this,ye,void 0);if(!(t instanceof _)||!x(e)||!j(r))throw new TypeError("Invalid argument");g(this,we,t),g(this,Ie,e),g(this,_e,r)}get editor(){return h(this,we)}get name(){return h(this,Ie)}get url(){return h(this,_e)}get formCreator(){return h(this,ye)}open(t,e={}){this.url?f(this,mi,$i).call(this,t,e):f(this,li,Qi).call(this,t,e)}_(t){return this.editor.translator.translate(this.name,t)}_prepareForm(){throw new Error("Not implemented")}};we=new WeakMap,Ie=new WeakMap,_e=new WeakMap,ye=new WeakMap,mi=new WeakSet,$i=function(t,e={}){this.editor.dom.open({url:this.url,name:this.name,call:t,params:e})},li=new WeakSet,Qi=function(t,e={}){let r=this.editor.dom.getRange(),n=()=>{r&&this.editor.dom.setRange(r),f(this,Re,Ri).call(this)};f(this,Re,Ri).call(this),g(this,ye,new Le(this.editor,n)),this._prepareForm();let u=this.formCreator.form;u.addEventListener("submit",E=>{E.preventDefault(),E.stopPropagation(),n();let b={};Array.from(u.elements).forEach(T=>b[T.name]=T.value),t(b)}),Object.entries(e).forEach(([E,b])=>u.elements[E]&&(u.elements[E].value=b));let c=this.editor.dom.createElement(i.DIALOG);c.addEventListener("close",n),this.editor.dom.insertLastChild(u,c),c.show(),this.editor.dom.insertLastChild(c,this.editor.element)},Re=new WeakSet,Ri=function(){Array.from(this.editor.element.getElementsByTagName(i.DIALOG)).forEach(t=>{t.parentElement.removeChild(t)})};var Oe=class extends L{constructor(t){super(t,rt.name)}_prepareForm(){this.formCreator.addLegend(this._("Abbreviation")).addTextInput("title",this._("Full term"),{placeholder:this._("Insert full term or leave empty to remove it")})}};var Yi={de:{Abbreviation:"Abk\xFCrzung","Full term":"Langform","Insert full term or leave empty to remove it":"Langform eingeben oder zum Entfernen leer lassen"}};var rt=class extends m{static get name(){return"abbreviation"}static get dependencies(){return[l]}init(){this._i18n(Yi),this._tag({name:i.ABBR,group:o.FORMAT,attributes:["title"]}),this.editor.dialogs.set(new Oe(this.editor)),this._command(i.ABBR),this._formatbar(this._("Abbreviation"),a.A)}};var xt,Ne=class extends C{constructor(e,r){if(!R.values().includes(r))throw new TypeError("Invalid argument");super(e,it.name+"-"+r);d(this,xt,void 0);g(this,xt,r)}execute(){let e=this.editor.dom.getActiveElement();e?.hasAttribute("data-alignable")&&(e.classList.remove(...R.values()),h(this,xt)!==R.NONE&&e.classList.add(h(this,xt)))}};xt=new WeakMap;var Zi={de:{"Align center":"zentriert","Align left":"linksb\xFCndig","Align right":"rechtsb\xFCndig","No alignment":"Keine Ausrichtung"}};var it=class extends m{static get name(){return"align"}static get dependencies(){return[l]}init(){this._i18n(Zi);let t={[R.NONE]:this._("No alignment"),[R.LEFT]:this._("Align left"),[R.CENTER]:this._("Align center"),[R.RIGHT]:this._("Align right")};Object.entries(t).forEach(([e,r])=>{let n=new Ne(this.editor,e);this.editor.commands.set(n),this._focusbar(r,n.name)})}};var Ce=class extends L{constructor(t,e=void 0){super(t,P.name,e)}_prepareForm(){this.formCreator.addLegend(this._("Audio")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to audio"),required:"required"}).addTextInput("id",this._("ID"))}};var Me,Oi,Se=class extends p{constructor(e){super(e);d(this,Me);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertaudio",this)}sethtml({detail:{element:e}}){Array.from(e.getElementsByTagName(i.AUDIO)).forEach(r=>f(this,Me,Oi).call(this,r))}insertaudio({detail:{element:e}}){f(this,Me,Oi).call(this,e)}};Me=new WeakSet,Oi=function(e){let r=e.getAttribute("src");r?(e.setAttribute("src",this.editor.url(r)),e.controls=!0,this.editor.dom.wrap(e,i.FIGURE,{attributes:{class:P.name}})):e.parentElement.removeChild(e)};var Be=class extends y{filter(t){t.querySelectorAll(`${i.FIGURE} > ${i.FIGCAPTION}:only-child`).forEach(e=>e.parentElement.removeChild(e))}};var De=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insertfigure",this)}insertfigure({detail:{element:t}}){t.querySelector(":scope > "+i.FIGCAPTION)||this.editor.dom.insertLastChild(this.editor.dom.createElement(i.FIGCAPTION),t)}};var O=class extends m{static get name(){return"figure"}static get dependencies(){return[l]}init(){this._tag({name:i.FIGURE,group:o.FIGURE,children:[o.AUDIO,o.CAPTION,o.IFRAME,o.IMAGE,o.PREFORMAT,o.QUOTE,o.TABLE,o.VIDEO],attributes:["class"],alignable:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._tag({name:i.FIGCAPTION,group:o.CAPTION,children:[o.FORMAT],editable:!0,navigable:!0,enter:i.P}),new De(this.editor),this.editor.filters.add(new Be(this.editor))}};var Xi={de:{Audio:"Audio",ID:"ID","Insert URL to audio":"URL zur Audiodatei eingeben",URL:"URL"}};var P=class extends m{static get name(){return"audio"}static get dependencies(){return[l,O]}static get config(){return{browser:void 0}}init(){this._i18n(Xi),this._tag({name:i.AUDIO,group:o.AUDIO,attributes:["controls","id","src"],empty:!0,navigable:!0}),new Se(this.editor),this.editor.dialogs.set(new Ce(this.editor,this.editor.config.audio.browser)),this._command(i.AUDIO),this._toolbar(this._("Audio"))}};var Fe=class extends L{constructor(t,e=void 0){super(t,ot.name,e)}_prepareForm(){this.formCreator.addLegend(this._("Block")).addTextInput("id",this._("ID"),{required:"required"})}};var ve=class extends HTMLElement{get content(){return this.shadowRoot.innerHTML}set content(t){this.shadowRoot.innerHTML=t}constructor(){super(),this.attachShadow({mode:"open"})}};var He=class extends p{constructor(t){super(t),this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertappblock",this)}sethtml({detail:{element:t}}){Array.from(t.getElementsByTagName(i.BLOCK)).forEach(e=>e.id||e.parentElement.removeChild(e))}async insertappblock({detail:{element:t}}){if(!t.id){t.parentElement.removeChild(t);return}if(!this.editor.config.block.api)return;let e=this.editor.config.block.api.replace("{id}",t.id),r=await fetch(e,{mode:"no-cors"});if(!r.ok)return;let n="";this.editor.config.block.css&&(n=this.editor.config.block.css.split(",").map(c=>`<link rel="stylesheet" href="${c}">`).join(""));let u=await r.text();t.content=n+u}};var hi={de:{Height:"H\xF6he",ID:"ID",Ifrane:"Iframe","Insert URL to embedded page":"URL zur eingebetteten Seite eingeben",URL:"URL",Width:"Breite"}};var ot=class extends m{static get name(){return"block"}static get dependencies(){return[l]}static get config(){return{api:void 0,browser:void 0,css:void 0}}init(){this._i18n(hi),this.editor.dom.registerElement(i.BLOCK,ve),this._tag({name:i.BLOCK,group:o.BLOCK,attributes:["id"],deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),new He(this.editor),this.editor.dialogs.set(new Fe(this.editor,this.editor.config.block.browser)),this._command(i.BLOCK),this._toolbar(this._("Block"))}};var Pe=class extends y{filter(t){t instanceof HTMLElement&&t.localName===i.FIGURE&&t.classList.contains(D.name)&&t.querySelector(":scope > "+i.BLOCKQUOTE)&&!t.querySelector(":scope > "+i.FIGCAPTION)&&(this.editor.dom.insertBefore(t.querySelector(":scope > "+i.BLOCKQUOTE),t),t.parentElement.removeChild(t))}};var ke=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insertblockquote",this),this.editor.root.addEventListener("deleteblockquote",this)}insertblockquote({detail:{element:t}}){this.editor.dom.wrap(t,i.FIGURE,{attributes:{class:D.name}})}deleteblockquote({detail:{target:t}}){t.localName===i.FIGURE&&t.classList.contains(D.name)&&t.parentElement.removeChild(t)}};var Ue=class extends y{filter(t){if(t instanceof HTMLPreElement){t.outerHTML=t.outerHTML.replace(/(<br\s*\/?>)/gi,`
`);return}t.innerHTML=t.innerHTML.replace(/^\s*(<br\s*\/?>\s*)+/gi,"").replace(/\s*(<br\s*\/?>\s*)+$/gi,""),t instanceof HTMLParagraphElement?t.outerHTML=t.outerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"</p><p>"):t.innerHTML=t.innerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"<br>")}};var B=class extends m{static get name(){return"break"}static get dependencies(){return[l]}init(){this._tag({name:i.BR,group:o.BREAK,empty:!0}),this.editor.filters.add(new Ue(this.editor))}};var Ji={de:{Blockquote:"Blockzitat"}};var D=class extends m{static get name(){return"blockquote"}static get dependencies(){return[l,B,O]}init(){this._i18n(Ji),this._tag({name:i.BLOCKQUOTE,group:o.QUOTE,children:[o.BREAK,o.FORMAT],deletable:!0,editable:!0,navigable:!0,enter:i.P}),new ke(this.editor),this._command(i.BLOCKQUOTE),this._toolbar(this._("Blockquote")),this.editor.filters.add(new Pe(this.editor))}};var to={de:{bold:"fett"}};var Ge=class extends m{static get name(){return"bold"}static get dependencies(){return[l]}init(){this._i18n(to),this._tag({name:i.B,group:o.FORMAT}),this._command(i.B),this._formatbar(this._("bold"),a.B)}};var eo={de:{Citation:"Zitatquelle"}};var Ke=class extends m{static get name(){return"cite"}static get dependencies(){return[l]}init(){this._i18n(eo),this._tag({name:i.CITE,group:o.FORMAT}),this._command(i.CITE),this._formatbar(this._("Citation"),a.Z)}};var ro={de:{Code:"Quelltext"}};var ze=class extends m{static get name(){return"code"}static get dependencies(){return[l]}init(){this._i18n(ro),this._tag({name:i.CODE,group:o.FORMAT}),this._command(i.CODE),this._formatbar(this._("Code"),a.C)}};var qe=class extends L{constructor(t){super(t,st.name)}_prepareForm(){this.formCreator.addLegend(this._("Data")).addTextInput("value",this._("Machine-readable Value"),{placeholder:this._("Insert value or leave empty to remove it")})}};var io={de:{Data:"Data","Machine-readable Value":"Maschinenlesbarer Wert","Insert value or leave empty to remove it":"Wert eingeben oder zum Entfernen leer lassen"}};var st=class extends m{static get name(){return"data"}static get dependencies(){return[l]}init(){this._i18n(io),this._tag({name:i.DATA,group:o.FORMAT,attributes:["value"]}),this.editor.dialogs.set(new qe(this.editor)),this._command(i.DATA),this._formatbar(this._("Data"),a.J)}};var je=class extends L{constructor(t){super(t,at.name)}_prepareForm(){this.formCreator.addLegend(this._("Definition")).addTextInput("title",this._("Term"),{placeholder:this._("Insert term or leave empty to remove it")})}};var oo={de:{Definition:"Definition","Insert term or leave empty to remove it":"Begriff eingeben oder zum Entfernen leer lassen",Term:"Begriff"}};var at=class extends m{static get name(){return"definition"}static get dependencies(){return[l]}init(){this._i18n(oo),this._tag({name:i.DFN,group:o.FORMAT,attributes:["title"]}),this.editor.dialogs.set(new je(this.editor)),this._command(i.DFN),this._formatbar(this._("Definition"),a.D)}};var Ve=class extends C{constructor(t){super(t,nt.name)}execute(){let t=this.editor.dom.getActiveElement();t?.hasAttribute("data-deletable")&&this.editor.dom.delete(t)}};var so={de:{Delete:"L\xF6schen"}};var nt=class extends m{static get name(){return"delete"}static get dependencies(){return[l]}init(){this._i18n(so),this.editor.commands.set(new Ve(this.editor)),this._focusbar(this._("Delete"),this.constructor.name)}};var ao={de:{"Text Deletion":"Textl\xF6schung"}};var We=class extends m{static get name(){return"deletion"}static get dependencies(){return[l]}init(){this._i18n(ao),this._tag({name:i.DEL,group:o.FORMAT}),this._command(i.DEL),this._formatbar(this._("Text Deletion"),a.G)}};var $e=class extends y{filter(t){t.querySelectorAll(`${i.SUMMARY}:not(:first-child)`).forEach(e=>e.parentElement.removeChild(e)),t.querySelectorAll(`${i.SUMMARY}:only-child`).forEach(e=>e.parentElement.removeChild(e))}};var Ye,Ni,Qe=class extends p{constructor(e){super(e);d(this,Ye);this.editor.root.addEventListener("insertdetails",this),this.editor.root.addEventListener("insertsummary",this)}insertdetails({detail:{element:e}}){e.open=!0,e.querySelector(`:scope > ${i.SUMMARY}:first-child`)||this.editor.dom.insertFirstChild(this.editor.dom.createElement(i.SUMMARY),e)}insertsummary({detail:{element:e}}){f(this,Ye,Ni).call(this,e),e.addEventListener("click",this),e.addEventListener("blur",this),e.addEventListener("keydown",this)}click(e){e.preventDefault(),e.stopPropagation(),e.target.parentElement.open=!0}blur(e){f(this,Ye,Ni).call(this,e.target)}keydown(e){a.isEventFor(e,a.SPACE)?(e.preventDefault(),e.stopPropagation(),this.editor.dom.insertText(" ")):a.isEventFor(e,a.ENTER)&&(e.preventDefault(),e.stopPropagation(),e.target.parentElement.open=!0)}};Ye=new WeakSet,Ni=function(e){e.textContent.trim()?e.querySelectorAll(i.BR+":not(:last-child)").forEach(r=>r.parentElement.removeChild(r)):e.textContent=this.editor.translator.translate(dt.name,"Details"),e.lastElementChild instanceof HTMLBRElement||this.editor.dom.insertLastChild(this.editor.dom.createElement(i.BR),e)};var no={de:{Details:"Details"}};var dt=class extends m{static get name(){return"details"}static get dependencies(){return[l]}init(){this._i18n(no),this._tag({name:i.DETAILS,group:o.CONTAINER,children:[o.AUDIO,o.FIGURE,o.IFRAME,o.IMAGE,o.LIST,o.PARAGRAPH,o.PREFORMAT,o.QUOTE,o.RULE,o.SUMMARY,o.TABLE,o.VIDEO],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._tag({name:i.SUMMARY,group:o.SUMMARY,editable:!0,navigable:!0,enter:i.P}),new Qe(this.editor),this._command(i.DETAILS),this._toolbar(this._("Details")),this.editor.filters.add(new $e(this.editor))}};var Ze=class extends L{constructor(t){super(t,mt.name)}_prepareForm(){this.formCreator.addLegend(this._("Division")).addTextInput("class",this._("CSS class"),{placeholder:this._("Insert CSS class")})}};var mo={de:{"CSS class":"CSS-Klasse",Division:"Division","Insert CSS class":"CSS-Klasse eingeben"}};var mt=class extends m{static get name(){return"division"}static get dependencies(){return[l]}init(){this._i18n(mo),this._tag({name:i.DIV,group:o.CONTAINER,children:[o.AUDIO,o.BLOCK,o.FIGURE,o.IFRAME,o.IMAGE,o.PREFORMAT,o.QUOTE,o.RULE,o.TABLE,o.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new Ze(this.editor)),this._command(i.DIV),this._toolbar(this._("Division"))}};var lo={de:{emphasized:"betont"}};var Xe=class extends m{static get name(){return"emphasis"}static get dependencies(){return[l]}init(){this._i18n(lo),this._tag({name:i.EM,group:o.FORMAT}),this._command(i.EM),this._formatbar(this._("emphasized"),a.E)}};var ho={de:{Heading:"\xDCberschrift"}};var Je=class extends m{static get name(){return"heading"}static get dependencies(){return[l]}init(){this._i18n(ho),this._tag({name:i.H2,group:o.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:i.P}),this._command(i.H2),this._toolbar(this._("Heading"))}};var co={de:{"Horizontal Rule":"Horizontale Linie"}};var tr=class extends m{static get name(){return"horizontalrule"}static get dependencies(){return[l]}init(){this._i18n(co),this._tag({name:i.HR,group:o.RULE,deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(i.HR),this._toolbar(this._("Horizontal Rule"))}};var er=class extends L{constructor(t,e=void 0){super(t,k.name,e)}_prepareForm(){this.formCreator.addLegend(this._("Iframe")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to embedded page"),required:"required"}).addNumberInput("width",this._("Width")).addNumberInput("height",this._("Height")).addTextInput("id",this._("ID"))}};var ir,Ci,rr=class extends p{constructor(e){super(e);d(this,ir);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertiframe",this)}sethtml({detail:{element:e}}){Array.from(e.getElementsByTagName(i.IFRAME)).forEach(r=>f(this,ir,Ci).call(this,r))}insertiframe({detail:{element:e}}){f(this,ir,Ci).call(this,e)}};ir=new WeakSet,Ci=function(e){let r=e.getAttribute("src");r?(e.setAttribute("src",this.editor.url(r)),e.allowFullscreen=!0,this.editor.dom.wrap(e,i.FIGURE,{attributes:{class:k.name}})):e.parentElement.removeChild(e)};var k=class extends m{static get name(){return"iframe"}static get dependencies(){return[l,O]}static get config(){return{browser:void 0}}init(){this._i18n(hi),this._tag({name:i.IFRAME,group:o.IFRAME,attributes:["allowfullscreen","height","id","src","width"],empty:!0,navigable:!0}),new rr(this.editor),this.editor.dialogs.set(new er(this.editor,this.editor.config.iframe.browser)),this._command(i.IFRAME),this._toolbar(this._("Iframe"))}};var or=class extends L{constructor(t,e=void 0){super(t,U.name,e)}_prepareForm(){this.formCreator.addLegend(this._("Image")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to image"),required:"required"}).addTextInput("alt",this._("Alternative text"),{placeholder:this._("Text shown when media element is not available")}).addNumberInput("width",this._("Width")).addNumberInput("height",this._("Height")).addTextInput("id",this._("ID"))}};var ar,Si,sr=class extends p{constructor(e){super(e);d(this,ar);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertimg",this)}sethtml({detail:{element:e}}){Array.from(e.getElementsByTagName(i.IMG)).forEach(r=>f(this,ar,Si).call(this,r))}insertimg({detail:{element:e}}){f(this,ar,Si).call(this,e)}};ar=new WeakSet,Si=function(e){let r=e.getAttribute("src");r?(e.setAttribute("src",this.editor.url(r)),this.editor.dom.wrap(e,i.FIGURE,{attributes:{class:U.name}})):e.parentElement.removeChild(e)};var fo={de:{"Alternative text":"Alternativtext",Height:"H\xF6he",ID:"ID",Image:"Bild","Insert URL to image":"URL zur Bilddatei eingeben","Text shown when media element is not available":"Ersatztext, falls Medienelement nicht verf\xFCgbar ist",URL:"URL",Width:"Breite"}};var U=class extends m{static get name(){return"image"}static get dependencies(){return[l,O]}static get config(){return{browser:void 0}}init(){this._i18n(fo),this._tag({name:i.IMG,group:o.IMAGE,attributes:["alt","height","id","src","width"],empty:!0,navigable:!0}),new sr(this.editor),this.editor.dialogs.set(new or(this.editor,this.editor.config.image.browser)),this._command(i.IMG),this._toolbar(this._("Image"))}};var uo={de:{"Text Insertion":"Texteinf\xFCgung"}};var nr=class extends m{static get name(){return"insertion"}static get dependencies(){return[l]}init(){this._i18n(uo),this._tag({name:i.INS,group:o.FORMAT}),this._command(i.INS),this._formatbar(this._("Text Insertion"),a.F)}};var po={de:{italic:"kursiv"}};var dr=class extends m{static get name(){return"italic"}static get dependencies(){return[l]}init(){this._i18n(po),this._tag({name:i.I,group:o.FORMAT}),this._command(i.I),this._formatbar(this._("italic"),a.I)}};var go={de:{"User Input":"Benutzereingabe"}};var mr=class extends m{static get name(){return"keyboard"}static get dependencies(){return[l]}init(){this._i18n(go),this._tag({name:i.KBD,group:o.FORMAT}),this._command(i.KBD),this._formatbar(this._("User Input"),a.K)}};var lr=class extends L{constructor(t){super(t,lt.name)}_prepareForm(){this.formCreator.addLegend(this._("Link")).addTextInput("href",this._("URL"),{pattern:"(https?|/|mailto:|tel:).+",placeholder:this._("Insert link or leave empty to unlink")})}};var cr,Mi,hr=class extends p{constructor(e){super(e);d(this,cr);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("inserta",this)}sethtml({detail:{element:e}}){Array.from(e.getElementsByTagName(i.A)).forEach(r=>f(this,cr,Mi).call(this,r))}inserta({detail:{element:e}}){f(this,cr,Mi).call(this,e)}};cr=new WeakSet,Mi=function(e){let r=e.getAttribute("href");r?e.setAttribute("href",this.editor.url(r)):e.parentElement.replaceChild(this.editor.dom.createText(e.textContent),e)};var Eo={de:{"Insert link or leave empty to unlink":"Link eingeben oder zum Entfernen leer lassen",Link:"Link",URL:"URL"}};var lt=class extends m{static get name(){return"link"}static get dependencies(){return[l]}init(){this._i18n(Eo),this._tag({name:i.A,group:o.FORMAT,attributes:["href"]}),new hr(this.editor),this.editor.dialogs.set(new lr(this.editor)),this._command(i.A),this._formatbar(this._("Link"),a.L)}};var bo={de:{mark:"markiert"}};var fr=class extends m{static get name(){return"mark"}static get dependencies(){return[l]}init(){this._i18n(bo),this._tag({name:i.MARK,group:o.FORMAT}),this._command(i.MARK),this._formatbar(this._("mark"),a.M)}};var pr,Bi,gr,Di,ur=class extends p{constructor(e){super(e);d(this,pr);d(this,gr);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertli",this),this.editor.root.addEventListener("deleteli",this),this.editor.root.addEventListener("insertol",this),this.editor.root.addEventListener("insertul",this)}sethtml({detail:{element:e}}){Array.from(e.getElementsByTagName(i.LI)).forEach(r=>f(this,pr,Bi).call(this,r))}insertli({detail:{element:e}}){f(this,pr,Bi).call(this,e)}deleteli({detail:{target:e}}){e.children.length===0&&e.parentElement.removeChild(e)}insertol({detail:{element:e}}){f(this,gr,Di).call(this,e)}insertul({detail:{element:e}}){f(this,gr,Di).call(this,e)}};pr=new WeakSet,Bi=function(e){!(e.parentElement instanceof HTMLOListElement)&&!(e.parentElement instanceof HTMLUListElement)&&this.editor.dom.wrap(e,i.UL)},gr=new WeakSet,Di=function(e){e.children.length===0&&this.editor.dom.insertLastChild(this.editor.dom.createElement(i.LI),e)};var ht=class extends m{static get name(){return"list"}static get dependencies(){return[l,B]}init(){this._tag({name:i.LI,group:o.LISTITEM,children:[o.BREAK,o.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:i.LI}),new ur(this.editor)}};var To={de:{"Ordered List":"Geordnete Liste"}};var Er=class extends m{static get name(){return"orderedlist"}static get dependencies(){return[l,ht]}init(){this._i18n(To),this._tag({name:i.OL,group:o.LIST,children:[o.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(i.OL),this._toolbar(this._("Ordered List"))}};var Tr,Fi,br=class extends p{constructor(e){super(e);d(this,Tr);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertp",this)}sethtml({detail:{element:e}}){Array.from(e.getElementsByTagName(i.P)).forEach(r=>f(this,Tr,Fi).call(this,r))}insertp({detail:{element:e}}){f(this,Tr,Fi).call(this,e)}paste(e){this.editor.dom.window.setTimeout(()=>this.editor.filters.filter(e.target))}};Tr=new WeakSet,Fi=function(e){e.addEventListener("paste",this)};var Lo={de:{Paragraph:"Absatz"}};var Lr=class extends m{static get name(){return"paragraph"}static get dependencies(){return[l,B]}init(){this._i18n(Lo),this._tag({name:i.P,group:o.PARAGRAPH,children:[o.BREAK,o.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:i.P}),new br(this.editor),this._command(i.P),this._toolbar(this._("Paragraph"))}};var xr=class extends y{filter(t){t instanceof HTMLElement&&t.localName===i.FIGURE&&t.classList.contains(F.name)&&t.querySelector(":scope > "+i.PRE)&&!t.querySelector(":scope > "+i.FIGCAPTION)&&(this.editor.dom.insertBefore(t.querySelector(":scope > "+i.PRE),t),t.parentElement.removeChild(t))}};var Ar=class extends p{constructor(t){super(t),this.editor.root.addEventListener("insertpre",this),this.editor.root.addEventListener("deletepre",this)}insertpre({detail:{element:t}}){this.editor.dom.wrap(t,i.FIGURE,{attributes:{class:F.name}})}deletepre({detail:{target:t}}){t.localName===i.FIGURE&&t.classList.contains(F.name)&&t.parentElement.removeChild(t)}};var xo={de:{"Preformatted Text":"Vorformatierter Text"}};var F=class extends m{static get name(){return"preformat"}static get dependencies(){return[l,B,O]}init(){this._i18n(xo),this._tag({name:i.PRE,group:o.PREFORMAT,children:[o.BREAK],deletable:!0,editable:!0,navigable:!0,enter:i.P}),new Ar(this.editor),this._command(i.PRE),this._toolbar(this._("Preformatted Text")),this.editor.filters.add(new xr(this.editor))}};var Ao={de:{Quote:"Zitat"}};var wr=class extends m{static get name(){return"quote"}static get dependencies(){return[l]}init(){this._i18n(Ao),this._tag({name:i.Q,group:o.FORMAT}),this._command(i.Q),this._formatbar(this._("Quote"),a.Q)}};var wo={de:{"Sample Output":"Beispielausgabe"}};var Ir=class extends m{static get name(){return"sample"}static get dependencies(){return[l]}init(){this._i18n(wo),this._tag({name:i.SAMP,group:o.FORMAT}),this._command(i.SAMP),this._formatbar(this._("Sample Output"),a.O)}};var _r=class extends L{constructor(t){super(t,ct.name)}_prepareForm(){this.formCreator.addLegend(this._("Section")).addTextInput("class",this._("CSS class"),{placeholder:this._("Insert CSS class")})}};var Io={de:{"CSS class":"CSS-Klasse","Insert CSS class":"CSS-Klasse eingeben",Section:"Sektion"}};var ct=class extends m{static get name(){return"section"}static get dependencies(){return[l]}init(){this._i18n(Io),this._tag({name:i.SECTION,group:o.CONTAINER,children:[o.AUDIO,o.FIGURE,o.HEADING,o.IFRAME,o.IMAGE,o.LIST,o.PARAGRAPH,o.PREFORMAT,o.QUOTE,o.RULE,o.TABLE,o.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new _r(this.editor)),this._command(i.SECTION),this._toolbar(this._("Section"))}};var _o={de:{small:"klein"}};var yr=class extends m{static get name(){return"small"}static get dependencies(){return[l]}init(){this._i18n(_o),this._tag({name:i.SMALL,group:o.FORMAT}),this._command(i.SMALL),this._formatbar(this._("small"),a.W)}};var Or,Rr=class extends C{constructor(e,r){if(!A.values().includes(r))throw new TypeError("Invalid argument");super(e,ft.name+"-"+r);d(this,Or,void 0);g(this,Or,r)}execute(){let e=this.editor.dom.getActiveElement();e?.hasAttribute("data-sortable")&&this.editor.dom.sort(e,h(this,Or))}};Or=new WeakMap;var yo={de:{"Sort after next element":"Hinter das n\xE4chste Element sortieren","Sort before previous element":"Vor das vorherige Element sortieren","Sort to the beginning":"An den Anfang sortieren","Sort to the end":"Ans Ende sortieren"}};var ft=class extends m{static get name(){return"sort"}static get dependencies(){return[l]}init(){this._i18n(yo);let t={[A.FIRST]:this._("Sort to the beginning"),[A.PREV]:this._("Sort before previous element"),[A.NEXT]:this._("Sort after next element"),[A.LAST]:this._("Sort to the end")};Object.entries(t).forEach(([e,r])=>{let n=new Rr(this.editor,e);this.editor.commands.set(n),this._focusbar(r,n.name)})}};var Ro={de:{strikethrough:"durchgestrichen"}};var Nr=class extends m{static get name(){return"strikethrough"}static get dependencies(){return[l]}init(){this._i18n(Ro),this._tag({name:i.S,group:o.FORMAT}),this._command(i.S),this._formatbar(this._("strikethrough"),a.R)}};var Oo={de:{"strongly emphasized":"stark betont"}};var Cr=class extends m{static get name(){return"strong"}static get dependencies(){return[l]}init(){this._i18n(Oo),this._tag({name:i.STRONG,group:o.FORMAT}),this._command(i.STRONG),this._formatbar(this._("strongly emphasized"),a.S)}};var No={de:{Subheading:"Unter\xFCberschrift"}};var Sr=class extends m{static get name(){return"subheading"}static get dependencies(){return[l]}init(){this._i18n(No),this._tag({name:i.H3,group:o.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:i.P}),this._command(i.H3),this._toolbar(this._("Subheading"))}};var Co={de:{subscript:"tiefgestellt"}};var Mr=class extends m{static get name(){return"subscript"}static get dependencies(){return[l]}init(){this._i18n(Co),this._tag({name:i.SUB,group:o.FORMAT}),this._command(i.SUB),this._formatbar(this._("subscript"),a.X)}};var So={de:{superscript:"hochgestellt"}};var Br=class extends m{static get name(){return"superscript"}static get dependencies(){return[l]}init(){this._i18n(So),this._tag({name:i.SUP,group:o.FORMAT}),this._command(i.SUP),this._formatbar(this._("superscript"),a.Y)}};var ci,Mo,Dr=class extends p{constructor(e){super(e);d(this,ci);this.editor.root.addEventListener("inserttd",this),this.editor.root.addEventListener("insertth",this)}inserttd({detail:{element:e}}){e.addEventListener("keydown",this)}insertth({detail:{element:e}}){e.addEventListener("keydown",this)}keydown(e){let r=e.target,n=r.parentElement,u=n.parentElement,c=u instanceof HTMLTableElement?u:u.parentElement,E=[a.LEFT,a.RIGHT,a.UP,a.DOWN],b=a.isEventFor(e,E),T=a.isEventFor(e,E,{ctrl:!0}),S=a.isEventFor(e,E,{alt:!0}),K=a.isEventFor(e,E,{alt:!0,shift:!0});if(r instanceof HTMLTableCellElement&&n instanceof HTMLTableRowElement&&(u instanceof HTMLTableElement||u instanceof HTMLTableSectionElement)&&c instanceof HTMLTableElement&&(b&&f(this,ci,Mo).call(this,r,e.key)||T||S||K)){let w=r.cellIndex,v=n.cells.length,pt=u.rows.length,z=u instanceof HTMLTableElement?n.rowIndex:n.sectionRowIndex,ui=w===0,pi=w===v-1,ko=z===0,Uo=z===pt-1,ki=n.rowIndex===0,Ui=n.rowIndex===c.rows.length-1;e.preventDefault(),e.stopPropagation(),b?e.key===a.LEFT&&!ui?this.editor.dom.focusEnd(n.cells[w-1]):e.key===a.LEFT&&ki?this.editor.dom.focusEnd(c.rows[c.rows.length-1].cells[v-1]):e.key===a.LEFT?this.editor.dom.focusEnd(c.rows[n.rowIndex-1].cells[v-1]):e.key===a.RIGHT&&!pi?n.cells[w+1].focus():e.key===a.RIGHT&&Ui?c.rows[0].cells[0].focus():e.key===a.RIGHT?c.rows[n.rowIndex+1].cells[0].focus():e.key===a.UP&&ki?c.rows[c.rows.length-1].cells[w].focus():e.key===a.UP?c.rows[n.rowIndex-1].cells[w].focus():e.key===a.DOWN&&Ui?c.rows[0].cells[w].focus():e.key===a.DOWN&&c.rows[n.rowIndex+1].cells[w].focus():T?(e.key===a.LEFT&&v>1&&ui?Array.from(c.rows).forEach(I=>this.editor.dom.insertLastChild(I.cells[w],I)):e.key===a.LEFT&&v>1?Array.from(c.rows).forEach(I=>this.editor.dom.insertBefore(I.cells[w],I.cells[w-1])):e.key===a.RIGHT&&v>1&&pi?Array.from(c.rows).forEach(I=>this.editor.dom.insertFirstChild(I.cells[w],I)):e.key===a.RIGHT&&v>1?Array.from(c.rows).forEach(I=>this.editor.dom.insertAfter(I.cells[w],I.cells[w+1])):e.key===a.UP&&pt>1&&ko?this.editor.dom.insertLastChild(n,u):e.key===a.UP&&pt>1?this.editor.dom.insertBefore(n,u.rows[z-1]):e.key===a.DOWN&&pt>1&&Uo?this.editor.dom.insertFirstChild(n,u):e.key===a.DOWN&&pt>1&&this.editor.dom.insertAfter(n,u.rows[z+1]),r.focus()):S?e.key===a.LEFT?Array.from(c.rows).forEach(I=>{let wt=I.cells[w];this.editor.dom.insertBefore(this.editor.dom.createElement(wt.localName),wt)}):e.key===a.RIGHT?Array.from(c.rows).forEach(I=>{let wt=I.cells[w];this.editor.dom.insertAfter(this.editor.dom.createElement(wt.localName),wt)}):e.key===a.UP?this.editor.dom.insertBefore(this.editor.dom.createTableRow(v),n):e.key===a.DOWN&&this.editor.dom.insertAfter(this.editor.dom.createTableRow(v),n):K&&(e.key===a.LEFT&&!ui?Array.from(c.rows).forEach(I=>I.deleteCell(w-1)):e.key===a.RIGHT&&!pi?Array.from(c.rows).forEach(I=>I.deleteCell(w+1)):e.key===a.UP&&z>0?u.deleteRow(z-1):e.key===a.DOWN&&z<pt-1&&u.deleteRow(z+1))}}};ci=new WeakSet,Mo=function(e,r){if([a.UP,a.DOWN].includes(r))return!0;let n=this.editor.dom.getSelection(),u=n.anchorNode instanceof HTMLElement?n.anchorNode:e;if(!n.isCollapsed)return!1;if(r===a.LEFT){let E=e.firstChild;return E instanceof HTMLElement&&(E=E.firstChild),n.anchorOffset===0&&[e,E].includes(u)}let c=e.lastChild;return e.lastChild instanceof HTMLBRElement&&e.lastChild.previousSibling&&(c=e.lastChild.previousSibling),c instanceof HTMLElement&&(c=c.lastChild),n.anchorOffset===u.textContent.length&&[e,c].includes(u)};var Fr=class extends C{constructor(t){super(t,M.name,i.TABLE)}insert({rows:t,cols:e}={}){let r=this.editor.dom.createElement(i.FIGURE,{attributes:{class:M.name}}),n=this.editor.dom.createTable(parseInt(t,10)||1,parseInt(e,10)||1);this.editor.dom.insertLastChild(n,r),this.editor.dom.insert(r)}};var vr=class extends L{constructor(t){super(t,M.name)}_prepareForm(){this.formCreator.addLegend(this._("Table")).addNumberInput("rows",this._("Rows"),{min:"1",required:"required",value:"1"}).addNumberInput("cols",this._("Columns"),{min:"1",required:"required",value:"1"})}};var Hr=class extends y{filter(t){t instanceof HTMLElement&&t.localName===i.FIGURE&&t.classList.contains(M.name)&&t.querySelector(":scope > "+i.TABLE)&&!t.querySelector(":scope > "+i.FIGCAPTION)?(this.editor.dom.insertBefore(t.querySelector(":scope > "+i.TABLE),t),t.parentElement.removeChild(t)):(t instanceof HTMLTableElement&&t.querySelector(`:scope > ${i.THEAD}, :scope > ${i.TFOOT}`)&&!t.querySelector(":scope > "+i.TBODY)||t instanceof HTMLTableSectionElement&&t.rows.length<=0||t instanceof HTMLTableRowElement&&!t.querySelector(`:scope > ${i.TH}:not(:empty), :scope > ${i.TD}:not(:empty)`))&&t.parentElement.removeChild(t)}};var Pr=class extends p{constructor(t){super(t),this.editor.root.addEventListener("inserttable",this)}inserttable({detail:{element:t}}){if(this.editor.dom.wrap(t,i.FIGURE,{attributes:{class:M.name}}),t.tBodies.length>0&&t.tBodies[0].rows[0]){let e=t.tBodies[0],r=e.rows[0].cells.length;t.tHead||this.editor.dom.insertBefore(this.editor.dom.createTableHeader(1,r),e),t.tFoot||this.editor.dom.insertLastChild(this.editor.dom.createTableFooter(1,r),t)}}};var Bo={de:{Columns:"Spalten","Delete next column":"N\xE4chste Spalte l\xF6schen","Delete next row":"N\xE4chste Zeile l\xF6schen","Delete previous column":"Vorherige Spalte l\xF6schen","Delete previous row":"Vorherige Zeile l\xF6schen",Rows:"Zeilen","Sort after next column":"Hinter die n\xE4chste Spalte sortieren","Sort after next row":"Hinter die n\xE4chste Zeile sortieren","Sort before previous column":"Vor die vorherige Spalte sortieren","Sort before previous row":"Vor die vorherige Zeile sortieren","Sort column to the beginning":"Spalte an den Anfang sortieren","Sort row to the beginning":"Zeile an den Anfang sortieren","Sort column to the end":"Spalte ans Ende sortieren","Sort row to the end":"Zeile ans Ende sortieren",Table:"Tabelle"}};var At,fi,kr,vi,M=class extends m{constructor(){super(...arguments);d(this,At);d(this,kr)}static get name(){return"table"}static get dependencies(){return[l,B,O]}init(){this._i18n(Bo),this._tag({name:i.TABLE,group:o.TABLE,children:[o.TABLESECTION],deletable:!0,navigable:!0}),this._tag(f(this,At,fi).call(this,i.THEAD)),this._tag(f(this,At,fi).call(this,i.TBODY)),this._tag(f(this,At,fi).call(this,i.TFOOT)),this._tag({name:i.TR,group:o.TABLEROW,children:[o.TABLECELL]}),this._tag(f(this,kr,vi).call(this,i.TH)),this._tag(f(this,kr,vi).call(this,i.TD)),new Pr(this.editor),new Dr(this.editor),this.editor.filters.add(new Hr(this.editor)),this.editor.dialogs.set(new vr(this.editor)),this.editor.commands.set(new Fr(this.editor)),this._toolbar(this._("Table"))}};At=new WeakSet,fi=function(e){return{name:e,group:o.TABLESECTION,children:[o.TABLEROW]}},kr=new WeakSet,vi=function(e){return{name:e,group:o.TABLECELL,children:[o.BREAK,o.FORMAT],editable:!0,empty:!0}};var Ur=class extends L{constructor(t){super(t,ut.name)}_prepareForm(){this.formCreator.addLegend(this._("Data")).addTextInput("datetime",this._("Machine-readable Datetime"),{placeholder:this._("Insert date/time or leave empty to remove it")})}};var Do={de:{"Insert date/time or leave empty to remove it":"Datum/Zeit eingeben oder zum Entfernen leer lassen","Machine-readable Datetime":"Maschinenlesbare Datums-/Zeitangabe",Time:"Zeit"}};var ut=class extends m{static get name(){return"time"}static get dependencies(){return[l]}init(){this._i18n(Do),this._tag({name:i.TIME,group:o.FORMAT,attributes:["datetime"]}),this.editor.dialogs.set(new Ur(this.editor)),this._command(i.TIME),this._formatbar(this._("Time"),a.T)}};var Fo={de:{underline:"unterstrichen"}};var Gr=class extends m{static get name(){return"underline"}static get dependencies(){return[l]}init(){this._i18n(Fo),this._tag({name:i.U,group:o.FORMAT}),this._command(i.U),this._formatbar(this._("underline"),a.U)}};var vo={de:{"Unordered List":"Ungeordnete Liste"}};var Kr=class extends m{static get name(){return"unorderedlist"}static get dependencies(){return[l,ht]}init(){this._i18n(vo),this._tag({name:i.UL,group:o.LIST,children:[o.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(i.UL),this._toolbar(this._("Unordered List"))}};var Ho={de:{Variable:"Variable"}};var zr=class extends m{static get name(){return"variable"}static get dependencies(){return[l]}init(){this._i18n(Ho),this._tag({name:i.VAR,group:o.FORMAT}),this._command(i.VAR),this._formatbar(this._("Variable"),a.V)}};var qr=class extends L{constructor(t,e=void 0){super(t,G.name,e)}_prepareForm(){this.formCreator.addLegend(this._("Video")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to video"),required:"required"}).addNumberInput("width",this._("Width")).addNumberInput("height",this._("Height")).addTextInput("id",this._("ID"))}};var Vr,Hi,jr=class extends p{constructor(e){super(e);d(this,Vr);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertvideo",this)}sethtml({detail:{element:e}}){Array.from(e.getElementsByTagName(i.VIDEO)).forEach(r=>f(this,Vr,Hi).call(this,r))}insertvideo({detail:{element:e}}){f(this,Vr,Hi).call(this,e)}};Vr=new WeakSet,Hi=function(e){let r=e.getAttribute("src");r?(e.setAttribute("src",this.editor.url(r)),e.controls=!0,this.editor.dom.wrap(e,i.FIGURE,{attributes:{class:G.name}})):e.parentElement.removeChild(e)};var Po={de:{Height:"H\xF6he",ID:"ID","Insert URL to video":"URL zur Videodatei eingeben",URL:"URL",Video:"Video",Width:"Breite"}};var G=class extends m{static get name(){return"video"}static get dependencies(){return[l,O]}static get config(){return{browser:void 0}}init(){this._i18n(Po),this._tag({name:i.VIDEO,group:o.VIDEO,attributes:["controls","height","id","src","width"],empty:!0,navigable:!0}),new jr(this.editor),this.editor.dialogs.set(new qr(this.editor,this.editor.config.video.browser)),this._command(i.VIDEO),this._toolbar(this._("Video"))}};var Pi=class extends _{static get defaultConfig(){return{base:{plugins:[Ge,dr,Cr,Xe,Gr,Nr,lt,fr,yr,at,rt,wr,Ke,ze,mr,Ir,zr,Mr,Br,ut,st,nr,We,Lr,Je,Sr,Kr,Er,tr,D,U,G,P,k,M,F,ct,dt,mt,ot,it,ft,nt]}}}};export{Pi as default};
