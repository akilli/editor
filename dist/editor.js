var Vo=Object.defineProperty;var zo=(o,e,t)=>e in o?Vo(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var D=(o,e,t)=>(zo(o,typeof e!="symbol"?e+"":e,t),t),pt=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var c=(o,e,t)=>(pt(o,e,"read from private field"),t?t.call(o):e.get(o)),d=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},E=(o,e,t,s)=>(pt(o,e,"write to private field"),s?s.call(o,t):e.set(o,t),t);var p=(o,e,t)=>(pt(o,e,"access private method"),t);var f=Object.freeze({INVALID_ARGUMENT:"Invalid argument",MISSING_NAME:"Missing name",NOT_IMPLEMENTED:"Not implemented"}),a=Object.freeze({A:"a",B:"b",BACKSPACE:"Backspace",C:"c",D:"d",DEL:"Delete",DOWN:"ArrowDown",E:"e",END:"End",ENTER:"Enter",ESC:"Escape",F:"f",G:"g",HOME:"Home",I:"i",J:"j",K:"k",L:"l",LEFT:"ArrowLeft",M:"m",O:"o",Q:"q",R:"r",RIGHT:"ArrowRight",S:"s",SPACE:" ",T:"t",U:"u",UP:"ArrowUp",V:"v",W:"w",X:"x",Y:"y",Z:"z"}),x=Object.freeze({AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"}),i=Object.freeze({AUDIO:"audio",BLOCK:"block",BREAK:"break",CAPTION:"caption",CONTAINER:"container",FIGURE:"figure",FORMAT:"format",HEADING:"heading",IFRAME:"iframe",IMAGE:"image",LIST:"list",LISTITEM:"listitem",PARAGRAPH:"paragraph",PREFORMAT:"preformat",QUOTE:"quote",ROOT:"root",RULE:"rule",SLOT:"slot",SUMMARY:"summary",TABLE:"table",TABLECELL:"tablecell",TABLEROW:"tablerow",TABLESECTION:"tablesection",VIDEO:"video"}),r=Object.freeze({A:"a",ABBR:"abbr",ALL:"*",AUDIO:"audio",B:"b",BLOCK:"app-block",BLOCKQUOTE:"blockquote",BR:"br",BUTTON:"button",CITE:"cite",CODE:"code",DATA:"data",DEL:"del",DETAILS:"details",DFN:"dfn",DIALOG:"editor-dialog",DIV:"div",EDITOR:"akilli-editor",EM:"em",FIELDSET:"fieldset",FIGCAPTION:"figcaption",FIGURE:"figure",FORM:"form",FORMATBAR:"editor-formatbar",H2:"h2",H3:"h3",HR:"hr",I:"i",IFRAME:"iframe",IMG:"img",INPUT:"input",INS:"ins",KBD:"kbd",LABEL:"label",LEGEND:"legend",LI:"li",MARK:"mark",OL:"ol",P:"p",PRE:"pre",Q:"q",ROOT:"editor-root",S:"s",SAMP:"samp",SECTION:"section",SLOT:"slot",SMALL:"small",STRONG:"strong",SUB:"sub",SUMMARY:"summary",SUP:"sup",TABLE:"table",TBODY:"tbody",TD:"td",TFOOT:"tfoot",TH:"th",THEAD:"thead",TIME:"time",TOOLBAR:"editor-toolbar",TR:"tr",U:"u",UL:"ul",VAR:"var",VIDEO:"video"}),se=Object.freeze({FUNCTION:"function",STRING:"string",UNDEFINED:"undefined"});function I(o,e,{alt:t=!1,ctrl:s=!1,shift:n=!1}={}){return(Array.isArray(e)&&e.includes(o.key)||o.key===e)&&o.altKey===t&&o.ctrlKey===s&&o.shiftKey===n}function N(o){return o&&typeof o===se.STRING}function W(o){return Ge(o)||o===null||N(o)}function ft(o){return Ge(o)||Array.isArray(o)&&!o.find(e=>!N(e))}function $(o){return typeof o===se.FUNCTION}function Ge(o){return typeof o===se.UNDEFINED}function gt(o){return typeof o===se.UNDEFINED||o===null||o instanceof HTMLElement}var oe,ae,ne,le,bt=class{constructor(e,t,s=null){d(this,oe,void 0);d(this,ae,void 0);d(this,ne,null);d(this,le,null);if(!(e instanceof O)||!N(t)||!W(s))throw f.INVALID_ARGUMENT;E(this,oe,e),E(this,ae,t),E(this,ne,s&&this.editor.tags.get(s)),E(this,le,this.editor.dialogs.get(t))}get editor(){return c(this,oe)}get name(){return c(this,ae)}get tag(){return c(this,ne)}get dialog(){return c(this,le)}execute(){this.dialog?this._openDialog():this._insert(this._selectedAttributes())}_insert(e={}){if(this.tag){Object.keys(e).forEach(s=>this.tag.attributes.includes(s)&&e[s]||delete e[s]);let t=this._selectedElement();this.tag.group!==i.FORMAT?this.editor.dom.insert(this.editor.dom.createElement(this.tag.name,{attributes:e})):t&&Object.keys(e).length>0?t.parentElement.replaceChild(this.editor.dom.createElement(this.tag.name,{attributes:e,html:t.textContent}),t):t?t.parentElement.replaceChild(this.editor.dom.createText(t.textContent),t):this.editor.dom.format(this.editor.dom.createElement(this.tag.name,{attributes:e}))}}_openDialog(){this.dialog?.open(e=>this._insert(e),this._selectedAttributes())}_selectedElement(){let e=this.editor.dom.getSelectedElement();return e&&e.localName===this.tag?.name?e:null}_selectedAttributes(){let e=this._selectedElement(),t={};return e&&this.tag&&Array.from(e.attributes).forEach(s=>{this.tag.attributes.includes(s.nodeName)&&(t[s.nodeName]=s.nodeValue)}),t}};oe=new WeakMap,ae=new WeakMap,ne=new WeakMap,le=new WeakMap;var Q=bt;var U,Et=class{constructor(e=[]){d(this,U,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,U).get(e)||null}set(e){if(!(e instanceof Q))throw f.INVALID_ARGUMENT;c(this,U).set(e.name,e)}execute(e){this.get(e).execute()}freeze(){c(this,U).forEach(e=>Object.freeze(e)),Object.freeze(c(this,U)),Object.freeze(this)}};U=new WeakMap;var ji=Et;var G,Tt=class{constructor(e=[]){d(this,G,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,G).get(e)||null}set(e){if(!(e instanceof j))throw f.INVALID_ARGUMENT;c(this,G).set(e.name,e)}freeze(){c(this,G).forEach(e=>Object.freeze(e)),Object.freeze(c(this,G)),Object.freeze(this)}};G=new WeakMap;var Li=Tt;var Y,Z,Lt,ke,qo,jt=class{constructor(e){d(this,Z);d(this,ke);d(this,Y,void 0);if(!(e instanceof HTMLElement))throw f.INVALID_ARGUMENT;E(this,Y,e),this.register(p(this,ke,qo).bind(this))}dispatch(e,t=null,s=null){if(!N(e)||!gt(t)||!gt(s))throw f.INVALID_ARGUMENT;c(this,Y).dispatchEvent(new CustomEvent(e,{detail:{element:t,target:s}}))}register(e,t={childList:!0,subtree:!0}){if(!$(e))throw f.INVALID_ARGUMENT;new MutationObserver(e).observe(c(this,Y),t)}};Y=new WeakMap,Z=new WeakSet,Lt=function(e,t,s){t instanceof HTMLElement&&s instanceof HTMLElement&&(this.dispatch(e,t,s),this.dispatch(`${e}${t.localName.replace("-","")}`,t,s))},ke=new WeakSet,qo=function(e){e.forEach(t=>{t.addedNodes.forEach(s=>{s instanceof HTMLElement&&(p(this,Z,Lt).call(this,"insert",s,t.target),Array.from(s.getElementsByTagName(r.ALL)).forEach(n=>p(this,Z,Lt).call(this,"insert",n,t.target)))}),t.removedNodes.forEach(s=>s instanceof HTMLElement&&p(this,Z,Lt).call(this,"delete",s,t.target))})};var He=jt;var me,de,ue,Ke,Ve,vo,At=class{constructor(e,t){d(this,Ve);d(this,me,void 0);d(this,de,void 0);d(this,ue,void 0);d(this,Ke,{alwaysRaised:"yes",dependent:"yes",height:"",location:"no",menubar:"no",minimizable:"no",modal:"yes",resizable:"yes",scrollbars:"yes",toolbar:"no",width:""});if(!(e instanceof O)||!(t instanceof Document))throw f.INVALID_ARGUMENT;E(this,me,e),E(this,de,t),E(this,ue,this.document.defaultView)}get editor(){return c(this,me)}get document(){return c(this,de)}get window(){return c(this,ue)}getSelection(){return this.window.getSelection()}getRange(){let e=this.window.getSelection();return e.rangeCount>0?e.getRangeAt(0):null}setRange(e){let t=this.getSelection();t.removeAllRanges(),t.addRange(e)}registerElement(e,t,s=null){Ge(this.window.customElements.get(e))&&this.window.customElements.define(e,t,s?{extends:s}:null)}createElement(e,{attributes:t={},html:s=""}={}){let n=this.document.createElement(e);return n.innerHTML=s,Object.entries(t).forEach(([u,h])=>h&&n.setAttribute(u,`${h}`)),n}insert(e){if(!(e instanceof HTMLElement))throw f.INVALID_ARGUMENT;let t=this.getSelectedEditable();if(t instanceof HTMLSlotElement&&this.editor.tags.allowed(t.parentElement,e))t.insertAdjacentElement(x.BEFOREBEGIN,e);else if(t)this.closest(t,e)?.insertAdjacentElement(x.AFTEREND,e),t.hasAttribute("data-deletable")&&!t.textContent.trim()&&t.parentElement.removeChild(t);else if(this.editor.tags.allowed(this.editor.root,e))this.editor.root.appendChild(e);else throw f.INVALID_ARGUMENT}insertText(e){let t=this.getSelectedEditable();if(t){let s=this.getRange();s.deleteContents(),s.insertNode(this.createText(e)),s.collapse(),t.normalize()}}format(e){if(!(e instanceof HTMLElement))throw f.INVALID_ARGUMENT;let t=this.getRange(),s=this.getSelectedEditable();if(!t||t.collapsed||!t.toString().trim()||!s||!this.editor.tags.allowed(s,e))return;t.startContainer instanceof Text&&t.startContainer.parentElement!==s&&t.setStartBefore(t.startContainer.parentElement),t.endContainer instanceof Text&&t.endContainer.parentElement!==s&&t.setEndAfter(t.endContainer.parentElement);let n=t.toString(),u=Array.from(t.cloneContents().childNodes).every(h=>h instanceof Text&&!h.textContent.trim()||h instanceof HTMLElement&&h.localName===e.localName);t.deleteContents(),u?t.insertNode(this.createText(n)):(e.textContent=n,t.insertNode(e)),s.normalize()}createText(e){return this.document.createTextNode(e)}arbitrary(e){return e===this.editor.root||e?.hasAttribute("data-arbitrary")}contains(e){if(!(e instanceof HTMLElement))throw f.INVALID_ARGUMENT;return this.editor.root.contains(e)||e.closest(this.editor.root.localName)?.parentElement===null}closest(e,t){if(!(e instanceof HTMLElement)||!this.contains(e.parentElement))throw f.INVALID_ARGUMENT;let s=e,n=e.parentElement;do if(this.arbitrary(n)&&this.editor.tags.allowed(n,t))return s;while((s=n)&&(n=n.parentElement)&&this.contains(n));return null}wrap(e,t,s={}){let n;if(e instanceof HTMLElement){if(e.parentElement.localName!==t&&(n=this.editor.dom.closest(e,t))){let u=this.createElement(t,s);n.insertAdjacentElement(x.AFTEREND,u),u.appendChild(e)}}else throw f.INVALID_ARGUMENT}getSelectedElement(){let e=this.getSelection(),t=e.anchorNode instanceof Text?e.anchorNode.parentElement:e.anchorNode,s=e.focusNode instanceof Text?e.focusNode.parentElement:e.focusNode;return t instanceof HTMLElement&&s instanceof HTMLElement&&t===s&&this.contains(t)?t:null}getSelectedEditable(){let e=this.getSelection(),t=e.anchorNode instanceof Text?e.anchorNode.parentElement:e.anchorNode,s=e.focusNode instanceof Text?e.focusNode.parentElement:e.focusNode;if(t instanceof HTMLElement&&s instanceof HTMLElement){let n=t.closest("[contenteditable=true]"),u=s.closest("[contenteditable=true]");if(n instanceof HTMLElement&&n===u&&this.contains(n))return n}return null}focusEnd(e){if(!(e instanceof HTMLElement))throw f.INVALID_ARGUMENT;e.focus();let t=this.document.createRange();t.selectNodeContents(e),t.collapse(),this.setRange(t)}open({url:e,name:t,call:s,params:n={}}){if(!N(e)||!N(t)||!$(s))throw f.INVALID_ARGUMENT;let u=this.createElement(r.A,{attributes:{href:e}}),h=new URL(u.href);Object.entries(n).forEach(([T,_])=>h.searchParams.set(T,`${_}`));let b=this.window.open(h.toString(),t,p(this,Ve,vo).call(this));this.window.addEventListener("message",T=>{T.origin===h.origin&&T.source===b&&(s(T.data),b.close())},!1)}getWidth(){return this.window.screen.width}getHeight(){return this.window.screen.height}};me=new WeakMap,de=new WeakMap,ue=new WeakMap,Ke=new WeakMap,Ve=new WeakSet,vo=function(){let e=Object.assign({},c(this,Ke),{height:`${this.getHeight()}`,width:`${this.getWidth()}`},this.editor.config.base.browser);return Object.entries(e).filter(([,t])=>!!t).map(([t,s])=>`${t}=${s}`).join(",")};var Ai=At;var ce,xt=class{constructor(e){d(this,ce,void 0);if(!(e instanceof O))throw f.INVALID_ARGUMENT;E(this,ce,e)}get editor(){return c(this,ce)}filter(e){throw f.NOT_IMPLEMENTED}};ce=new WeakMap;var w=xt;var k,It=class{constructor(){d(this,k,new Set)}add(e){if(!(e instanceof w))throw f.INVALID_ARGUMENT;c(this,k).add(e)}filter(e){if(!(e instanceof HTMLElement))throw f.INVALID_ARGUMENT;c(this,k).forEach(t=>{e.normalize(),t.filter(e)})}freeze(){c(this,k).forEach(e=>Object.freeze(e)),Object.freeze(c(this,k)),Object.freeze(this)}};k=new WeakMap;var xi=It;var Nt=class{constructor({name:e,group:t,...s}={}){D(this,"name");D(this,"group");D(this,"children",[]);D(this,"attributes",[]);D(this,"alignable",!1);D(this,"arbitrary",!1);D(this,"deletable",!1);D(this,"editable",!1);D(this,"empty",!1);D(this,"focusable",!1);D(this,"navigable",!1);D(this,"slotable",!1);D(this,"sortable",!1);D(this,"enter",null);if(!N(e)||!N(t)||!W(s.enter)||!ft(s.children)||!ft(s.attributes))throw f.INVALID_ARGUMENT;this.name=e,this.group=t,this.children=s.children||[],this.attributes=s.attributes||[],this.arbitrary=s.arbitrary===!0,this.alignable=s.alignable===!0,this.deletable=s.deletable===!0,this.editable=s.editable===!0,this.empty=s.empty===!0,this.focusable=s.focusable===!0,this.navigable=s.navigable===!0,this.slotable=s.slotable===!0,this.sortable=s.sortable===!0,this.enter=s.enter||null}},ze=Nt;var he,_t=class{constructor(e){d(this,he,void 0);if(!(e instanceof O))throw f.INVALID_ARGUMENT;E(this,he,e)}get editor(){return c(this,he)}static get name(){throw f.MISSING_NAME}static get dependencies(){return[]}static get config(){return{}}init(){throw f.NOT_IMPLEMENTED}_(e){return this.editor.translator.translate(this.constructor.name,e)}_i18n(e){e[this.editor.config.base.lang]&&this.editor.translator.set(this.constructor.name,e[this.editor.config.base.lang])}_tag(e){this.editor.tags.set(new ze(e))}_command(e){this.editor.commands.set(new Q(this.editor,this.constructor.name,e))}_toolbar(e,t=null,s=!1){if(!N(e)||!W(t))throw f.INVALID_ARGUMENT;let n=this._(e),u=this.editor.dom.createElement(r.BUTTON,{attributes:{type:"button","data-command":this.constructor.name,title:n,"data-key":t},html:n});s?this.editor.formatbar.appendChild(u):this.editor.toolbar.appendChild(u)}};he=new WeakMap;var l=_t;var F,Rt=class{constructor(e=[]){d(this,F,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,F).get(e)||null}set(e){if(!(e instanceof l))throw f.INVALID_ARGUMENT;c(this,F).set(e.constructor.name,e)}init(){c(this,F).forEach(e=>e.init())}freeze(){c(this,F).forEach(e=>Object.freeze(e)),Object.freeze(c(this,F)),Object.freeze(this)}};F=new WeakMap;var Ii=Rt;var H,wt=class{constructor(e=[]){d(this,H,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,H).get(e instanceof HTMLElement?e.localName:e)||null}set(e){if(!(e instanceof ze))throw f.INVALID_ARGUMENT;c(this,H).set(e.name,e)}allowed(e,t,s=!1){let n=s?t:this.get(t)?.group;return!!this.get(e)?.children.includes(n)}freeze(){c(this,H).forEach(e=>{Object.freeze(e.children),Object.freeze(e.attributes),Object.freeze(e)}),Object.freeze(c(this,H)),Object.freeze(this)}};H=new WeakMap;var Ni=wt;var K,Dt=class{constructor(){d(this,K,new Map)}get(e){return c(this,K).get(e)||null}set(e,t){if(!N(e)||!(t instanceof Object))throw f.INVALID_ARGUMENT;c(this,K).set(e,t)}translate(e,t){return this.get(e)?.[t]||t}freeze(){c(this,K).forEach(e=>Object.freeze(e)),Object.freeze(c(this,K)),Object.freeze(this)}};K=new WeakMap;var _i=Dt;var pe,J,fe,ge,be,Ee,Te,je,Le,Ae,qe,ve,We,$e,Qe,Ye,Ot=class{constructor(e,t={}){d(this,pe,void 0);d(this,J,{});d(this,fe,void 0);d(this,ge,void 0);d(this,be,void 0);d(this,Ee,void 0);d(this,Te,void 0);d(this,je,void 0);d(this,Le,void 0);d(this,Ae,void 0);d(this,qe,new _i);d(this,ve,new Ni);d(this,We,new xi);d(this,$e,new Li);d(this,Qe,new ji);d(this,Ye,new Ii);if(!(e instanceof HTMLElement)||!(t instanceof Object))throw f.INVALID_ARGUMENT;E(this,pe,e),E(this,J,t),E(this,fe,new Ai(this,this.orig.ownerDocument)),E(this,ge,this.dom.createElement(r.EDITOR)),E(this,be,this.dom.createElement(r.TOOLBAR,{attributes:{role:"toolbar"}})),this.element.appendChild(this.toolbar),E(this,Ee,new He(this.toolbar)),E(this,Te,this.dom.createElement(r.FORMATBAR,{attributes:{role:"toolbar"}})),this.formatbar.hidden=!0,this.element.appendChild(this.formatbar),E(this,je,new He(this.formatbar)),E(this,Le,this.dom.createElement(r.ROOT)),this.element.appendChild(this.root),E(this,Ae,new He(this.root))}get orig(){return c(this,pe)}get config(){return c(this,J)}get dom(){return c(this,fe)}get element(){return c(this,ge)}get toolbar(){return c(this,be)}get toolbarDispatcher(){return c(this,Ee)}get formatbar(){return c(this,Te)}get formatbarDispatcher(){return c(this,je)}get root(){return c(this,Le)}get rootDispatcher(){return c(this,Ae)}get translator(){return c(this,qe)}get tags(){return c(this,ve)}get filters(){return c(this,We)}get dialogs(){return c(this,$e)}get commands(){return c(this,Qe)}get plugins(){return c(this,Ye)}static get defaultConfig(){return{}}init(){let e=this.config;E(this,J,{});let t=this.constructor.defaultConfig.base?.plugins||[],s=t;Array.isArray(e.base?.plugins)&&e.base.plugins.length>0&&(s=[],e.base.plugins.forEach(h=>{let b=t.find(T=>T.name===h);b&&s.push(b)}));let n=new Set,u=h=>{h.dependencies?.forEach(u),n.add(h)};s.map(u),n.forEach(h=>{Object.entries(h.config).forEach(([b,T])=>{var _,R;(_=this.config)[R=h.name]??(_[R]={}),this.config[h.name][b]=e[h.name]?.[b]||this.constructor.defaultConfig[h.name]?.[b]||T}),this.plugins.set(new h(this))}),this.plugins.init(),this.toolbarDispatcher.dispatch("init"),this.formatbarDispatcher.dispatch("init"),this.rootDispatcher.dispatch("init")}freeze(){Object.freeze(this.config),this.translator.freeze(),this.tags.freeze(),this.filters.freeze(),this.dialogs.freeze(),this.commands.freeze(),this.plugins.freeze()}load(){this.orig instanceof HTMLTextAreaElement?(this.orig.form.addEventListener("submit",()=>this.save()),this.setHtml(this.orig.value.replace("/&nbsp;/g"," "))):this.setHtml(this.orig.innerHTML),this.orig.insertAdjacentElement(x.AFTEREND,this.element),this.orig.hidden=!0}destroy(){this.element.parentElement.removeChild(this.element),this.orig.hidden=!1}getHtml(){let e=this.dom.createElement(this.root.localName,{html:this.root.innerHTML});return this.filters.filter(e),this.rootDispatcher.dispatch("gethtml",e),e.innerHTML}setHtml(e){let t=this.dom.createElement(this.root.localName,{html:e});this.rootDispatcher.dispatch("sethtml",t),this.filters.filter(t),this.root.innerHTML=t.innerHTML}save(){this.orig instanceof HTMLTextAreaElement?this.orig.value=this.getHtml():this.orig.innerHTML=this.getHtml()}url(e){let t=this.dom.window.origin||this.dom.window.location.origin,s=this.dom.createElement(r.A,{attributes:{href:e}});return t===s.origin?s.pathname:s.href}static create(e,t={}){let s=new this(e,t);return s.init(),s.freeze(),s.load(),s}};pe=new WeakMap,J=new WeakMap,fe=new WeakMap,ge=new WeakMap,be=new WeakMap,Ee=new WeakMap,Te=new WeakMap,je=new WeakMap,Le=new WeakMap,Ae=new WeakMap,qe=new WeakMap,ve=new WeakMap,We=new WeakMap,$e=new WeakMap,Qe=new WeakMap,Ye=new WeakMap;var O=Ot;var xe,Ie,Ne,Ri,Bt=class{constructor(e,t){d(this,Ne);d(this,xe,void 0);d(this,Ie,void 0);if(!(e instanceof O)||!N(t))throw f.INVALID_ARGUMENT;E(this,xe,e),E(this,Ie,t)}get editor(){return c(this,xe)}get name(){return c(this,Ie)}open(e,t={}){let s=this.editor.dom.getRange(),n=()=>{s&&this.editor.dom.setRange(s),p(this,Ne,Ri).call(this)};p(this,Ne,Ri).call(this);let u=this.editor.dom.createElement(r.FORM,{attributes:{method:"dialog"}}),h=this.editor.dom.createElement(r.FIELDSET),b=this.editor.dom.createElement(r.BUTTON,{attributes:{type:"button"},html:this._("Cancel")});b.addEventListener("click",n),u.appendChild(h),u.appendChild(b),u.appendChild(this.editor.dom.createElement(r.BUTTON,{html:this._("Save")})),this._initFieldset(h),u.addEventListener("submit",_=>{_.preventDefault(),_.stopPropagation(),n();let R={};Array.from(h.elements).forEach(L=>R[L.name]=L.value),e(R)}),Object.entries(t).forEach(([_,R])=>h.elements[_]&&(h.elements[_].value=R));let T=this.editor.dom.createElement(r.DIALOG);T.addEventListener("close",n),T.appendChild(u),T.show(),this.editor.element.appendChild(T)}_(e){return this.editor.translator.translate(this.name,e)}_initFieldset(e){throw f.NOT_IMPLEMENTED}_createInput(e,t,s,n={}){if(!N(e)||!N(t)||!N(s))throw f.INVALID_ARGUMENT;Object.assign(n,{id:`editor-${e}`,name:e,type:t});let u=this.editor.dom.createElement(r.DIV);return u.appendChild(this.editor.dom.createElement(r.LABEL,{attributes:{for:n.id},html:s})),u.appendChild(this.editor.dom.createElement(r.INPUT,{attributes:n})),n.required&&u.setAttribute("data-required",""),u}};xe=new WeakMap,Ie=new WeakMap,Ne=new WeakSet,Ri=function(){Array.from(this.editor.element.getElementsByTagName(r.DIALOG)).forEach(e=>{e.parentElement.removeChild(e)})};var j=Bt;var Mt=class extends j{constructor(e){super(e,Ze.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Abbreviation")})),e.appendChild(this._createInput("title","text",this._("Full term"),{placeholder:this._("Insert full term or leave empty to remove it")}))}},wi=Mt;var _e,yt=class{constructor(e){d(this,_e,void 0);if(!(e instanceof O))throw f.INVALID_ARGUMENT;E(this,_e,e)}get editor(){return c(this,_e)}handleEvent(e){$(this[e.type])&&this[e.type](e)}};_e=new WeakMap;var g=yt;var Ct=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-alignable")&&e.detail.element.addEventListener("keydown",this)}keydown(e){let t={[a.UP]:null,[a.LEFT]:"left",[a.DOWN]:"center",[a.RIGHT]:"right"};e.target===e.currentTarget&&I(e,Object.keys(t),{shift:!0})&&(e.preventDefault(),e.stopPropagation(),e.target.classList.remove(...Object.values(t)),t[e.key]&&e.target.classList.add(t[e.key]))}},Di=Ct;var Je,Wo,Re,Oi,Pt=class extends w{constructor(){super(...arguments);d(this,Je);d(this,Re)}filter(e){let t=this.editor.tags.get(e),s=this.editor.tags.allowed(e,r.P),n=t.editable||t.group===i.FORMAT,u=[],h=(b=null)=>{s&&u.length>0&&(e.insertBefore(this.editor.dom.createElement(r.P,{html:u.join(" ")}),b),u=[])};Array.from(e.childNodes).forEach(b=>{let T=b.textContent.trim();if(b instanceof HTMLElement){let _=p(this,Je,Wo).call(this,b),R=this.editor.tags.get(_);if(R&&this.editor.tags.allowed(e,_))h(_),p(this,Re,Oi).call(this,_,R);else if(R&&R.group===i.FORMAT&&s){let L=p(this,Re,Oi).call(this,_,R);L&&(u.push(L.outerHTML),e.removeChild(L))}else!n&&T&&s?(u.push(T),e.removeChild(_)):n&&T?e.replaceChild(this.editor.dom.createText(T),_):e.removeChild(_)}else b instanceof Text?(!n&&T&&s&&u.push(T),(!n||!T)&&e.removeChild(b)):b instanceof Node&&e.removeChild(b)}),h()}};Je=new WeakSet,Wo=function(e){let t=this.editor.config.base.filter[e.localName];if(!t)return e;let s=this.editor.dom.createElement(t,{html:e.innerHTML});return e.parentElement.replaceChild(s,e),s},Re=new WeakSet,Oi=function(e,t){return Array.from(e.attributes).forEach(s=>!t.attributes.includes(s.name)&&e.removeAttribute(s.name)),e.hasChildNodes()&&this.editor.filters.filter(e),e.hasChildNodes()||t.empty?e:(e.parentElement.removeChild(e),null)};var Bi=Pt;var St=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-deletable")&&e.detail.element.addEventListener("keydown",this)}keydown(e){e.target===e.currentTarget&&I(e,a.DEL,{ctrl:!0})&&(e.target.previousElementSibling instanceof HTMLElement&&this.editor.dom.focusEnd(e.target.previousElementSibling),e.target.parentElement.removeChild(e.target),e.preventDefault(),e.stopPropagation())}},Mi=St;var Ft=class extends HTMLElement{get open(){return this.hasAttribute("open")}set open(e){e===!0?this.setAttribute("open",""):this.removeAttribute("open")}constructor(){super();this.addEventListener("keydown",e=>e.key===a.ESC&&this.close()),this.addEventListener("click",e=>e.target===this&&this.close())}connectedCallback(){this.setAttribute("role","dialog"),this.tabIndex=-1,this.focus()}show(){this.open=!0,this.dispatchEvent(new CustomEvent("show",{detail:{element:this,target:this}}))}close(){this.open=!1,this.dispatchEvent(new CustomEvent("close",{detail:{element:this,target:this}}))}},yi=Ft;var Ut=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.contentEditable==="true"&&e.detail.element.addEventListener("keydown",this)}keydown(e){if(I(e,a.ENTER,{shift:!0})&&!this.editor.tags.allowed(e.target,r.BR))e.preventDefault(),e.stopPropagation();else if(I(e,a.ENTER)){e.preventDefault(),e.stopPropagation();let t=this.editor.tags.get(e.target)?.enter;t&&(e.target.textContent.trim()||!e.target.hasAttribute("data-deletable")?this.editor.dom.closest(e.target,t)?.insertAdjacentElement(x.AFTEREND,this.editor.dom.createElement(t)):e.target instanceof HTMLParagraphElement||(this.editor.dom.closest(e.target,r.P)?.insertAdjacentElement(x.AFTEREND,this.editor.dom.createElement(r.P)),e.target.parentElement.removeChild(e.target)))}else I(e,a.BACKSPACE)&&!e.target.textContent&&e.target.hasAttribute("data-deletable")?(e.target.previousElementSibling instanceof HTMLElement&&this.editor.dom.focusEnd(e.target.previousElementSibling),e.target.parentElement.removeChild(e.target),e.preventDefault(),e.stopPropagation()):/^[A-Z]$/.test(e.key)&&I(e,e.key,{alt:!0,shift:!0})&&(e.preventDefault(),e.stopPropagation(),this.editor.formatbar.querySelector(`${r.BUTTON}[data-key=${e.key.toLowerCase()}]`)?.click())}},Ci=Ut;var Gt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-focusable")&&e.detail.element.focus()}},Pi=Gt;var kt=class extends g{insertbutton(e){let t=e.detail.element.getAttribute("data-key");if(t){let s=this.editor.translator.translate(m.name,"Alt"),n=this.editor.translator.translate(m.name,"Shift");e.detail.element.title+=` [${s} + ${n} + ${t}]`}e.detail.element.getAttribute("data-command")&&e.detail.element.addEventListener("click",this),e.detail.element.parentElement===this.editor.toolbar&&(e.detail.element.tabIndex=-1,e.detail.element.addEventListener("keydown",this))}click(e){this.editor.commands.execute(e.target.getAttribute("data-command"))}keydown(e){if(I(e,[a.LEFT,a.RIGHT,a.HOME,a.END])){let t=e.target.previousElementSibling,s=e.target.nextElementSibling,n=e.target.parentElement.firstElementChild,u=e.target.parentElement.lastElementChild,h=e.target===n,b=e.target===u;e.key===a.LEFT&&!h?t.focus():e.key===a.RIGHT&&!b?s.focus():e.key===a.HOME||e.key===a.RIGHT&&b?n.focus():(e.key===a.END||e.key===a.LEFT&&h)&&u.focus(),e.preventDefault(),e.stopPropagation()}}},Xe=kt;var Ht=class extends Xe{constructor(e){super(e);this.editor.formatbar.addEventListener("insertbutton",this),this.editor.dom.document.addEventListener("selectionchange",this)}selectionchange(){let e=this.editor.dom.getSelectedEditable();if(e&&!this.editor.dom.getSelection().isCollapsed&&this.editor.tags.allowed(e,i.FORMAT,!0)){let t=e.offsetTop+e.offsetParent.offsetTop-this.editor.formatbar.clientHeight;this.editor.formatbar.style.top=`${t}px`,this.editor.formatbar.hidden=!1}else this.editor.formatbar.hidden=!0,this.editor.formatbar.removeAttribute("style")}},Si=Ht;var et,$o,Kt=class extends g{constructor(e){super(e);d(this,et);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-navigable")&&(e.detail.element.tabIndex=0,e.detail.element.addEventListener("keydown",this))}keydown(e){if(e.target===e.currentTarget&&I(e,[a.UP,a.DOWN,a.HOME,a.END])&&p(this,et,$o).call(this,e.target)){let t=e.target.previousElementSibling,s=e.target.nextElementSibling,n=e.target.parentElement.firstElementChild,u=e.target.parentElement.lastElementChild,h=e.target===n,b=e.target===u;e.key===a.UP&&!h&&t.hasAttribute("data-navigable")?t.focus():e.key===a.DOWN&&!b&&s.hasAttribute("data-navigable")?s.focus():(e.key===a.HOME||e.key===a.DOWN&&b)&&n.hasAttribute("data-navigable")?n.focus():(e.key===a.END||e.key===a.UP&&h)&&u.hasAttribute("data-navigable")&&u.focus(),e.preventDefault(),e.stopPropagation()}}};et=new WeakSet,$o=function(e){if(e.contentEditable!=="true")return!0;let t=this.editor.dom.getSelection(),s=this.editor.dom.getSelectedEditable(),n=this.editor.dom.getSelectedElement();return t.isCollapsed&&t.anchorOffset===0&&[s,e.firstChild].includes(n)};var Fi=Kt;var Vt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element instanceof HTMLSlotElement?e.detail.element.addEventListener("keydown",this):e.detail.element.hasAttribute("data-slotable")&&!e.detail.element.querySelector(":scope > "+r.SLOT)&&e.detail.element.appendChild(this.editor.dom.createElement(r.SLOT))}keydown(e){e.preventDefault(),e.stopPropagation()}},Ui=Vt;var we,Gi,De,ki,zt=class extends g{constructor(e){super(e);d(this,we);d(this,De);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-sortable")&&(e.detail.element.addEventListener("keydown",this),e.detail.element.addEventListener("pointerdown",this),e.detail.element.addEventListener("pointermove",this),e.detail.element.addEventListener("pointerup",this))}keydown(e){if(e.target===e.currentTarget&&I(e,[a.UP,a.DOWN,a.HOME,a.END],{ctrl:!0})){let t=e.target.parentElement,s=e.target.previousElementSibling,n=e.target.nextElementSibling,u=t.firstElementChild,h=t.lastElementChild,b=e.target===u,T=e.target===h;e.key===a.UP&&!b&&s.hasAttribute("data-sortable")?(s.insertAdjacentHTML(x.BEFOREBEGIN,e.target.outerHTML),t.removeChild(e.target)):e.key===a.DOWN&&!T&&n.hasAttribute("data-sortable")?(n.insertAdjacentHTML(x.AFTEREND,e.target.outerHTML),t.removeChild(e.target)):(e.key===a.HOME&&!b||e.key===a.DOWN&&T)&&u.hasAttribute("data-sortable")?(u.insertAdjacentHTML(x.BEFOREBEGIN,e.target.outerHTML),t.removeChild(e.target)):(e.key===a.END&&!T||e.key===a.UP&&b)&&h.hasAttribute("data-sortable")&&(h.insertAdjacentHTML(x.AFTEREND,e.target.outerHTML),t.removeChild(e.target)),e.preventDefault(),e.stopPropagation()}}pointerdown(e){e.target.hasAttribute("data-sortable")&&(e.target.setAttribute("data-sort",""),e.target.setPointerCapture(e.pointerId))}pointermove(e){let t=this.editor.dom.document.elementFromPoint(e.x,e.y);p(this,we,Gi).call(this),p(this,De,ki).call(this,e.target,t)&&t.setAttribute("data-sortover","")}pointerup(e){if(e.target.hasAttribute("data-sortable")){let t=this.editor.dom.document.elementFromPoint(e.x,e.y);p(this,we,Gi).call(this),e.target.removeAttribute("data-sort"),e.target.releasePointerCapture(e.pointerId),p(this,De,ki).call(this,e.target,t)&&t.insertAdjacentElement(x.BEFOREBEGIN,e.target)}}};we=new WeakSet,Gi=function(){this.editor.root.querySelectorAll("[data-sortover]").forEach(e=>e.removeAttribute("data-sortover"))},De=new WeakSet,ki=function(e,t){return e instanceof HTMLElement&&t instanceof HTMLElement&&this.editor.dom.contains(t)&&![this.editor.root,e].includes(t)&&t.hasAttribute("data-sortable")&&(e.parentElement===t.parentElement||this.editor.dom.arbitrary(e.parentElement)&&this.editor.dom.arbitrary(t.parentElement))&&this.editor.tags.allowed(t.parentElement,e)};var Hi=zt;var qt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){let t=this.editor.tags.get(e.detail.element);t&&(t.editable&&(e.detail.element.contentEditable="true"),["alignable","arbitrary","deletable","focusable","navigable","slotable","sortable"].forEach(s=>{t[s]&&(e.detail.element.dataset[s]="")}))}},Ki=qt;var vt=class extends Xe{constructor(e){super(e);this.editor.toolbar.addEventListener("insertbutton",this)}},Vi=vt;var zi={de:{Alt:"Alt",Shift:"Umschalt"}};var Wt=class extends l{static get name(){return"base"}static get config(){return{browser:{},filter:{},lang:null,plugins:[]}}init(){this._i18n(zi),this.editor.dom.registerElement(r.DIALOG,yi),this._tag({name:r.ROOT,group:i.ROOT,children:[i.AUDIO,i.BLOCK,i.CONTAINER,i.FIGURE,i.HEADING,i.IFRAME,i.IMAGE,i.LIST,i.PARAGRAPH,i.PREFORMAT,i.QUOTE,i.RULE,i.TABLE,i.VIDEO]}),this._tag({name:r.SLOT,group:i.SLOT,editable:!0,focusable:!0,navigable:!0,sortable:!0}),new Ki(this.editor),new Vi(this.editor),new Si(this.editor),new Ci(this.editor),new Mi(this.editor),new Fi(this.editor),new Hi(this.editor),new Di(this.editor),new Pi(this.editor),new Ui(this.editor),this.editor.filters.add(new Bi(this.editor))}},m=Wt;var qi={de:{Abbreviation:"Abk\xFCrzung",Cancel:"Abbrechen","Full term":"Langform","Insert full term or leave empty to remove it":"Langform eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var $t=class extends l{static get name(){return"abbreviation"}static get dependencies(){return[m]}init(){this._i18n(qi),this._tag({name:r.ABBR,group:i.FORMAT,attributes:["title"]}),this.editor.dialogs.set(new wi(this.editor)),this._command(r.ABBR),this._toolbar("Abbreviation",a.A,!0)}},Ze=$t;var Qt=class extends j{constructor(e){super(e,X.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Audio")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to audio"),required:"required"}))}},vi=Qt;var Oe,Wi,Yt=class extends g{constructor(e){super(e);d(this,Oe);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertaudio",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.AUDIO)).forEach(t=>p(this,Oe,Wi).call(this,t))}insertaudio(e){p(this,Oe,Wi).call(this,e.detail.element)}};Oe=new WeakSet,Wi=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.controls=!0,this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:X.name}})):e.parentElement.removeChild(e)};var $i=Yt;var Be,Zt=class extends j{constructor(e,t,s){super(e,t);d(this,Be,void 0);if(!N(s))throw f.INVALID_ARGUMENT;E(this,Be,s)}open(e,t={}){this.editor.dom.open({url:c(this,Be),name:this.name,call:e,params:t})}};Be=new WeakMap;var C=Zt;var Jt=class extends w{filter(e){e.querySelectorAll(`${r.FIGURE} > ${r.FIGCAPTION}:only-child`).forEach(t=>t.parentElement.removeChild(t))}},Qi=Jt;var Xt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertfigure",this)}insertfigure(e){e.detail.element.querySelector(":scope > "+r.FIGCAPTION)||e.detail.element.appendChild(this.editor.dom.createElement(r.FIGCAPTION))}},Yi=Xt;var er=class extends l{static get name(){return"figure"}static get dependencies(){return[m]}init(){this._tag({name:r.FIGURE,group:i.FIGURE,children:[i.AUDIO,i.CAPTION,i.IFRAME,i.IMAGE,i.PREFORMAT,i.QUOTE,i.TABLE,i.VIDEO],attributes:["class"],alignable:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._tag({name:r.FIGCAPTION,group:i.CAPTION,children:[i.FORMAT],editable:!0,navigable:!0,enter:r.P}),new Yi(this.editor),this.editor.filters.add(new Qi(this.editor))}},B=er;var Zi={de:{Audio:"Audio",Cancel:"Abbrechen","Insert URL to audio":"URL zur Audiodatei eingeben",Save:"Speichern",URL:"URL"}};var tr=class extends l{static get name(){return"audio"}static get dependencies(){return[m,B]}static get config(){return{browser:null}}init(){this._i18n(Zi),this._tag({name:r.AUDIO,group:i.AUDIO,attributes:["controls","src"],empty:!0,navigable:!0}),new $i(this.editor);let e=this.editor.config.audio.browser;e?this.editor.dialogs.set(new C(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new vi(this.editor)),this._command(r.AUDIO),this._toolbar("Audio")}},X=tr;var rr=class extends j{constructor(e){super(e,tt.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Block")})),e.appendChild(this._createInput("id","text",this._("ID"),{required:"required"}))}},Ji=rr;var ir=class extends HTMLElement{get content(){return this.shadowRoot.innerHTML}set content(e){this.shadowRoot.innerHTML=e}constructor(){super();this.attachShadow({mode:"open"})}},Xi=ir;var sr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertappblock",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.BLOCK)).forEach(t=>t.id||t.parentElement.removeChild(t))}async insertappblock(e){if(!e.detail.element.id){e.detail.element.parentElement.removeChild(e.detail.element);return}if(!this.editor.config.block.api)return;let t=this.editor.config.block.api.replace("{id}",e.detail.element.id),s=await fetch(t,{mode:"no-cors"});if(!s.ok)return;let n="";this.editor.config.block.css&&(n=this.editor.config.block.css.split(",").map(h=>`<link rel="stylesheet" href="${h}">`).join(""));let u=await s.text();e.detail.element.content=n+u}},es=sr;var rt={de:{Cancel:"Abbrechen",Height:"H\xF6he",Ifrane:"Iframe","Insert URL to embedded page":"URL zur eingebetteten Seite eingeben",Save:"Speichern",URL:"URL",Width:"Breite"}};var or=class extends l{static get name(){return"block"}static get dependencies(){return[m]}static get config(){return{api:null,browser:null,css:null}}init(){this._i18n(rt),this.editor.dom.registerElement(r.BLOCK,Xi),this._tag({name:r.BLOCK,group:i.BLOCK,attributes:["id"],deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),new es(this.editor);let e=this.editor.config.block.browser;e?this.editor.dialogs.set(new C(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new Ji(this.editor)),this._command(r.BLOCK),this._toolbar("Block")}},tt=or;var ar=class extends w{filter(e){e instanceof HTMLElement&&e.localName===r.FIGURE&&e.classList.contains(V.name)&&e.querySelector(":scope > "+r.BLOCKQUOTE)&&!e.querySelector(":scope > "+r.FIGCAPTION)&&(e.insertAdjacentElement(x.BEFOREBEGIN,e.querySelector(":scope > "+r.BLOCKQUOTE)),e.innerHTML="")}},ts=ar;var nr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertblockquote",this),this.editor.root.addEventListener("deleteblockquote",this)}insertblockquote(e){this.editor.dom.wrap(e.detail.element,r.FIGURE,{attributes:{class:V.name}})}deleteblockquote(e){e.detail.target.localName===r.FIGURE&&e.detail.target.classList.contains(V.name)&&e.detail.target.parentElement.removeChild(e.detail.target)}},rs=nr;var lr=class extends w{filter(e){if(e instanceof HTMLPreElement){e.outerHTML=e.outerHTML.replace(/(<br\s*\/?>)/gi,`
`);return}e.innerHTML=e.innerHTML.replace(/^\s*(<br\s*\/?>\s*)+/gi,"").replace(/\s*(<br\s*\/?>\s*)+$/gi,""),e instanceof HTMLParagraphElement?e.outerHTML=e.outerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"</p><p>"):e.innerHTML=e.innerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"<br>")}},is=lr;var mr=class extends l{static get name(){return"break"}static get dependencies(){return[m]}init(){this._tag({name:r.BR,group:i.BREAK,empty:!0}),this.editor.filters.add(new is(this.editor))}},P=mr;var ss={de:{Blockquote:"Blockzitat"}};var dr=class extends l{static get name(){return"blockquote"}static get dependencies(){return[m,P,B]}init(){this._i18n(ss),this._tag({name:r.BLOCKQUOTE,group:i.QUOTE,children:[i.BREAK,i.FORMAT],deletable:!0,editable:!0,navigable:!0,enter:r.P}),new rs(this.editor),this._command(r.BLOCKQUOTE),this._toolbar("Blockquote"),this.editor.filters.add(new ts(this.editor))}},V=dr;var os={de:{bold:"fett"}};var ur=class extends l{static get name(){return"bold"}static get dependencies(){return[m]}init(){this._i18n(os),this._tag({name:r.B,group:i.FORMAT}),this._command(r.B),this._toolbar("bold",a.B,!0)}},as=ur;var ns={de:{Citation:"Zitatquelle"}};var cr=class extends l{static get name(){return"cite"}static get dependencies(){return[m]}init(){this._i18n(ns),this._tag({name:r.CITE,group:i.FORMAT}),this._command(r.CITE),this._toolbar("Citation",a.Z,!0)}},ls=cr;var ms={de:{Code:"Quelltext"}};var hr=class extends l{static get name(){return"code"}static get dependencies(){return[m]}init(){this._i18n(ms),this._tag({name:r.CODE,group:i.FORMAT}),this._command(r.CODE),this._toolbar("Code",a.C,!0)}},ds=hr;var pr=class extends j{constructor(e){super(e,it.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Data")})),e.appendChild(this._createInput("value","text",this._("Machine-readable Value"),{placeholder:this._("Insert value or leave empty to remove it")}))}},us=pr;var cs={de:{Cancel:"Abbrechen",Data:"Data","Machine-readable Value":"Maschinenlesbarer Wert","Insert value or leave empty to remove it":"Wert eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var fr=class extends l{static get name(){return"data"}static get dependencies(){return[m]}init(){this._i18n(cs),this._tag({name:r.DATA,group:i.FORMAT,attributes:["value"]}),this.editor.dialogs.set(new us(this.editor)),this._command(r.DATA),this._toolbar("Data",a.J,!0)}},it=fr;var hs={de:{Definition:"Definition"}};var gr=class extends l{static get name(){return"definition"}static get dependencies(){return[m]}init(){this._i18n(hs),this._tag({name:r.DFN,group:i.FORMAT}),this._command(r.DFN),this._toolbar("Definition",a.D,!0)}},ps=gr;var fs={de:{"Text Deletion":"Textl\xF6schung"}};var br=class extends l{static get name(){return"deletion"}static get dependencies(){return[m]}init(){this._i18n(fs),this._tag({name:r.DEL,group:i.FORMAT}),this._command(r.DEL),this._toolbar("Text Deletion",a.G,!0)}},gs=br;var Er=class extends w{filter(e){e.querySelectorAll(`${r.SUMMARY}:not(:first-child)`).forEach(t=>t.parentElement.removeChild(t)),e.querySelectorAll(`${r.SUMMARY}:only-child`).forEach(t=>t.parentElement.removeChild(t))}},bs=Er;var Me,Es,Tr=class extends g{constructor(e){super(e);d(this,Me);this.editor.root.addEventListener("insertdetails",this),this.editor.root.addEventListener("insertsummary",this)}insertdetails(e){e.detail.element.open=!0,e.detail.element.querySelector(`:scope > ${r.SUMMARY}:first-child`)||e.detail.element.insertAdjacentElement(x.AFTERBEGIN,this.editor.dom.createElement(r.SUMMARY))}insertsummary(e){p(this,Me,Es).call(this,e.detail.element),e.detail.element.addEventListener("blur",this),e.detail.element.addEventListener("keydown",this)}blur(e){p(this,Me,Es).call(this,e.target)}keydown(e){I(e,a.SPACE)?(e.preventDefault(),e.stopPropagation(),this.editor.dom.insertText(" ")):I(e,a.ENTER)&&(e.preventDefault(),e.stopPropagation(),e.target.parentElement.open=!0)}};Me=new WeakSet,Es=function(e){e.textContent.trim()?e.querySelectorAll(r.BR+":not(:last-child)").forEach(t=>t.parentElement.removeChild(t)):e.textContent=this.editor.translator.translate(st.name,"Details"),e.lastElementChild instanceof HTMLBRElement||e.appendChild(this.editor.dom.createElement(r.BR))};var Ts=Tr;var js={de:{Details:"Details"}};var jr=class extends l{static get name(){return"details"}static get dependencies(){return[m]}init(){this._i18n(js),this._tag({name:r.DETAILS,group:i.CONTAINER,children:[i.AUDIO,i.FIGURE,i.IFRAME,i.IMAGE,i.LIST,i.PARAGRAPH,i.PREFORMAT,i.QUOTE,i.RULE,i.SUMMARY,i.TABLE,i.VIDEO],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._tag({name:r.SUMMARY,group:i.SUMMARY,editable:!0,navigable:!0,enter:r.P}),new Ts(this.editor),this._command(r.DETAILS),this._toolbar("Details"),this.editor.filters.add(new bs(this.editor))}},st=jr;var Lr=class extends j{constructor(e){super(e,ot.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Division")})),e.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}},Ls=Lr;var As={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse",Division:"Division","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern"}};var Ar=class extends l{static get name(){return"division"}static get dependencies(){return[m]}init(){this._i18n(As),this._tag({name:r.DIV,group:i.CONTAINER,children:[i.AUDIO,i.BLOCK,i.FIGURE,i.IFRAME,i.IMAGE,i.PREFORMAT,i.QUOTE,i.RULE,i.TABLE,i.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new Ls(this.editor)),this._command(r.DIV),this._toolbar("Division")}},ot=Ar;var xs={de:{emphasized:"betont"}};var xr=class extends l{static get name(){return"emphasis"}static get dependencies(){return[m]}init(){this._i18n(xs),this._tag({name:r.EM,group:i.FORMAT}),this._command(r.EM),this._toolbar("emphasized",a.E,!0)}},Is=xr;var Ns={de:{Heading:"\xDCberschrift"}};var Ir=class extends l{static get name(){return"heading"}static get dependencies(){return[m]}init(){this._i18n(Ns),this._tag({name:r.H2,group:i.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.P}),this._command(r.H2),this._toolbar("Heading")}},_s=Ir;var Rs={de:{"Horizontal Rule":"Horizontale Linie"}};var Nr=class extends l{static get name(){return"horizontalrule"}static get dependencies(){return[m]}init(){this._i18n(Rs),this._tag({name:r.HR,group:i.RULE,deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(r.HR),this._toolbar("Horizontal Rule")}},ws=Nr;var _r=class extends j{constructor(e){super(e,ee.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Iframe")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to embedded page"),required:"required"})),e.appendChild(this._createInput("width","number",this._("Width"))),e.appendChild(this._createInput("height","number",this._("Height")))}},Ds=_r;var ye,Os,Rr=class extends g{constructor(e){super(e);d(this,ye);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertiframe",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.IFRAME)).forEach(t=>p(this,ye,Os).call(this,t))}insertiframe(e){p(this,ye,Os).call(this,e.detail.element)}};ye=new WeakSet,Os=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.allowFullscreen=!0,this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:ee.name}})):e.parentElement.removeChild(e)};var Bs=Rr;var wr=class extends l{static get name(){return"iframe"}static get dependencies(){return[m,B]}static get config(){return{browser:null}}init(){this._i18n(rt),this._tag({name:r.IFRAME,group:i.IFRAME,attributes:["allowfullscreen","height","src","width"],empty:!0,navigable:!0}),new Bs(this.editor);let e=this.editor.config.iframe.browser;e?this.editor.dialogs.set(new C(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new Ds(this.editor)),this._command(r.IFRAME),this._toolbar("Iframe")}},ee=wr;var Dr=class extends j{constructor(e){super(e,te.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Image")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to image"),required:"required"})),e.appendChild(this._createInput("alt","text",this._("Alternative text"),{placeholder:this._("Text shown when media element is not available")})),e.appendChild(this._createInput("width","number",this._("Width"))),e.appendChild(this._createInput("height","number",this._("Height")))}},Ms=Dr;var Ce,ys,Or=class extends g{constructor(e){super(e);d(this,Ce);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertimg",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.IMG)).forEach(t=>p(this,Ce,ys).call(this,t))}insertimg(e){p(this,Ce,ys).call(this,e.detail.element)}};Ce=new WeakSet,ys=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:te.name}})):e.parentElement.removeChild(e)};var Cs=Or;var Ps={de:{"Alternative text":"Alternativtext",Cancel:"Abbrechen",Height:"H\xF6he",Image:"Bild","Insert URL to image":"URL zur Bilddatei eingeben",Save:"Speichern","Text shown when media element is not available":"Ersatztext, falls Medienelement nicht verf\xFCgbar ist",URL:"URL",Width:"Breite"}};var Br=class extends l{static get name(){return"image"}static get dependencies(){return[m,B]}static get config(){return{browser:null}}init(){this._i18n(Ps),this._tag({name:r.IMG,group:i.IMAGE,attributes:["alt","height","src","width"],empty:!0,navigable:!0}),new Cs(this.editor);let e=this.editor.config.image.browser;e?this.editor.dialogs.set(new C(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new Ms(this.editor)),this._command(r.IMG),this._toolbar("Image")}},te=Br;var Ss={de:{"Text Insertion":"Texteinf\xFCgung"}};var Mr=class extends l{static get name(){return"insertion"}static get dependencies(){return[m]}init(){this._i18n(Ss),this._tag({name:r.INS,group:i.FORMAT}),this._command(r.INS),this._toolbar("Text Insertion",a.F,!0)}},Fs=Mr;var Us={de:{italic:"kursiv"}};var yr=class extends l{static get name(){return"italic"}static get dependencies(){return[m]}init(){this._i18n(Us),this._tag({name:r.I,group:i.FORMAT}),this._command(r.I),this._toolbar("italic",a.I,!0)}},Gs=yr;var ks={de:{"User Input":"Benutzereingabe"}};var Cr=class extends l{static get name(){return"keyboard"}static get dependencies(){return[m]}init(){this._i18n(ks),this._tag({name:r.KBD,group:i.FORMAT}),this._command(r.KBD),this._toolbar("User Input",a.K,!0)}},Hs=Cr;var Pr=class extends j{constructor(e){super(e,at.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Link")})),e.appendChild(this._createInput("href","text",this._("URL"),{pattern:"(https?|/|mailto:|tel:).+",placeholder:this._("Insert link or leave empty to unlink")}))}},Ks=Pr;var Pe,Vs,Sr=class extends g{constructor(e){super(e);d(this,Pe);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("inserta",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.A)).forEach(t=>p(this,Pe,Vs).call(this,t))}inserta(e){p(this,Pe,Vs).call(this,e.detail.element)}};Pe=new WeakSet,Vs=function(e){let t=e.getAttribute("href");t?e.setAttribute("href",this.editor.url(t)):e.parentElement.replaceChild(this.editor.dom.createText(e.textContent),e)};var zs=Sr;var qs={de:{Cancel:"Abbrechen","Insert link or leave empty to unlink":"Link eingeben oder zum Entfernen leer lassen",Link:"Link",Save:"Speichern",URL:"URL"}};var Fr=class extends l{static get name(){return"link"}static get dependencies(){return[m]}init(){this._i18n(qs),this._tag({name:r.A,group:i.FORMAT,attributes:["href"]}),new zs(this.editor),this.editor.dialogs.set(new Ks(this.editor)),this._command(r.A),this._toolbar("Link",a.L,!0)}},at=Fr;var vs={de:{mark:"markiert"}};var Ur=class extends l{static get name(){return"mark"}static get dependencies(){return[m]}init(){this._i18n(vs),this._tag({name:r.MARK,group:i.FORMAT}),this._command(r.MARK),this._toolbar("mark",a.M,!0)}},Ws=Ur;var Se,$s,Gr=class extends g{constructor(e){super(e);d(this,Se);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertli",this),this.editor.root.addEventListener("deleteli",this),this.editor.root.addEventListener("insertol",this),this.editor.root.addEventListener("insertul",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.LI)).forEach(t=>p(this,Se,$s).call(this,t))}insertli(e){p(this,Se,$s).call(this,e.detail.element)}deleteli(e){e.detail.target.children.length===0&&e.detail.target.parentElement.removeChild(e.detail.target)}insertol(e){e.detail.element.children.length===0&&e.detail.element.appendChild(this.editor.dom.createElement(r.LI))}insertul(e){this.insertol(e)}};Se=new WeakSet,$s=function(e){!(e.parentElement instanceof HTMLOListElement)&&!(e.parentElement instanceof HTMLUListElement)&&this.editor.dom.wrap(e,r.UL)};var Qs=Gr;var kr=class extends l{static get name(){return"list"}static get dependencies(){return[m,P]}init(){this._tag({name:r.LI,group:i.LISTITEM,children:[i.BREAK,i.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.LI}),new Qs(this.editor)}},nt=kr;var Ys={de:{"Ordered List":"Geordnete Liste"}};var Hr=class extends l{static get name(){return"orderedlist"}static get dependencies(){return[m,nt]}init(){this._i18n(Ys),this._tag({name:r.OL,group:i.LIST,children:[i.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(r.OL),this._toolbar("Ordered List")}},Zs=Hr;var Fe,Js,Kr=class extends g{constructor(e){super(e);d(this,Fe);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertp",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.P)).forEach(t=>p(this,Fe,Js).call(this,t))}insertp(e){p(this,Fe,Js).call(this,e.detail.element)}paste(e){this.editor.dom.window.setTimeout(()=>this.editor.filters.filter(e.target))}};Fe=new WeakSet,Js=function(e){e.addEventListener("paste",this)};var Xs=Kr;var eo={de:{Paragraph:"Absatz"}};var Vr=class extends l{static get name(){return"paragraph"}static get dependencies(){return[m,P]}init(){this._i18n(eo),this._tag({name:r.P,group:i.PARAGRAPH,children:[i.BREAK,i.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.P}),new Xs(this.editor),this._command(r.P),this._toolbar("Paragraph")}},to=Vr;var zr=class extends w{filter(e){e instanceof HTMLElement&&e.localName===r.FIGURE&&e.classList.contains(z.name)&&e.querySelector(":scope > "+r.PRE)&&!e.querySelector(":scope > "+r.FIGCAPTION)&&(e.insertAdjacentElement(x.BEFOREBEGIN,e.querySelector(":scope > "+r.PRE)),e.innerHTML="")}},ro=zr;var qr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertpre",this),this.editor.root.addEventListener("deletepre",this)}insertpre(e){this.editor.dom.wrap(e.detail.element,r.FIGURE,{attributes:{class:z.name}})}deletepre(e){e.detail.target.localName===r.FIGURE&&e.detail.target.classList.contains(z.name)&&e.detail.target.parentElement.removeChild(e.detail.target)}},io=qr;var so={de:{"Preformatted Text":"Vorformatierter Text"}};var vr=class extends l{static get name(){return"preformat"}static get dependencies(){return[m,P,B]}init(){this._i18n(so),this._tag({name:r.PRE,group:i.PREFORMAT,children:[i.BREAK],deletable:!0,editable:!0,navigable:!0,enter:r.P}),new io(this.editor),this._command(r.PRE),this._toolbar("Preformatted Text"),this.editor.filters.add(new ro(this.editor))}},z=vr;var oo={de:{Quote:"Zitat"}};var Wr=class extends l{static get name(){return"quote"}static get dependencies(){return[m]}init(){this._i18n(oo),this._tag({name:r.Q,group:i.FORMAT}),this._command(r.Q),this._toolbar("Quote",a.Q,!0)}},ao=Wr;var no={de:{"Sample Output":"Beispielausgabe"}};var $r=class extends l{static get name(){return"sample"}static get dependencies(){return[m]}init(){this._i18n(no),this._tag({name:r.SAMP,group:i.FORMAT}),this._command(r.SAMP),this._toolbar("Sample Output",a.O,!0)}},lo=$r;var Qr=class extends j{constructor(e){super(e,lt.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Section")})),e.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}},mo=Qr;var uo={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern",Section:"Sektion"}};var Yr=class extends l{static get name(){return"section"}static get dependencies(){return[m]}init(){this._i18n(uo),this._tag({name:r.SECTION,group:i.CONTAINER,children:[i.AUDIO,i.FIGURE,i.HEADING,i.IFRAME,i.IMAGE,i.LIST,i.PARAGRAPH,i.PREFORMAT,i.QUOTE,i.RULE,i.TABLE,i.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new mo(this.editor)),this._command(r.SECTION),this._toolbar("Section")}},lt=Yr;var co={de:{small:"klein"}};var Zr=class extends l{static get name(){return"small"}static get dependencies(){return[m]}init(){this._i18n(co),this._tag({name:r.SMALL,group:i.FORMAT}),this._command(r.SMALL),this._toolbar("small",a.W,!0)}},ho=Zr;var po={de:{strikethrough:"durchgestrichen"}};var Jr=class extends l{static get name(){return"strikethrough"}static get dependencies(){return[m]}init(){this._i18n(po),this._tag({name:r.S,group:i.FORMAT}),this._command(r.S),this._toolbar("strikethrough",a.R,!0)}},fo=Jr;var go={de:{"strongly emphasized":"stark betont"}};var Xr=class extends l{static get name(){return"strong"}static get dependencies(){return[m]}init(){this._i18n(go),this._tag({name:r.STRONG,group:i.FORMAT}),this._command(r.STRONG),this._toolbar("strongly emphasized",a.S,!0)}},bo=Xr;var Eo={de:{Subheading:"Unter\xFCberschrift"}};var ei=class extends l{static get name(){return"subheading"}static get dependencies(){return[m]}init(){this._i18n(Eo),this._tag({name:r.H3,group:i.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.P}),this._command(r.H3),this._toolbar("Subheading")}},To=ei;var jo={de:{subscript:"tiefgestellt"}};var ti=class extends l{static get name(){return"subscript"}static get dependencies(){return[m]}init(){this._i18n(jo),this._tag({name:r.SUB,group:i.FORMAT}),this._command(r.SUB),this._toolbar("subscript",a.X,!0)}},Lo=ti;var Ao={de:{superscript:"hochgestellt"}};var ri=class extends l{static get name(){return"superscript"}static get dependencies(){return[m]}init(){this._i18n(Ao),this._tag({name:r.SUP,group:i.FORMAT}),this._command(r.SUP),this._toolbar("superscript",a.Y,!0)}},xo=ri;var ii=class extends Q{constructor(e){super(e,M.name,r.TABLE)}_insert({rows:e=1,cols:t=1}={}){let s=this.editor.dom.createElement(r.FIGURE,{attributes:{class:M.name}}),n=this.editor.dom.createElement(r.TABLE),u=this.editor.dom.createElement(r.TBODY);for(let h=0;h<e;h++){let b=this.editor.dom.createElement(r.TR);u.appendChild(b);for(let T=0;T<t;++T)b.appendChild(this.editor.dom.createElement(r.TD))}n.appendChild(u),s.appendChild(n),this.editor.dom.insert(s)}},Io=ii;var si=class extends j{constructor(e){super(e,M.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Table")})),e.appendChild(this._createInput("rows","number",this._("Rows"),{min:"1",required:"required",value:"1"})),e.appendChild(this._createInput("cols","number",this._("Columns"),{min:"1",required:"required",value:"1"}))}},No=si;var oi=class extends w{filter(e){e instanceof HTMLElement&&e.localName===r.FIGURE&&e.classList.contains(M.name)&&e.querySelector(":scope > "+r.TABLE)&&!e.querySelector(":scope > "+r.FIGCAPTION)?(e.insertAdjacentElement(x.BEFOREBEGIN,e.querySelector(":scope > "+r.TABLE)),e.innerHTML=""):(e instanceof HTMLTableElement&&e.querySelector(`:scope > ${r.THEAD}, :scope > ${r.TFOOT}`)&&!e.querySelector(":scope > "+r.TBODY)||e instanceof HTMLTableSectionElement&&e.rows.length<=0||e instanceof HTMLTableRowElement&&!e.querySelector(`:scope > ${r.TH}:not(:empty), :scope > ${r.TD}:not(:empty)`))&&(e.innerHTML="")}},_o=oi;var q,mt,re,ni,dt,Qo,ai=class extends g{constructor(e){super(e);d(this,q);d(this,re);d(this,dt);this.editor.root.addEventListener("inserttable",this),this.editor.root.addEventListener("inserttd",this),this.editor.root.addEventListener("insertth",this)}inserttable(e){this.editor.dom.wrap(e.detail.element,r.FIGURE,{attributes:{class:M.name}}),e.detail.element.tBodies.length>0&&e.detail.element.tBodies[0].rows[0]&&(!e.detail.element.tHead||!e.detail.element.tFoot)&&(e.detail.element.tHead||p(this,q,mt).call(this,e.detail.element.createTHead(),e.detail.element.tBodies[0].rows[0].cells.length),e.detail.element.tFoot||p(this,q,mt).call(this,e.detail.element.createTFoot(),e.detail.element.tBodies[0].rows[0].cells.length))}inserttd(e){e.detail.element.addEventListener("keydown",this)}insertth(e){e.detail.element.addEventListener("keydown",this)}keydown(e){let t=e.target,s=t.parentElement,n=s.parentElement,u=n instanceof HTMLTableElement?n:n.parentElement,h=[a.LEFT,a.RIGHT,a.UP,a.DOWN],b=I(e,h),T=I(e,h,{ctrl:!0}),_=I(e,h,{alt:!0}),R=I(e,h,{alt:!0,shift:!0});if(t instanceof HTMLTableCellElement&&s instanceof HTMLTableRowElement&&(n instanceof HTMLTableElement||n instanceof HTMLTableSectionElement)&&u instanceof HTMLTableElement&&(b&&p(this,dt,Qo).call(this,t,e.key)||T||_||R)){let L=t.cellIndex,S=s.cells.length,v=n.rows.length,y=n instanceof HTMLTableElement?s.rowIndex:s.sectionRowIndex,ct=L===0,ht=L===S-1,Ho=y===0,Ko=y===v-1,Ei=s.rowIndex===0,Ti=s.rowIndex===u.rows.length-1;e.preventDefault(),e.stopPropagation(),b?e.key===a.LEFT&&!ct?this.editor.dom.focusEnd(s.cells[L-1]):e.key===a.LEFT&&Ei?this.editor.dom.focusEnd(u.rows[u.rows.length-1].cells[S-1]):e.key===a.LEFT?this.editor.dom.focusEnd(u.rows[s.rowIndex-1].cells[S-1]):e.key===a.RIGHT&&!ht?s.cells[L+1].focus():e.key===a.RIGHT&&Ti?u.rows[0].cells[0].focus():e.key===a.RIGHT?u.rows[s.rowIndex+1].cells[0].focus():e.key===a.UP&&Ei?u.rows[u.rows.length-1].cells[L].focus():e.key===a.UP?u.rows[s.rowIndex-1].cells[L].focus():e.key===a.DOWN&&Ti?u.rows[0].cells[L].focus():e.key===a.DOWN&&u.rows[s.rowIndex+1].cells[L].focus():T?(e.key===a.LEFT&&S>1&&ct?Array.from(u.rows).forEach(A=>A.appendChild(A.cells[L])):e.key===a.LEFT&&S>1?Array.from(u.rows).forEach(A=>A.insertBefore(A.cells[L],A.cells[L-1])):e.key===a.RIGHT&&S>1&&ht?Array.from(u.rows).forEach(A=>A.insertBefore(A.cells[L],A.cells[0])):e.key===a.RIGHT&&S>1?Array.from(u.rows).forEach(A=>A.insertBefore(A.cells[L+1],A.cells[L])):e.key===a.UP&&v>1&&Ho?n.appendChild(s):e.key===a.UP&&v>1?n.insertBefore(s,n.rows[y-1]):e.key===a.DOWN&&v>1&&Ko?n.insertBefore(s,n.rows[0]):e.key===a.DOWN&&v>1&&n.insertBefore(n.rows[y+1],s),t.focus()):_?e.key===a.LEFT?Array.from(u.rows).forEach(A=>p(this,re,ni).call(this,A,A.cells[L])):e.key===a.RIGHT?Array.from(u.rows).forEach(A=>p(this,re,ni).call(this,A,A.cells[L+1])):e.key===a.UP?p(this,q,mt).call(this,n,S,y):e.key===a.DOWN&&p(this,q,mt).call(this,n,S,y+1):R&&(e.key===a.LEFT&&!ct?Array.from(u.rows).forEach(A=>A.deleteCell(L-1)):e.key===a.RIGHT&&!ht?Array.from(u.rows).forEach(A=>A.deleteCell(L+1)):e.key===a.UP&&y>0?n.deleteRow(y-1):e.key===a.DOWN&&y<v-1&&n.deleteRow(y+1))}}};q=new WeakSet,mt=function(e,t,s=0){let n=e.insertRow(s);for(let u=0;u<t;u++)p(this,re,ni).call(this,n)},re=new WeakSet,ni=function(e,t=null){let s=e.parentElement.localName===r.THEAD?r.TH:r.TD;e.insertBefore(this.editor.dom.createElement(s),t)},dt=new WeakSet,Qo=function(e,t){if([a.UP,a.DOWN].includes(t))return!0;let s=this.editor.dom.getSelection(),n=s.anchorNode instanceof HTMLElement&&s.anchorNode;if(!s.isCollapsed)return!1;if(t===a.LEFT){let h=e.firstChild;return h instanceof HTMLElement&&(h=h.firstChild),s.anchorOffset===0&&[e,h].includes(n)}let u=e.lastChild;return e.lastChild instanceof HTMLBRElement&&e.lastChild.previousSibling&&(u=e.lastChild.previousSibling),u instanceof HTMLElement&&(u=u.lastChild),s.anchorOffset===n.textContent.length&&[e,u].includes(n)};var Ro=ai;var wo={de:{Cancel:"Abbrechen",Columns:"Spalten",Rows:"Zeilen",Save:"Speichern",Table:"Tabelle"}};var li=class extends l{static get name(){return"table"}static get dependencies(){return[m,P,B]}init(){this._i18n(wo),this._tag({name:r.TABLE,group:i.TABLE,children:[i.TABLESECTION],deletable:!0,navigable:!0}),this._tag({name:r.THEAD,group:i.TABLESECTION,children:[i.TABLEROW]}),this._tag({name:r.TBODY,group:i.TABLESECTION,children:[i.TABLEROW]}),this._tag({name:r.TFOOT,group:i.TABLESECTION,children:[i.TABLEROW]}),this._tag({name:r.TR,group:i.TABLEROW,children:[i.TABLECELL]}),this._tag({name:r.TH,group:i.TABLECELL,children:[i.BREAK,i.FORMAT],editable:!0,empty:!0}),this._tag({name:r.TD,group:i.TABLECELL,children:[i.BREAK,i.FORMAT],editable:!0,empty:!0}),new Ro(this.editor),this.editor.filters.add(new _o(this.editor)),this.editor.dialogs.set(new No(this.editor)),this.editor.commands.set(new Io(this.editor)),this._toolbar("Table")}},M=li;var mi=class extends j{constructor(e){super(e,ut.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Time")})),e.appendChild(this._createInput("datetime","text",this._("Machine-readable Datetime"),{placeholder:this._("Insert date/time or leave empty to remove it")}))}},Do=mi;var Oo={de:{Cancel:"Abbrechen","Insert date/time or leave empty to remove it":"Datum/Zeit eingeben oder zum Entfernen leer lassen","Machine-readable Datetime":"Maschinenlesbare Datums-/Zeitangabe",Save:"Speichern",Time:"Zeit"}};var di=class extends l{static get name(){return"time"}static get dependencies(){return[m]}init(){this._i18n(Oo),this._tag({name:r.TIME,group:i.FORMAT,attributes:["datetime"]}),this.editor.dialogs.set(new Do(this.editor)),this._command(r.TIME),this._toolbar("Time",a.T,!0)}},ut=di;var Bo={de:{underline:"unterstrichen"}};var ui=class extends l{static get name(){return"underline"}static get dependencies(){return[m]}init(){this._i18n(Bo),this._tag({name:r.U,group:i.FORMAT}),this._command(r.U),this._toolbar("underline",a.U,!0)}},Mo=ui;var yo={de:{"Unordered List":"Ungeordnete Liste"}};var ci=class extends l{static get name(){return"unorderedlist"}static get dependencies(){return[m,nt]}init(){this._i18n(yo),this._tag({name:r.UL,group:i.LIST,children:[i.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(r.UL),this._toolbar("Unordered List")}},Co=ci;var Po={de:{Variable:"Variable"}};var hi=class extends l{static get name(){return"variable"}static get dependencies(){return[m]}init(){this._i18n(Po),this._tag({name:r.VAR,group:i.FORMAT}),this._command(r.VAR),this._toolbar("Variable",a.V,!0)}},So=hi;var pi=class extends j{constructor(e){super(e,ie.name)}_initFieldset(e){e.appendChild(this.editor.dom.createElement(r.LEGEND,{html:this._("Video")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to video"),required:"required"})),e.appendChild(this._createInput("width","number",this._("Width"))),e.appendChild(this._createInput("height","number",this._("Height")))}},Fo=pi;var Ue,Uo,fi=class extends g{constructor(e){super(e);d(this,Ue);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertvideo",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.VIDEO)).forEach(t=>p(this,Ue,Uo).call(this,t))}insertvideo(e){p(this,Ue,Uo).call(this,e.detail.element)}};Ue=new WeakSet,Uo=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.controls=!0,this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:ie.name}})):e.parentElement.removeChild(e)};var Go=fi;var ko={de:{Cancel:"Abbrechen",Height:"H\xF6he","Insert URL to video":"URL zur Videodatei eingeben",Save:"Speichern",URL:"URL",Video:"Video",Width:"Breite"}};var gi=class extends l{static get name(){return"video"}static get dependencies(){return[m,B]}static get config(){return{browser:null}}init(){this._i18n(ko),this._tag({name:r.VIDEO,group:i.VIDEO,attributes:["controls","height","src","width"],empty:!0,navigable:!0}),new Go(this.editor);let e=this.editor.config.video.browser;e?this.editor.dialogs.set(new C(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new Fo(this.editor)),this._command(r.VIDEO),this._toolbar("Video")}},ie=gi;var bi=class extends O{static get defaultConfig(){return{base:{plugins:[as,Gs,bo,Is,Mo,fo,at,Ws,ho,ps,Ze,ao,ls,ds,Hs,lo,So,Lo,xo,ut,it,Fs,gs,to,_s,To,Co,Zs,ws,V,te,ie,X,ee,M,z,lt,st,ot,tt]}}}},Zg=bi;export{Zg as default};
