var So=Object.defineProperty;var Po=(o,e,t)=>e in o?So(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var y=(o,e,t)=>(Po(o,typeof e!="symbol"?e+"":e,t),t),We=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var c=(o,e,t)=>(We(o,e,"read from private field"),t?t.call(o):e.get(o)),m=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},E=(o,e,t,i)=>(We(o,e,"write to private field"),i?i.call(o,t):e.set(o,t),t);var f=(o,e,t)=>(We(o,e,"access private method"),t);var V,W,Q,$,Qe=class{constructor(e,t,i=null){m(this,V,void 0);m(this,W,void 0);m(this,Q,null);m(this,$,null);if(!(e instanceof C)||!t||typeof t!="string"||i&&typeof i!="string")throw"Invalid argument";E(this,V,e),E(this,W,t),E(this,Q,i&&this.editor.tags.get(i)),E(this,$,this.editor.dialogs.get(t))}get editor(){return c(this,V)}get name(){return c(this,W)}get tag(){return c(this,Q)}get dialog(){return c(this,$)}execute(){this.dialog?this._openDialog():this._insert(this._selectedAttributes())}_insert(e={}){if(this.tag){Object.keys(e).forEach(i=>this.tag.attributes.includes(i)&&e[i]||delete e[i]);let t=this._selectedElement();this.tag.group!=="format"?this.editor.dom.insert(this.editor.dom.createElement(this.tag.name,{attributes:e})):t&&Object.keys(e).length>0?t.parentElement.replaceChild(this.editor.dom.createElement(this.tag.name,{attributes:e,html:t.textContent}),t):t?t.parentElement.replaceChild(this.editor.dom.createText(t.textContent),t):this.editor.dom.format(this.editor.dom.createElement(this.tag.name,{attributes:e}))}}_openDialog(){this.dialog?.open(e=>this._insert(e),this._selectedAttributes())}_selectedElement(){let e=this.editor.dom.getSelectedElement();return e&&e.localName===this.tag?.name?e:null}_selectedAttributes(){let e=this._selectedElement(),t={};return e&&this.tag&&Array.from(e.attributes).forEach(i=>{this.tag.attributes.includes(i.nodeName)&&(t[i.nodeName]=i.nodeValue)}),t}};V=new WeakMap,W=new WeakMap,Q=new WeakMap,$=new WeakMap;var G=Qe;var S,$e=class{constructor(e=[]){m(this,S,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,S).get(e)||null}set(e){if(!(e instanceof G))throw"Invalid argument";c(this,S).set(e.name,e)}execute(e){this.get(e).execute()}freeze(){c(this,S).forEach(e=>Object.freeze(e)),Object.freeze(c(this,S)),Object.freeze(this)}};S=new WeakMap;var Zr=$e;var P,Ye=class{constructor(e=[]){m(this,P,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,P).get(e)||null}set(e){if(!(e instanceof T))throw"Invalid argument";c(this,P).set(e.name,e)}freeze(){c(this,P).forEach(e=>Object.freeze(e)),Object.freeze(c(this,P)),Object.freeze(this)}};P=new WeakMap;var Jr=Ye;var v,K,Je,ye,No,Ze=class{constructor(e){m(this,K);m(this,ye);m(this,v,void 0);if(!(e instanceof HTMLElement))throw"Invalid argument";E(this,v,e),this.register(f(this,ye,No).bind(this))}dispatch(e,t=null,i=null){if(!e||typeof e!="string"||t&&!(t instanceof HTMLElement)||i&&!(i instanceof HTMLElement))throw"Invalid argument";c(this,v).dispatchEvent(new CustomEvent(e,{detail:{element:t,target:i}}))}register(e,t={childList:!0,subtree:!0}){if(typeof e!="function")throw"Invalid argument";new MutationObserver(e).observe(c(this,v),t)}};v=new WeakMap,K=new WeakSet,Je=function(e,t,i){t instanceof HTMLElement&&i instanceof HTMLElement&&(this.dispatch(e,t,i),this.dispatch(`${e}${t.localName.replace("-","")}`,t,i))},ye=new WeakSet,No=function(e){e.forEach(t=>{t.addedNodes.forEach(i=>{i instanceof HTMLElement&&(f(this,K,Je).call(this,"insert",i,t.target),Array.from(i.getElementsByTagName("*")).forEach(n=>f(this,K,Je).call(this,"insert",n,t.target)))}),t.removedNodes.forEach(i=>i instanceof HTMLElement&&f(this,K,Je).call(this,"delete",i,t.target))})};var Ce=Ze;var Y,Z,J,Ie,Be,ko,Xe=class{constructor(e,t){m(this,Be);m(this,Y,void 0);m(this,Z,void 0);m(this,J,void 0);m(this,Ie,{alwaysRaised:"yes",dependent:"yes",height:"",location:"no",menubar:"no",minimizable:"no",modal:"yes",resizable:"yes",scrollbars:"yes",toolbar:"no",width:""});if(!(e instanceof C)||!(t instanceof Document))throw"Invalid argument";E(this,Y,e),E(this,Z,t),E(this,J,this.document.defaultView)}get editor(){return c(this,Y)}get document(){return c(this,Z)}get window(){return c(this,J)}getSelection(){return this.window.getSelection()}getRange(){let e=this.window.getSelection();return e.rangeCount>0?e.getRangeAt(0):null}setRange(e){let t=this.getSelection();t.removeAllRanges(),t.addRange(e)}registerElement(e,t,i=null){typeof this.window.customElements.get(e)=="undefined"&&this.window.customElements.define(e,t,i?{extends:i}:null)}createElement(e,{attributes:t={},html:i=""}={}){let n=this.document.createElement(e);return n.innerHTML=i,Object.entries(t).forEach(([u,h])=>h&&n.setAttribute(u,`${h}`)),n}insert(e){if(!(e instanceof HTMLElement))throw"Invalid argument";let t=this.getSelectedEditable();if(t instanceof HTMLSlotElement&&this.editor.tags.allowed(t.parentElement,e))t.insertAdjacentElement("beforebegin",e);else if(t)this.closest(t,e)?.insertAdjacentElement("afterend",e),t.hasAttribute("data-deletable")&&!t.textContent.trim()&&t.parentElement.removeChild(t);else if(this.editor.tags.allowed(this.editor.root,e))this.editor.root.appendChild(e);else throw"Invalid argument"}insertText(e){let t=this.getSelectedEditable();if(t){let i=this.getRange();i.deleteContents(),i.insertNode(this.createText(e)),i.collapse(),t.normalize()}}format(e){if(!(e instanceof HTMLElement))throw"Invalid argument";let t=this.getRange(),i=this.getSelectedEditable();if(!t||t.collapsed||!t.toString().trim()||!i||!this.editor.tags.allowed(i,e))return;t.startContainer instanceof Text&&t.startContainer.parentElement!==i&&t.setStartBefore(t.startContainer.parentElement),t.endContainer instanceof Text&&t.endContainer.parentElement!==i&&t.setEndAfter(t.endContainer.parentElement);let n=t.toString(),u=Array.from(t.cloneContents().childNodes).every(h=>h instanceof Text&&!h.textContent.trim()||h instanceof HTMLElement&&h.localName===e.localName);t.deleteContents(),u?t.insertNode(this.createText(n)):(e.textContent=n,t.insertNode(e)),i.normalize()}createText(e){return this.document.createTextNode(e)}arbitrary(e){return e===this.editor.root||e?.hasAttribute("data-arbitrary")}contains(e){if(!(e instanceof HTMLElement))throw"Invalid argument";return this.editor.root.contains(e)||e.closest(this.editor.root.localName)?.parentElement===null}closest(e,t){if(!(e instanceof HTMLElement)||!this.contains(e.parentElement))throw"Invalid argument";let i=e,n=e.parentElement;do if(this.arbitrary(n)&&this.editor.tags.allowed(n,t))return i;while((i=n)&&(n=n.parentElement)&&this.contains(n));return null}wrap(e,t,i={}){let n;if(e instanceof HTMLElement){if(e.parentElement.localName!==t&&(n=this.editor.dom.closest(e,t))){let u=this.createElement(t,i);n.insertAdjacentElement("afterend",u),u.appendChild(e)}}else throw"Invalid argument"}getSelectedElement(){let e=this.getSelection(),t=e.anchorNode instanceof Text?e.anchorNode.parentElement:e.anchorNode,i=e.focusNode instanceof Text?e.focusNode.parentElement:e.focusNode;return t instanceof HTMLElement&&i instanceof HTMLElement&&t===i&&this.contains(t)?t:null}getSelectedEditable(){let e=this.getSelection(),t=e.anchorNode instanceof Text?e.anchorNode.parentElement:e.anchorNode,i=e.focusNode instanceof Text?e.focusNode.parentElement:e.focusNode;if(t instanceof HTMLElement&&i instanceof HTMLElement){let n=t.closest("[contenteditable=true]"),u=i.closest("[contenteditable=true]");if(n instanceof HTMLElement&&n===u&&this.contains(n))return n}return null}focusEnd(e){if(!(e instanceof HTMLElement))throw"Invalid argument";e.focus();let t=this.document.createRange();t.selectNodeContents(e),t.collapse(),this.setRange(t)}open({url:e,name:t,call:i,params:n={}}){if(!e||typeof e!="string"||!t||typeof t!="string"||typeof i!="function")throw"Invalid argument";let u=this.createElement("a",{attributes:{href:e}}),h=new URL(u.href);Object.entries(n).forEach(([b,A])=>h.searchParams.set(b,`${A}`));let p=this.window.open(h.toString(),t,f(this,Be,ko).call(this));this.window.addEventListener("message",b=>{b.origin===h.origin&&b.source===p&&(i(b.data),p.close())},!1)}getWidth(){return this.window.screen.width}getHeight(){return this.window.screen.height}};Y=new WeakMap,Z=new WeakMap,J=new WeakMap,Ie=new WeakMap,Be=new WeakSet,ko=function(){let e=Object.assign({},c(this,Ie),{height:`${this.getHeight()}`,width:`${this.getWidth()}`},this.editor.config.base.browser);return Object.entries(e).filter(([,t])=>!!t).map(([t,i])=>`${t}=${i}`).join(",")};var Xr=Xe;var X,et=class{constructor(e){m(this,X,void 0);if(!(e instanceof C))throw"Invalid argument";E(this,X,e)}get editor(){return c(this,X)}filter(e){throw"Not implemented"}};X=new WeakMap;var _=et;var N,tt=class{constructor(){m(this,N,new Set)}add(e){if(!(e instanceof _))throw"Invalid argument";c(this,N).add(e)}filter(e){if(!(e instanceof HTMLElement))throw"Invalid argument";c(this,N).forEach(t=>{e.normalize(),t.filter(e)})}freeze(){c(this,N).forEach(e=>Object.freeze(e)),Object.freeze(c(this,N)),Object.freeze(this)}};N=new WeakMap;var ei=tt;var rt=class{constructor({name:e,group:t,...i}={}){y(this,"name");y(this,"group");y(this,"children",[]);y(this,"attributes",[]);y(this,"alignable",!1);y(this,"arbitrary",!1);y(this,"deletable",!1);y(this,"editable",!1);y(this,"empty",!1);y(this,"focusable",!1);y(this,"navigable",!1);y(this,"slotable",!1);y(this,"sortable",!1);y(this,"enter",null);let n=p=>p&&typeof p=="string",u=p=>typeof p=="undefined"||p&&typeof p=="string",h=p=>typeof p=="undefined"||Array.isArray(p)&&!p.find(b=>!n(b));if(!n(e)||!n(t)||!u(i.enter)||!h(i.children)||!h(i.attributes))throw"Invalid argument";this.name=e,this.group=t,this.children=i.children||[],this.attributes=i.attributes||[],this.arbitrary=i.arbitrary===!0,this.alignable=i.alignable===!0,this.deletable=i.deletable===!0,this.editable=i.editable===!0,this.empty=i.empty===!0,this.focusable=i.focusable===!0,this.navigable=i.navigable===!0,this.slotable=i.slotable===!0,this.sortable=i.sortable===!0,this.enter=i.enter||null}},Re=rt;var a=Object.freeze({A:"a",B:"b",BACKSPACE:"Backspace",C:"c",D:"d",DEL:"Delete",DOWN:"ArrowDown",E:"e",END:"End",ENTER:"Enter",ESC:"Escape",F:"f",G:"g",HOME:"Home",I:"i",J:"j",K:"k",L:"l",LEFT:"ArrowLeft",M:"m",O:"o",Q:"q",R:"r",RIGHT:"ArrowRight",S:"s",SPACE:" ",T:"t",U:"u",UP:"ArrowUp",V:"v",W:"w",X:"x",Y:"y",Z:"z"}),r=Object.freeze({AUDIO:"audio",BLOCK:"block",BREAK:"break",CAPTION:"caption",CONTAINER:"container",FIGURE:"figure",FORMAT:"format",HEADING:"heading",IFRAME:"iframe",IMAGE:"image",LIST:"list",LISTITEM:"listitem",PARAGRAPH:"paragraph",PREFORMAT:"preformat",QUOTE:"quote",ROOT:"root",RULE:"rule",SLOT:"slot",SUMMARY:"summary",TABLE:"table",TABLECELL:"tablecell",TABLEROW:"tablerow",TABLESECTION:"tablesection",VIDEO:"video"}),s=Object.freeze({A:"a",ABBR:"abbr",AUDIO:"audio",B:"b",BLOCK:"app-block",BLOCKQUOTE:"blockquote",BR:"br",BUTTON:"button",CITE:"cite",CODE:"code",DATA:"data",DEL:"del",DETAILS:"details",DFN:"dfn",DIALOG:"editor-dialog",DIV:"div",EDITOR:"akilli-editor",EM:"em",FIELDSET:"fieldset",FIGCAPTION:"figcaption",FIGURE:"figure",FORM:"form",FORMATBAR:"editor-formatbar",H2:"h2",H3:"h3",HR:"hr",I:"i",IFRAME:"iframe",IMG:"img",INPUT:"input",INS:"ins",KBD:"kbd",LABEL:"label",LEGEND:"legend",LI:"li",MARK:"mark",OL:"ol",P:"p",PRE:"pre",Q:"q",ROOT:"editor-root",S:"s",SAMP:"samp",SECTION:"section",SLOT:"slot",SMALL:"small",STRONG:"strong",SUB:"sub",SUMMARY:"summary",SUP:"sup",TABLE:"table",TBODY:"tbody",TD:"td",TFOOT:"tfoot",TH:"th",THEAD:"thead",TIME:"time",TOOLBAR:"editor-toolbar",TR:"tr",U:"u",UL:"ul",VAR:"var",VIDEO:"video"});var ee,it=class{constructor(e){m(this,ee,void 0);if(!(e instanceof C))throw"Invalid argument";E(this,ee,e)}get editor(){return c(this,ee)}static get name(){throw"Missing plugin name"}static get dependencies(){return[]}static get config(){return{}}init(){throw"Not implemented"}_(e){return this.editor.translator.translate(this.constructor.name,e)}_i18n(e){e[this.editor.config.base.lang]&&this.editor.translator.set(this.constructor.name,e[this.editor.config.base.lang])}_tag(e){this.editor.tags.set(new Re(e))}_command(e){this.editor.commands.set(new G(this.editor,this.constructor.name,e))}_toolbar(e,t=null,i=!1){if(!e||typeof e!="string"||t&&typeof t!="string")throw"Invalid argument";let n=this._(e),u=this.editor.dom.createElement(s.BUTTON,{attributes:{type:"button","data-command":this.constructor.name,title:n,"data-key":t},html:n});i?this.editor.formatbar.appendChild(u):this.editor.toolbar.appendChild(u)}};ee=new WeakMap;var l=it;var D,st=class{constructor(e=[]){m(this,D,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,D).get(e)||null}set(e){if(!(e instanceof l))throw"Invalid argument";c(this,D).set(e.constructor.name,e)}init(){c(this,D).forEach(e=>e.init())}freeze(){c(this,D).forEach(e=>Object.freeze(e)),Object.freeze(c(this,D)),Object.freeze(this)}};D=new WeakMap;var ti=st;var k,ot=class{constructor(e=[]){m(this,k,new Map);e.forEach(t=>this.set(t))}get(e){return c(this,k).get(e instanceof HTMLElement?e.localName:e)||null}set(e){if(!(e instanceof Re))throw"Invalid argument";c(this,k).set(e.name,e)}allowed(e,t,i=!1){let n=i?t:this.get(t)?.group;return!!this.get(e)?.children.includes(n)}freeze(){c(this,k).forEach(e=>{Object.freeze(e.children),Object.freeze(e.attributes),Object.freeze(e)}),Object.freeze(c(this,k)),Object.freeze(this)}};k=new WeakMap;var ri=ot;var H,at=class{constructor(){m(this,H,new Map)}get(e){return c(this,H).get(e)||null}set(e,t){if(!e||typeof e!="string"||!(t instanceof Object))throw"Invalid argument";c(this,H).set(e,t)}translate(e,t){return this.get(e)?.[t]||t}freeze(){c(this,H).forEach(e=>Object.freeze(e)),Object.freeze(c(this,H)),Object.freeze(this)}};H=new WeakMap;var ii=at;var te,z,re,ie,se,oe,ae,ne,le,de,Oe,Me,De,Se,Pe,Ne,nt=class{constructor(e,t={}){m(this,te,void 0);m(this,z,{});m(this,re,void 0);m(this,ie,void 0);m(this,se,void 0);m(this,oe,void 0);m(this,ae,void 0);m(this,ne,void 0);m(this,le,void 0);m(this,de,void 0);m(this,Oe,new ii);m(this,Me,new ri);m(this,De,new ei);m(this,Se,new Jr);m(this,Pe,new Zr);m(this,Ne,new ti);if(!(e instanceof HTMLElement)||!(t instanceof Object))throw"Invalid argument";E(this,te,e),E(this,z,t),E(this,re,new Xr(this,this.orig.ownerDocument)),E(this,ie,this.dom.createElement("akilli-editor")),E(this,se,this.dom.createElement("editor-toolbar",{attributes:{role:"toolbar"}})),this.element.appendChild(this.toolbar),E(this,oe,new Ce(this.toolbar)),E(this,ae,this.dom.createElement("editor-formatbar",{attributes:{role:"toolbar"}})),this.formatbar.hidden=!0,this.element.appendChild(this.formatbar),E(this,ne,new Ce(this.formatbar)),E(this,le,this.dom.createElement("editor-root")),this.element.appendChild(this.root),E(this,de,new Ce(this.root))}get orig(){return c(this,te)}get config(){return c(this,z)}get dom(){return c(this,re)}get element(){return c(this,ie)}get toolbar(){return c(this,se)}get toolbarDispatcher(){return c(this,oe)}get formatbar(){return c(this,ae)}get formatbarDispatcher(){return c(this,ne)}get root(){return c(this,le)}get rootDispatcher(){return c(this,de)}get translator(){return c(this,Oe)}get tags(){return c(this,Me)}get filters(){return c(this,De)}get dialogs(){return c(this,Se)}get commands(){return c(this,Pe)}get plugins(){return c(this,Ne)}static get defaultConfig(){return{}}init(){let e=this.config;E(this,z,{});let t=this.constructor.defaultConfig.base?.plugins||[],i=t;Array.isArray(e.base?.plugins)&&e.base.plugins.length>0&&(i=[],e.base.plugins.forEach(h=>{let p=t.find(b=>b.name===h);p&&i.push(p)}));let n=new Set,u=h=>{h.dependencies?.forEach(u),n.add(h)};i.map(u),n.forEach(h=>{Object.entries(h.config).forEach(([p,b])=>{var A,w;(A=this.config)[w=h.name]??(A[w]={}),this.config[h.name][p]=e[h.name]?.[p]||this.constructor.defaultConfig[h.name]?.[p]||b}),this.plugins.set(new h(this))}),this.plugins.init(),this.toolbarDispatcher.dispatch("init"),this.formatbarDispatcher.dispatch("init"),this.rootDispatcher.dispatch("init")}freeze(){Object.freeze(this.config),this.translator.freeze(),this.tags.freeze(),this.filters.freeze(),this.dialogs.freeze(),this.commands.freeze(),this.plugins.freeze()}load(){this.orig instanceof HTMLTextAreaElement?(this.orig.form.addEventListener("submit",()=>this.save()),this.setHtml(this.orig.value.replace("/&nbsp;/g"," "))):this.setHtml(this.orig.innerHTML),this.orig.insertAdjacentElement("afterend",this.element),this.orig.hidden=!0}destroy(){this.element.parentElement.removeChild(this.element),this.orig.hidden=!1}getHtml(){let e=this.dom.createElement(this.root.localName,{html:this.root.innerHTML});return this.filters.filter(e),this.rootDispatcher.dispatch("gethtml",e),e.innerHTML}setHtml(e){let t=this.dom.createElement(this.root.localName,{html:e});this.rootDispatcher.dispatch("sethtml",t),this.filters.filter(t),this.root.innerHTML=t.innerHTML}save(){this.orig instanceof HTMLTextAreaElement?this.orig.value=this.getHtml():this.orig.innerHTML=this.getHtml()}url(e){let t=this.dom.window.origin||this.dom.window.location.origin,i=this.dom.createElement("a",{attributes:{href:e}});return t===i.origin?i.pathname:i.href}static create(e,t={}){let i=new this(e,t);return i.init(),i.freeze(),i.load(),i}};te=new WeakMap,z=new WeakMap,re=new WeakMap,ie=new WeakMap,se=new WeakMap,oe=new WeakMap,ae=new WeakMap,ne=new WeakMap,le=new WeakMap,de=new WeakMap,Oe=new WeakMap,Me=new WeakMap,De=new WeakMap,Se=new WeakMap,Pe=new WeakMap,Ne=new WeakMap;var C=nt;var me,ue,ce,si,lt=class{constructor(e,t){m(this,ce);m(this,me,void 0);m(this,ue,void 0);if(!(e instanceof C)||!t||typeof t!="string")throw"Invalid argument";E(this,me,e),E(this,ue,t)}get editor(){return c(this,me)}get name(){return c(this,ue)}open(e,t={}){let i=this.editor.dom.getRange(),n=()=>{i&&this.editor.dom.setRange(i),f(this,ce,si).call(this)};f(this,ce,si).call(this);let u=this.editor.dom.createElement("form",{attributes:{method:"dialog"}}),h=this.editor.dom.createElement("fieldset"),p=this.editor.dom.createElement("button",{attributes:{type:"button"},html:this._("Cancel")});p.addEventListener("click",n),u.appendChild(h),u.appendChild(p),u.appendChild(this.editor.dom.createElement("button",{html:this._("Save")})),this._initFieldset(h),u.addEventListener("submit",A=>{A.preventDefault(),A.stopPropagation(),n();let w={};Array.from(h.elements).forEach(j=>w[j.name]=j.value),e(w)}),Object.entries(t).forEach(([A,w])=>h.elements[A]&&(h.elements[A].value=w));let b=this.editor.dom.createElement("editor-dialog");b.addEventListener("close",n),b.appendChild(u),b.show(),this.editor.element.appendChild(b)}_(e){return this.editor.translator.translate(this.name,e)}_initFieldset(e){throw"Not implemented"}_createInput(e,t,i,n={}){if(!e||typeof e!="string"||!t||typeof t!="string"||!i||typeof i!="string")throw"Invalid argument";Object.assign(n,{id:`editor-${e}`,name:e,type:t});let u=this.editor.dom.createElement("div");return u.appendChild(this.editor.dom.createElement("label",{attributes:{for:n.id},html:i})),u.appendChild(this.editor.dom.createElement("input",{attributes:n})),n.required&&u.setAttribute("data-required",""),u}};me=new WeakMap,ue=new WeakMap,ce=new WeakSet,si=function(){Array.from(this.editor.element.getElementsByTagName("editor-dialog")).forEach(e=>{e.parentElement.removeChild(e)})};var T=lt;var dt=class extends T{constructor(e){super(e,"abbreviation")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Abbreviation")})),e.appendChild(this._createInput("title","text",this._("Full term"),{placeholder:this._("Insert full term or leave empty to remove it")}))}},oi=dt;var he,mt=class{constructor(e){m(this,he,void 0);if(!(e instanceof C))throw"Invalid argument";E(this,he,e)}get editor(){return c(this,he)}handleEvent(e){typeof this[e.type]=="function"&&this[e.type](e)}};he=new WeakMap;var g=mt;function x(o,e,{alt:t=!1,ctrl:i=!1,shift:n=!1}={}){return(Array.isArray(e)&&e.includes(o.key)||o.key===e)&&o.altKey===t&&o.ctrlKey===i&&o.shiftKey===n}var ut=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-alignable")&&e.detail.element.addEventListener("keydown",this)}keydown(e){let t={[a.UP]:null,[a.LEFT]:"left",[a.DOWN]:"center",[a.RIGHT]:"right"};e.target===e.currentTarget&&x(e,Object.keys(t),{shift:!0})&&(e.preventDefault(),e.stopPropagation(),e.target.classList.remove(...Object.values(t)),t[e.key]&&e.target.classList.add(t[e.key]))}},ai=ut;var ke,Ho,fe,ni,ct=class extends _{constructor(){super(...arguments);m(this,ke);m(this,fe)}filter(e){let t=this.editor.tags.get(e),i=this.editor.tags.allowed(e,"p"),n=t.editable||t.group==="format",u=[],h=(p=null)=>{i&&u.length>0&&(e.insertBefore(this.editor.dom.createElement("p",{html:u.join(" ")}),p),u=[])};Array.from(e.childNodes).forEach(p=>{let b=p.textContent.trim();if(p instanceof HTMLElement){let A=f(this,ke,Ho).call(this,p),w=this.editor.tags.get(A);if(w&&this.editor.tags.allowed(e,A))h(A),f(this,fe,ni).call(this,A,w);else if(w&&w.group==="format"&&i){let j=f(this,fe,ni).call(this,A,w);j&&(u.push(j.outerHTML),e.removeChild(j))}else!n&&b&&i?(u.push(b),e.removeChild(A)):n&&b?e.replaceChild(this.editor.dom.createText(b),A):e.removeChild(A)}else p instanceof Text?(!n&&b&&i&&u.push(b),(!n||!b)&&e.removeChild(p)):p instanceof Node&&e.removeChild(p)}),h()}};ke=new WeakSet,Ho=function(e){let t=this.editor.config.base.filter[e.localName];if(!t)return e;let i=this.editor.dom.createElement(t,{html:e.innerHTML});return e.parentElement.replaceChild(i,e),i},fe=new WeakSet,ni=function(e,t){return Array.from(e.attributes).forEach(i=>!t.attributes.includes(i.name)&&e.removeAttribute(i.name)),e.hasChildNodes()&&this.editor.filters.filter(e),e.hasChildNodes()||t.empty?e:(e.parentElement.removeChild(e),null)};var li=ct;var ht=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-deletable")&&e.detail.element.addEventListener("keydown",this)}keydown(e){e.target===e.currentTarget&&x(e,a.DEL,{ctrl:!0})&&(e.target.previousElementSibling instanceof HTMLElement&&this.editor.dom.focusEnd(e.target.previousElementSibling),e.target.parentElement.removeChild(e.target),e.preventDefault(),e.stopPropagation())}},di=ht;var ft=class extends HTMLElement{get open(){return this.hasAttribute("open")}set open(e){e===!0?this.setAttribute("open",""):this.removeAttribute("open")}constructor(){super();this.addEventListener("keydown",e=>e.key===a.ESC&&this.close()),this.addEventListener("click",e=>e.target===this&&this.close())}connectedCallback(){this.setAttribute("role","dialog"),this.tabIndex=-1,this.focus()}show(){this.open=!0,this.dispatchEvent(new CustomEvent("show",{detail:{element:this,target:this}}))}close(){this.open=!1,this.dispatchEvent(new CustomEvent("close",{detail:{element:this,target:this}}))}},mi=ft;var pt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.contentEditable==="true"&&e.detail.element.addEventListener("keydown",this)}keydown(e){if(x(e,a.ENTER,{shift:!0})&&!this.editor.tags.allowed(e.target,"br"))e.preventDefault(),e.stopPropagation();else if(x(e,a.ENTER)){e.preventDefault(),e.stopPropagation();let t=this.editor.tags.get(e.target)?.enter;t&&(e.target.textContent.trim()||!e.target.hasAttribute("data-deletable")?this.editor.dom.closest(e.target,t)?.insertAdjacentElement("afterend",this.editor.dom.createElement(t)):e.target instanceof HTMLParagraphElement||(this.editor.dom.closest(e.target,"p")?.insertAdjacentElement("afterend",this.editor.dom.createElement("p")),e.target.parentElement.removeChild(e.target)))}else x(e,a.BACKSPACE)&&!e.target.textContent&&e.target.hasAttribute("data-deletable")?(e.target.previousElementSibling instanceof HTMLElement&&this.editor.dom.focusEnd(e.target.previousElementSibling),e.target.parentElement.removeChild(e.target),e.preventDefault(),e.stopPropagation()):/^[A-Z]$/.test(e.key)&&x(e,e.key,{alt:!0,shift:!0})&&(e.preventDefault(),e.stopPropagation(),this.editor.formatbar.querySelector(`button[data-key=${e.key.toLowerCase()}]`)?.click())}},ui=pt;var gt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-focusable")&&e.detail.element.focus()}},ci=gt;var bt=class extends g{insertbutton(e){let t=e.detail.element.getAttribute("data-key");if(t){let i=this.editor.translator.translate(d.name,"Alt"),n=this.editor.translator.translate(d.name,"Shift");e.detail.element.title+=` [${i} + ${n} + ${t}]`}e.detail.element.getAttribute("data-command")&&e.detail.element.addEventListener("click",this),e.detail.element.parentElement===this.editor.toolbar&&(e.detail.element.tabIndex=-1,e.detail.element.addEventListener("keydown",this))}click(e){this.editor.commands.execute(e.target.getAttribute("data-command"))}keydown(e){if(x(e,[a.LEFT,a.RIGHT,a.HOME,a.END])){let t=e.target.previousElementSibling,i=e.target.nextElementSibling,n=e.target.parentElement.firstElementChild,u=e.target.parentElement.lastElementChild,h=e.target===n,p=e.target===u;e.key===a.LEFT&&!h?t.focus():e.key===a.RIGHT&&!p?i.focus():e.key===a.HOME||e.key===a.RIGHT&&p?n.focus():(e.key===a.END||e.key===a.LEFT&&h)&&u.focus(),e.preventDefault(),e.stopPropagation()}}},He=bt;var Et=class extends He{constructor(e){super(e);this.editor.formatbar.addEventListener("insertbutton",this),this.editor.dom.document.addEventListener("selectionchange",this)}selectionchange(){let e=this.editor.dom.getSelectedEditable();if(e&&!this.editor.dom.getSelection().isCollapsed&&this.editor.tags.allowed(e,"format",!0)){let t=e.offsetTop+e.offsetParent.offsetTop-this.editor.formatbar.clientHeight;this.editor.formatbar.style.top=`${t}px`,this.editor.formatbar.hidden=!1}else this.editor.formatbar.hidden=!0,this.editor.formatbar.removeAttribute("style")}},hi=Et;var Fe,Fo,Tt=class extends g{constructor(e){super(e);m(this,Fe);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-navigable")&&(e.detail.element.tabIndex=0,e.detail.element.addEventListener("keydown",this))}keydown(e){if(e.target===e.currentTarget&&x(e,[a.UP,a.DOWN,a.HOME,a.END])&&f(this,Fe,Fo).call(this,e.target)){let t=e.target.previousElementSibling,i=e.target.nextElementSibling,n=e.target.parentElement.firstElementChild,u=e.target.parentElement.lastElementChild,h=e.target===n,p=e.target===u;e.key===a.UP&&!h&&t.hasAttribute("data-navigable")?t.focus():e.key===a.DOWN&&!p&&i.hasAttribute("data-navigable")?i.focus():(e.key===a.HOME||e.key===a.DOWN&&p)&&n.hasAttribute("data-navigable")?n.focus():(e.key===a.END||e.key===a.UP&&h)&&u.hasAttribute("data-navigable")&&u.focus(),e.preventDefault(),e.stopPropagation()}}};Fe=new WeakSet,Fo=function(e){if(e.contentEditable!=="true")return!0;let t=this.editor.dom.getSelection(),i=this.editor.dom.getSelectedEditable(),n=this.editor.dom.getSelectedElement();return t.isCollapsed&&t.anchorOffset===0&&[i,e.firstChild].includes(n)};var fi=Tt;var jt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element instanceof HTMLSlotElement?e.detail.element.addEventListener("keydown",this):e.detail.element.hasAttribute("data-slotable")&&!e.detail.element.querySelector(":scope > slot")&&e.detail.element.appendChild(this.editor.dom.createElement("slot"))}keydown(e){e.preventDefault(),e.stopPropagation()}},pi=jt;var pe,gi,ge,bi,Lt=class extends g{constructor(e){super(e);m(this,pe);m(this,ge);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-sortable")&&(e.detail.element.addEventListener("keydown",this),e.detail.element.addEventListener("pointerdown",this),e.detail.element.addEventListener("pointermove",this),e.detail.element.addEventListener("pointerup",this))}keydown(e){if(e.target===e.currentTarget&&x(e,[a.UP,a.DOWN,a.HOME,a.END],{ctrl:!0})){let t=e.target.parentElement,i=e.target.previousElementSibling,n=e.target.nextElementSibling,u=t.firstElementChild,h=t.lastElementChild,p=e.target===u,b=e.target===h;e.key===a.UP&&!p&&i.hasAttribute("data-sortable")?(i.insertAdjacentHTML("beforebegin",e.target.outerHTML),t.removeChild(e.target)):e.key===a.DOWN&&!b&&n.hasAttribute("data-sortable")?(n.insertAdjacentHTML("afterend",e.target.outerHTML),t.removeChild(e.target)):(e.key===a.HOME&&!p||e.key===a.DOWN&&b)&&u.hasAttribute("data-sortable")?(u.insertAdjacentHTML("beforebegin",e.target.outerHTML),t.removeChild(e.target)):(e.key===a.END&&!b||e.key===a.UP&&p)&&h.hasAttribute("data-sortable")&&(h.insertAdjacentHTML("afterend",e.target.outerHTML),t.removeChild(e.target)),e.preventDefault(),e.stopPropagation()}}pointerdown(e){e.target.hasAttribute("data-sortable")&&(e.target.setAttribute("data-sort",""),e.target.setPointerCapture(e.pointerId))}pointermove(e){let t=this.editor.dom.document.elementFromPoint(e.x,e.y);f(this,pe,gi).call(this),f(this,ge,bi).call(this,e.target,t)&&t.setAttribute("data-sortover","")}pointerup(e){if(e.target.hasAttribute("data-sortable")){let t=this.editor.dom.document.elementFromPoint(e.x,e.y);f(this,pe,gi).call(this),e.target.removeAttribute("data-sort"),e.target.releasePointerCapture(e.pointerId),f(this,ge,bi).call(this,e.target,t)&&t.insertAdjacentElement("beforebegin",e.target)}}};pe=new WeakSet,gi=function(){this.editor.root.querySelectorAll("[data-sortover]").forEach(e=>e.removeAttribute("data-sortover"))},ge=new WeakSet,bi=function(e,t){return e instanceof HTMLElement&&t instanceof HTMLElement&&this.editor.dom.contains(t)&&![this.editor.root,e].includes(t)&&t.hasAttribute("data-sortable")&&(e.parentElement===t.parentElement||this.editor.dom.arbitrary(e.parentElement)&&this.editor.dom.arbitrary(t.parentElement))&&this.editor.tags.allowed(t.parentElement,e)};var Ei=Lt;var xt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){let t=this.editor.tags.get(e.detail.element);t&&(t.editable&&(e.detail.element.contentEditable="true"),["alignable","arbitrary","deletable","focusable","navigable","slotable","sortable"].forEach(i=>{t[i]&&(e.detail.element.dataset[i]="")}))}},Ti=xt;var At=class extends He{constructor(e){super(e);this.editor.toolbar.addEventListener("insertbutton",this)}},ji=At;var Li={de:{Alt:"Alt",Shift:"Umschalt"}};var wt=class extends l{static get name(){return"base"}static get config(){return{browser:{},filter:{},lang:null,plugins:[]}}init(){this._i18n(Li),this.editor.dom.registerElement("editor-dialog",mi),this._tag({name:s.ROOT,group:r.ROOT,children:[r.AUDIO,r.BLOCK,r.CONTAINER,r.FIGURE,r.HEADING,r.IFRAME,r.IMAGE,r.LIST,r.PARAGRAPH,r.PREFORMAT,r.QUOTE,r.RULE,r.TABLE,r.VIDEO]}),this._tag({name:s.SLOT,group:r.SLOT,editable:!0,focusable:!0,navigable:!0,sortable:!0}),new Ti(this.editor),new ji(this.editor),new hi(this.editor),new ui(this.editor),new di(this.editor),new fi(this.editor),new Ei(this.editor),new ai(this.editor),new ci(this.editor),new pi(this.editor),this.editor.filters.add(new li(this.editor))}},d=wt;var xi={de:{Abbreviation:"Abk\xFCrzung",Cancel:"Abbrechen","Full term":"Langform","Insert full term or leave empty to remove it":"Langform eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var _t=class extends l{static get name(){return"abbreviation"}static get dependencies(){return[d]}init(){this._i18n(xi),this._tag({name:s.ABBR,group:r.FORMAT,attributes:["title"]}),this.editor.dialogs.set(new oi(this.editor)),this._command(s.ABBR),this._toolbar("Abbreviation",a.A,!0)}},Ai=_t;var yt=class extends T{constructor(e){super(e,"audio")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Audio")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to audio"),required:"required"}))}},wi=yt;var be,_i,Ct=class extends g{constructor(e){super(e);m(this,be);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertaudio",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("audio")).forEach(t=>f(this,be,_i).call(this,t))}insertaudio(e){f(this,be,_i).call(this,e.detail.element)}};be=new WeakSet,_i=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.controls=!0,this.editor.dom.wrap(e,"figure",{attributes:{class:"audio"}})):e.parentElement.removeChild(e)};var yi=Ct;var Ee,It=class extends T{constructor(e,t,i){super(e,t);m(this,Ee,void 0);if(!i||typeof i!="string")throw"Invalid argument";E(this,Ee,i)}open(e,t={}){this.editor.dom.open({url:c(this,Ee),name:this.name,call:e,params:t})}};Ee=new WeakMap;var R=It;var Bt=class extends _{filter(e){e.querySelectorAll("figure > figcaption:only-child").forEach(t=>t.parentElement.removeChild(t))}},Ci=Bt;var Rt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertfigure",this)}insertfigure(e){e.detail.element.querySelector(":scope > figcaption")||e.detail.element.appendChild(this.editor.dom.createElement("figcaption"))}},Ii=Rt;var Ot=class extends l{static get name(){return"figure"}static get dependencies(){return[d]}init(){this._tag({name:s.FIGURE,group:r.FIGURE,children:[r.AUDIO,r.CAPTION,r.IFRAME,r.IMAGE,r.PREFORMAT,r.QUOTE,r.TABLE,r.VIDEO],attributes:["class"],alignable:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._tag({name:s.FIGCAPTION,group:r.CAPTION,children:[r.FORMAT],editable:!0,navigable:!0,enter:s.P}),new Ii(this.editor),this.editor.filters.add(new Ci(this.editor))}},I=Ot;var Bi={de:{Audio:"Audio",Cancel:"Abbrechen","Insert URL to audio":"URL zur Audiodatei eingeben",Save:"Speichern",URL:"URL"}};var Mt=class extends l{static get name(){return"audio"}static get dependencies(){return[d,I]}static get config(){return{browser:null}}init(){this._i18n(Bi),this._tag({name:s.AUDIO,group:r.AUDIO,attributes:["controls","src"],empty:!0,navigable:!0}),new yi(this.editor);let e=this.editor.config.audio.browser;e?this.editor.dialogs.set(new R(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new wi(this.editor)),this._command(s.AUDIO),this._toolbar("Audio")}},Ri=Mt;var Dt=class extends T{constructor(e){super(e,"block")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Block")})),e.appendChild(this._createInput("id","text",this._("ID"),{required:"required"}))}},Oi=Dt;var St=class extends HTMLElement{get content(){return this.shadowRoot.innerHTML}set content(e){this.shadowRoot.innerHTML=e}constructor(){super();this.attachShadow({mode:"open"})}},Mi=St;var Pt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertappblock",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("app-block")).forEach(t=>t.id||t.parentElement.removeChild(t))}async insertappblock(e){if(!e.detail.element.id){e.detail.element.parentElement.removeChild(e.detail.element);return}if(!this.editor.config.block.api)return;let t=this.editor.config.block.api.replace("{id}",e.detail.element.id),i=await fetch(t,{mode:"no-cors"});if(!i.ok)return;let n="";this.editor.config.block.css&&(n=this.editor.config.block.css.split(",").map(h=>`<link rel="stylesheet" href="${h}">`).join(""));let u=await i.text();e.detail.element.content=n+u}},Di=Pt;var Ue={de:{Cancel:"Abbrechen",Height:"H\xF6he",Ifrane:"Iframe","Insert URL to embedded page":"URL zur eingebetteten Seite eingeben",Save:"Speichern",URL:"URL",Width:"Breite"}};var Nt=class extends l{static get name(){return"block"}static get dependencies(){return[d]}static get config(){return{api:null,browser:null,css:null}}init(){this._i18n(Ue),this.editor.dom.registerElement(s.BLOCK,Mi),this._tag({name:s.BLOCK,group:r.BLOCK,attributes:["id"],deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),new Di(this.editor);let e=this.editor.config.block.browser;e?this.editor.dialogs.set(new R(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new Oi(this.editor)),this._command(s.BLOCK),this._toolbar("Block")}},Si=Nt;var kt=class extends _{filter(e){e instanceof HTMLElement&&e.localName==="figure"&&e.classList.contains("quote")&&e.querySelector(":scope > blockquote")&&!e.querySelector(":scope > figcaption")&&(e.insertAdjacentElement("beforebegin",e.querySelector(":scope > blockquote")),e.innerHTML="")}},Pi=kt;var Ht=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertblockquote",this),this.editor.root.addEventListener("deleteblockquote",this)}insertblockquote(e){this.editor.dom.wrap(e.detail.element,"figure",{attributes:{class:"quote"}})}deleteblockquote(e){e.detail.target.localName==="figure"&&e.detail.target.classList.contains("quote")&&e.detail.target.parentElement.removeChild(e.detail.target)}},Ni=Ht;var Ft=class extends _{filter(e){if(e instanceof HTMLPreElement){e.outerHTML=e.outerHTML.replace(/(<br\s*\/?>)/gi,`
`);return}e.innerHTML=e.innerHTML.replace(/^\s*(<br\s*\/?>\s*)+/gi,"").replace(/\s*(<br\s*\/?>\s*)+$/gi,""),e instanceof HTMLParagraphElement?e.outerHTML=e.outerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"</p><p>"):e.innerHTML=e.innerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"<br>")}},ki=Ft;var Ut=class extends l{static get name(){return"break"}static get dependencies(){return[d]}init(){this._tag({name:s.BR,group:r.BREAK,empty:!0}),this.editor.filters.add(new ki(this.editor))}},O=Ut;var Hi={de:{"Block Quote":"Blockzitat"}};var Gt=class extends l{static get name(){return"blockquote"}static get dependencies(){return[d,O,I]}init(){this._i18n(Hi),this._tag({name:s.BLOCKQUOTE,group:r.QUOTE,children:[r.BREAK,r.FORMAT],deletable:!0,editable:!0,navigable:!0,enter:s.P}),new Ni(this.editor),this._command(s.BLOCKQUOTE),this._toolbar("Block Quote"),this.editor.filters.add(new Pi(this.editor))}},Fi=Gt;var Ui={de:{bold:"fett"}};var vt=class extends l{static get name(){return"bold"}static get dependencies(){return[d]}init(){this._i18n(Ui),this._tag({name:s.B,group:r.FORMAT}),this._command(s.B),this._toolbar("bold",a.B,!0)}},Gi=vt;var vi={de:{Citation:"Zitatquelle"}};var Kt=class extends l{static get name(){return"cite"}static get dependencies(){return[d]}init(){this._i18n(vi),this._tag({name:s.CITE,group:r.FORMAT}),this._command(s.CITE),this._toolbar("Citation",a.Z,!0)}},Ki=Kt;var zi={de:{Code:"Quelltext"}};var zt=class extends l{static get name(){return"code"}static get dependencies(){return[d]}init(){this._i18n(zi),this._tag({name:s.CODE,group:r.FORMAT}),this._command(s.CODE),this._toolbar("Code",a.C,!0)}},qi=zt;var qt=class extends T{constructor(e){super(e,"data")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Data")})),e.appendChild(this._createInput("value","text",this._("Machine-readable Value"),{placeholder:this._("Insert value or leave empty to remove it")}))}},Vi=qt;var Wi={de:{Cancel:"Abbrechen",Data:"Data","Machine-readable Value":"Maschinenlesbarer Wert","Insert value or leave empty to remove it":"Wert eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var Vt=class extends l{static get name(){return"data"}static get dependencies(){return[d]}init(){this._i18n(Wi),this._tag({name:s.DATA,group:r.FORMAT,attributes:["value"]}),this.editor.dialogs.set(new Vi(this.editor)),this._command(s.DATA),this._toolbar("Data",a.J,!0)}},Qi=Vt;var $i={de:{Definition:"Definition"}};var Wt=class extends l{static get name(){return"definition"}static get dependencies(){return[d]}init(){this._i18n($i),this._tag({name:s.DFN,group:r.FORMAT}),this._command(s.DFN),this._toolbar("Definition",a.D,!0)}},Yi=Wt;var Zi={de:{"Text Deletion":"Textl\xF6schung"}};var Qt=class extends l{static get name(){return"deletion"}static get dependencies(){return[d]}init(){this._i18n(Zi),this._tag({name:s.DEL,group:r.FORMAT}),this._command(s.DEL),this._toolbar("Text Deletion",a.G,!0)}},Ji=Qt;var $t=class extends _{filter(e){e.querySelectorAll("summary:not(:first-child)").forEach(t=>t.parentElement.removeChild(t)),e.querySelectorAll("summary:only-child").forEach(t=>t.parentElement.removeChild(t))}},Xi=$t;var Te,es,Yt=class extends g{constructor(e){super(e);m(this,Te);this.editor.root.addEventListener("insertdetails",this),this.editor.root.addEventListener("insertsummary",this)}insertdetails(e){e.detail.element.open=!0,e.detail.element.querySelector(":scope > summary:first-child")||e.detail.element.insertAdjacentElement("afterbegin",this.editor.dom.createElement("summary"))}insertsummary(e){f(this,Te,es).call(this,e.detail.element),e.detail.element.addEventListener("blur",this),e.detail.element.addEventListener("keydown",this)}blur(e){f(this,Te,es).call(this,e.target)}keydown(e){x(e,a.SPACE)?(e.preventDefault(),e.stopPropagation(),this.editor.dom.insertText(" ")):x(e,a.ENTER)&&(e.preventDefault(),e.stopPropagation(),e.target.parentElement.open=!0)}};Te=new WeakSet,es=function(e){e.textContent.trim()?e.querySelectorAll("br:not(:last-child)").forEach(t=>t.parentElement.removeChild(t)):e.textContent=this.editor.translator.translate(Ge.name,"Details"),e.lastElementChild instanceof HTMLBRElement||e.appendChild(this.editor.dom.createElement("br"))};var ts=Yt;var rs={de:{Details:"Details"}};var Zt=class extends l{static get name(){return"details"}static get dependencies(){return[d]}init(){this._i18n(rs),this._tag({name:s.DETAILS,group:r.CONTAINER,children:[r.AUDIO,r.FIGURE,r.IFRAME,r.IMAGE,r.LIST,r.PARAGRAPH,r.PREFORMAT,r.QUOTE,r.RULE,r.SUMMARY,r.TABLE,r.VIDEO],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._tag({name:s.SUMMARY,group:r.SUMMARY,editable:!0,navigable:!0,enter:s.P}),new ts(this.editor),this._command(s.DETAILS),this._toolbar("Details"),this.editor.filters.add(new Xi(this.editor))}},Ge=Zt;var Jt=class extends T{constructor(e){super(e,"division")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Division")})),e.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}},is=Jt;var ss={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse",Division:"Division","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern"}};var Xt=class extends l{static get name(){return"division"}static get dependencies(){return[d]}init(){this._i18n(ss),this._tag({name:s.DIV,group:r.CONTAINER,children:[r.AUDIO,r.BLOCK,r.FIGURE,r.IFRAME,r.IMAGE,r.PREFORMAT,r.QUOTE,r.RULE,r.TABLE,r.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new is(this.editor)),this._command(s.DIV),this._toolbar("Division")}},os=Xt;var as={de:{emphasized:"betont"}};var er=class extends l{static get name(){return"emphasis"}static get dependencies(){return[d]}init(){this._i18n(as),this._tag({name:s.EM,group:r.FORMAT}),this._command(s.EM),this._toolbar("emphasized",a.E,!0)}},ns=er;var ls={de:{Heading:"\xDCberschrift"}};var tr=class extends l{static get name(){return"heading"}static get dependencies(){return[d]}init(){this._i18n(ls),this._tag({name:s.H2,group:r.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:s.P}),this._command(s.H2),this._toolbar("Heading")}},ds=tr;var ms={de:{"Horizontal Rule":"Horizontale Linie"}};var rr=class extends l{static get name(){return"horizontalrule"}static get dependencies(){return[d]}init(){this._i18n(ms),this._tag({name:s.HR,group:r.RULE,deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(s.HR),this._toolbar("Horizontal Rule")}},us=rr;var ir=class extends T{constructor(e){super(e,"iframe")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Iframe")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to embedded page"),required:"required"})),e.appendChild(this._createInput("width","number",this._("Width"))),e.appendChild(this._createInput("height","number",this._("Height")))}},cs=ir;var je,hs,sr=class extends g{constructor(e){super(e);m(this,je);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertiframe",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("iframe")).forEach(t=>f(this,je,hs).call(this,t))}insertiframe(e){f(this,je,hs).call(this,e.detail.element)}};je=new WeakSet,hs=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.allowFullscreen=!0,this.editor.dom.wrap(e,"figure",{attributes:{class:"iframe"}})):e.parentElement.removeChild(e)};var fs=sr;var or=class extends l{static get name(){return"iframe"}static get dependencies(){return[d,I]}static get config(){return{browser:null}}init(){this._i18n(Ue),this._tag({name:s.IFRAME,group:r.IFRAME,attributes:["allowfullscreen","height","src","width"],empty:!0,navigable:!0}),new fs(this.editor);let e=this.editor.config.iframe.browser;e?this.editor.dialogs.set(new R(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new cs(this.editor)),this._command(s.IFRAME),this._toolbar("Iframe")}},ps=or;var ar=class extends T{constructor(e){super(e,"image")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Image")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to image"),required:"required"})),e.appendChild(this._createInput("alt","text",this._("Alternative text"),{placeholder:this._("Text shown when media element is not available")})),e.appendChild(this._createInput("width","number",this._("Width"))),e.appendChild(this._createInput("height","number",this._("Height")))}},gs=ar;var Le,bs,nr=class extends g{constructor(e){super(e);m(this,Le);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertimg",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("img")).forEach(t=>f(this,Le,bs).call(this,t))}insertimg(e){f(this,Le,bs).call(this,e.detail.element)}};Le=new WeakSet,bs=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),this.editor.dom.wrap(e,"figure",{attributes:{class:"image"}})):e.parentElement.removeChild(e)};var Es=nr;var Ts={de:{"Alternative text":"Alternativtext",Cancel:"Abbrechen",Height:"H\xF6he",Image:"Bild","Insert URL to image":"URL zur Bilddatei eingeben",Save:"Speichern","Text shown when media element is not available":"Ersatztext, falls Medienelement nicht verf\xFCgbar ist",URL:"URL",Width:"Breite"}};var lr=class extends l{static get name(){return"image"}static get dependencies(){return[d,I]}static get config(){return{browser:null}}init(){this._i18n(Ts),this._tag({name:s.IMG,group:r.IMAGE,attributes:["alt","height","src","width"],empty:!0,navigable:!0}),new Es(this.editor);let e=this.editor.config.image.browser;e?this.editor.dialogs.set(new R(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new gs(this.editor)),this._command(s.IMG),this._toolbar("Image")}},js=lr;var Ls={de:{"Text Insertion":"Texteinf\xFCgung"}};var dr=class extends l{static get name(){return"insertion"}static get dependencies(){return[d]}init(){this._i18n(Ls),this._tag({name:s.INS,group:r.FORMAT}),this._command(s.INS),this._toolbar("Text Insertion",a.F,!0)}},xs=dr;var As={de:{italic:"kursiv"}};var mr=class extends l{static get name(){return"italic"}static get dependencies(){return[d]}init(){this._i18n(As),this._tag({name:s.I,group:r.FORMAT}),this._command(s.I),this._toolbar("italic",a.I,!0)}},ws=mr;var _s={de:{"User Input":"Benutzereingabe"}};var ur=class extends l{static get name(){return"keyboard"}static get dependencies(){return[d]}init(){this._i18n(_s),this._tag({name:s.KBD,group:r.FORMAT}),this._command(s.KBD),this._toolbar("User Input",a.K,!0)}},ys=ur;var cr=class extends T{constructor(e){super(e,"link")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Link")})),e.appendChild(this._createInput("href","text",this._("URL"),{pattern:"(https?|/|mailto:|tel:).+",placeholder:this._("Insert link or leave empty to unlink")}))}},Cs=cr;var xe,Is,hr=class extends g{constructor(e){super(e);m(this,xe);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("inserta",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("a")).forEach(t=>f(this,xe,Is).call(this,t))}inserta(e){f(this,xe,Is).call(this,e.detail.element)}};xe=new WeakSet,Is=function(e){let t=e.getAttribute("href");t?e.setAttribute("href",this.editor.url(t)):e.parentElement.replaceChild(this.editor.dom.createText(e.textContent),e)};var Bs=hr;var Rs={de:{Cancel:"Abbrechen","Insert link or leave empty to unlink":"Link eingeben oder zum Entfernen leer lassen",Link:"Link",Save:"Speichern",URL:"URL"}};var fr=class extends l{static get name(){return"link"}static get dependencies(){return[d]}init(){this._i18n(Rs),this._tag({name:s.A,group:r.FORMAT,attributes:["href"]}),new Bs(this.editor),this.editor.dialogs.set(new Cs(this.editor)),this._command(s.A),this._toolbar("Link",a.L,!0)}},Os=fr;var Ms={de:{mark:"markiert"}};var pr=class extends l{static get name(){return"mark"}static get dependencies(){return[d]}init(){this._i18n(Ms),this._tag({name:s.MARK,group:r.FORMAT}),this._command(s.MARK),this._toolbar("mark",a.M,!0)}},Ds=pr;var Ae,Ss,gr=class extends g{constructor(e){super(e);m(this,Ae);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertli",this),this.editor.root.addEventListener("deleteli",this),this.editor.root.addEventListener("insertol",this),this.editor.root.addEventListener("insertul",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("li")).forEach(t=>f(this,Ae,Ss).call(this,t))}insertli(e){f(this,Ae,Ss).call(this,e.detail.element)}deleteli(e){e.detail.target.children.length===0&&e.detail.target.parentElement.removeChild(e.detail.target)}insertol(e){e.detail.element.children.length===0&&e.detail.element.appendChild(this.editor.dom.createElement("li"))}insertul(e){this.insertol(e)}};Ae=new WeakSet,Ss=function(e){!(e.parentElement instanceof HTMLOListElement)&&!(e.parentElement instanceof HTMLUListElement)&&this.editor.dom.wrap(e,"ul")};var Ps=gr;var br=class extends l{static get name(){return"list"}static get dependencies(){return[d,O]}init(){this._tag({name:s.LI,group:r.LISTITEM,children:[r.BREAK,r.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:s.LI}),new Ps(this.editor)}},ve=br;var Ns={de:{"Ordered List":"Geordnete Liste"}};var Er=class extends l{static get name(){return"orderedlist"}static get dependencies(){return[d,ve]}init(){this._i18n(Ns),this._tag({name:s.OL,group:r.LIST,children:[r.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(s.OL),this._toolbar("Ordered List")}},ks=Er;var we,Hs,Tr=class extends g{constructor(e){super(e);m(this,we);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertp",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("p")).forEach(t=>f(this,we,Hs).call(this,t))}insertp(e){f(this,we,Hs).call(this,e.detail.element)}paste(e){this.editor.dom.window.setTimeout(()=>this.editor.filters.filter(e.target))}};we=new WeakSet,Hs=function(e){e.addEventListener("paste",this)};var Fs=Tr;var Us={de:{Paragraph:"Absatz"}};var jr=class extends l{static get name(){return"paragraph"}static get dependencies(){return[d,O]}init(){this._i18n(Us),this._tag({name:s.P,group:r.PARAGRAPH,children:[r.BREAK,r.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:s.P}),new Fs(this.editor),this._command(s.P),this._toolbar("Paragraph")}},Gs=jr;var Lr=class extends _{filter(e){e instanceof HTMLElement&&e.localName==="figure"&&e.classList.contains("preformat")&&e.querySelector(":scope > pre")&&!e.querySelector(":scope > figcaption")&&(e.insertAdjacentElement("beforebegin",e.querySelector(":scope > pre")),e.innerHTML="")}},vs=Lr;var xr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertpre",this),this.editor.root.addEventListener("deletepre",this)}insertpre(e){this.editor.dom.wrap(e.detail.element,"figure",{attributes:{class:"preformat"}})}deletepre(e){e.detail.target.localName==="figure"&&e.detail.target.classList.contains("preformat")&&e.detail.target.parentElement.removeChild(e.detail.target)}},Ks=xr;var zs={de:{"Preformatted Text":"Vorformatierter Text"}};var Ar=class extends l{static get name(){return"preformat"}static get dependencies(){return[d,O,I]}init(){this._i18n(zs),this._tag({name:s.PRE,group:r.PREFORMAT,children:[r.BREAK],deletable:!0,editable:!0,navigable:!0,enter:s.P}),new Ks(this.editor),this._command(s.PRE),this._toolbar("Preformatted Text"),this.editor.filters.add(new vs(this.editor))}},qs=Ar;var Vs={de:{Quote:"Zitat"}};var wr=class extends l{static get name(){return"quote"}static get dependencies(){return[d]}init(){this._i18n(Vs),this._tag({name:s.Q,group:r.FORMAT}),this._command(s.Q),this._toolbar("Quote",a.Q,!0)}},Ws=wr;var Qs={de:{"Sample Output":"Beispielausgabe"}};var _r=class extends l{static get name(){return"sample"}static get dependencies(){return[d]}init(){this._i18n(Qs),this._tag({name:s.SAMP,group:r.FORMAT}),this._command(s.SAMP),this._toolbar("Sample Output",a.O,!0)}},$s=_r;var yr=class extends T{constructor(e){super(e,"section")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Section")})),e.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}},Ys=yr;var Zs={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern",Section:"Sektion"}};var Cr=class extends l{static get name(){return"section"}static get dependencies(){return[d]}init(){this._i18n(Zs),this._tag({name:s.SECTION,group:r.CONTAINER,children:[r.AUDIO,r.FIGURE,r.HEADING,r.IFRAME,r.IMAGE,r.LIST,r.PARAGRAPH,r.PREFORMAT,r.QUOTE,r.RULE,r.TABLE,r.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new Ys(this.editor)),this._command(s.SECTION),this._toolbar("Section")}},Js=Cr;var Xs={de:{small:"klein"}};var Ir=class extends l{static get name(){return"small"}static get dependencies(){return[d]}init(){this._i18n(Xs),this._tag({name:s.SMALL,group:r.FORMAT}),this._command(s.SMALL),this._toolbar("small",a.W,!0)}},eo=Ir;var to={de:{strikethrough:"durchgestrichen"}};var Br=class extends l{static get name(){return"strikethrough"}static get dependencies(){return[d]}init(){this._i18n(to),this._tag({name:s.S,group:r.FORMAT}),this._command(s.S),this._toolbar("strikethrough",a.R,!0)}},ro=Br;var io={de:{"strongly emphasized":"stark betont"}};var Rr=class extends l{static get name(){return"strong"}static get dependencies(){return[d]}init(){this._i18n(io),this._tag({name:s.STRONG,group:r.FORMAT}),this._command(s.STRONG),this._toolbar("strongly emphasized",a.S,!0)}},so=Rr;var oo={de:{Subheading:"Unter\xFCberschrift"}};var Or=class extends l{static get name(){return"subheading"}static get dependencies(){return[d]}init(){this._i18n(oo),this._tag({name:s.H3,group:r.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:s.P}),this._command(s.H3),this._toolbar("Subheading")}},ao=Or;var no={de:{subscript:"tiefgestellt"}};var Mr=class extends l{static get name(){return"subscript"}static get dependencies(){return[d]}init(){this._i18n(no),this._tag({name:s.SUB,group:r.FORMAT}),this._command(s.SUB),this._toolbar("subscript",a.X,!0)}},lo=Mr;var mo={de:{superscript:"hochgestellt"}};var Dr=class extends l{static get name(){return"superscript"}static get dependencies(){return[d]}init(){this._i18n(mo),this._tag({name:s.SUP,group:r.FORMAT}),this._command(s.SUP),this._toolbar("superscript",a.Y,!0)}},uo=Dr;var Sr=class extends G{constructor(e){super(e,"table","table")}_insert({rows:e=1,cols:t=1}={}){let i=this.editor.dom.createElement("figure",{attributes:{class:"table"}}),n=this.editor.dom.createElement("table"),u=this.editor.dom.createElement("tbody");for(let h=0;h<e;h++){let p=this.editor.dom.createElement("tr");u.appendChild(p);for(let b=0;b<t;++b)p.appendChild(this.editor.dom.createElement("td"))}n.appendChild(u),i.appendChild(n),this.editor.dom.insert(i)}},co=Sr;var Pr=class extends T{constructor(e){super(e,"table")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Table")})),e.appendChild(this._createInput("rows","number",this._("Rows"),{min:"1",required:"required",value:"1"})),e.appendChild(this._createInput("cols","number",this._("Columns"),{min:"1",required:"required",value:"1"}))}},ho=Pr;var Nr=class extends _{filter(e){e instanceof HTMLElement&&e.localName==="figure"&&e.classList.contains("table")&&e.querySelector(":scope > table")&&!e.querySelector(":scope > figcaption")?(e.insertAdjacentElement("beforebegin",e.querySelector(":scope > table")),e.innerHTML=""):(e instanceof HTMLTableElement&&e.querySelector(":scope > thead, :scope > tfoot")&&!e.querySelector(":scope > tbody")||e instanceof HTMLTableSectionElement&&e.rows.length<=0||e instanceof HTMLTableRowElement&&!e.querySelector(":scope > th:not(:empty), :scope > td:not(:empty)"))&&(e.innerHTML="")}},fo=Nr;var F,Ke,q,Hr,ze,Uo,kr=class extends g{constructor(e){super(e);m(this,F);m(this,q);m(this,ze);this.editor.root.addEventListener("inserttable",this),this.editor.root.addEventListener("inserttd",this),this.editor.root.addEventListener("insertth",this)}inserttable(e){this.editor.dom.wrap(e.detail.element,"figure",{attributes:{class:"table"}}),e.detail.element.tBodies.length>0&&e.detail.element.tBodies[0].rows[0]&&(!e.detail.element.tHead||!e.detail.element.tFoot)&&(e.detail.element.tHead||f(this,F,Ke).call(this,e.detail.element.createTHead(),e.detail.element.tBodies[0].rows[0].cells.length),e.detail.element.tFoot||f(this,F,Ke).call(this,e.detail.element.createTFoot(),e.detail.element.tBodies[0].rows[0].cells.length))}inserttd(e){e.detail.element.addEventListener("keydown",this)}insertth(e){e.detail.element.addEventListener("keydown",this)}keydown(e){let t=e.target,i=t.parentElement,n=i.parentElement,u=n instanceof HTMLTableElement?n:n.parentElement,h=[a.LEFT,a.RIGHT,a.UP,a.DOWN],p=x(e,h),b=x(e,h,{ctrl:!0}),A=x(e,h,{alt:!0}),w=x(e,h,{alt:!0,shift:!0});if(t instanceof HTMLTableCellElement&&i instanceof HTMLTableRowElement&&(n instanceof HTMLTableElement||n instanceof HTMLTableSectionElement)&&u instanceof HTMLTableElement&&(p&&f(this,ze,Uo).call(this,t,e.key)||b||A||w)){let j=t.cellIndex,M=i.cells.length,U=n.rows.length,B=n instanceof HTMLTableElement?i.rowIndex:i.sectionRowIndex,qe=j===0,Ve=j===M-1,Mo=B===0,Do=B===U-1,$r=i.rowIndex===0,Yr=i.rowIndex===u.rows.length-1;e.preventDefault(),e.stopPropagation(),p?e.key===a.LEFT&&!qe?this.editor.dom.focusEnd(i.cells[j-1]):e.key===a.LEFT&&$r?this.editor.dom.focusEnd(u.rows[u.rows.length-1].cells[M-1]):e.key===a.LEFT?this.editor.dom.focusEnd(u.rows[i.rowIndex-1].cells[M-1]):e.key===a.RIGHT&&!Ve?i.cells[j+1].focus():e.key===a.RIGHT&&Yr?u.rows[0].cells[0].focus():e.key===a.RIGHT?u.rows[i.rowIndex+1].cells[0].focus():e.key===a.UP&&$r?u.rows[u.rows.length-1].cells[j].focus():e.key===a.UP?u.rows[i.rowIndex-1].cells[j].focus():e.key===a.DOWN&&Yr?u.rows[0].cells[j].focus():e.key===a.DOWN&&u.rows[i.rowIndex+1].cells[j].focus():b?(e.key===a.LEFT&&M>1&&qe?Array.from(u.rows).forEach(L=>L.appendChild(L.cells[j])):e.key===a.LEFT&&M>1?Array.from(u.rows).forEach(L=>L.insertBefore(L.cells[j],L.cells[j-1])):e.key===a.RIGHT&&M>1&&Ve?Array.from(u.rows).forEach(L=>L.insertBefore(L.cells[j],L.cells[0])):e.key===a.RIGHT&&M>1?Array.from(u.rows).forEach(L=>L.insertBefore(L.cells[j+1],L.cells[j])):e.key===a.UP&&U>1&&Mo?n.appendChild(i):e.key===a.UP&&U>1?n.insertBefore(i,n.rows[B-1]):e.key===a.DOWN&&U>1&&Do?n.insertBefore(i,n.rows[0]):e.key===a.DOWN&&U>1&&n.insertBefore(n.rows[B+1],i),t.focus()):A?e.key===a.LEFT?Array.from(u.rows).forEach(L=>f(this,q,Hr).call(this,L,L.cells[j])):e.key===a.RIGHT?Array.from(u.rows).forEach(L=>f(this,q,Hr).call(this,L,L.cells[j+1])):e.key===a.UP?f(this,F,Ke).call(this,n,M,B):e.key===a.DOWN&&f(this,F,Ke).call(this,n,M,B+1):w&&(e.key===a.LEFT&&!qe?Array.from(u.rows).forEach(L=>L.deleteCell(j-1)):e.key===a.RIGHT&&!Ve?Array.from(u.rows).forEach(L=>L.deleteCell(j+1)):e.key===a.UP&&B>0?n.deleteRow(B-1):e.key===a.DOWN&&B<U-1&&n.deleteRow(B+1))}}};F=new WeakSet,Ke=function(e,t,i=0){let n=e.insertRow(i);for(let u=0;u<t;u++)f(this,q,Hr).call(this,n)},q=new WeakSet,Hr=function(e,t=null){let i=e.parentElement.localName==="thead"?"th":"td";e.insertBefore(this.editor.dom.createElement(i),t)},ze=new WeakSet,Uo=function(e,t){if([a.UP,a.DOWN].includes(t))return!0;let i=this.editor.dom.getSelection(),n=i.anchorNode instanceof HTMLElement&&i.anchorNode;if(!i.isCollapsed)return!1;if(t===a.LEFT){let h=e.firstChild;return h instanceof HTMLElement&&(h=h.firstChild),i.anchorOffset===0&&[e,h].includes(n)}let u=e.lastChild;return e.lastChild instanceof HTMLBRElement&&e.lastChild.previousSibling&&(u=e.lastChild.previousSibling),u instanceof HTMLElement&&(u=u.lastChild),i.anchorOffset===n.textContent.length&&[e,u].includes(n)};var po=kr;var go={de:{Cancel:"Abbrechen",Columns:"Spalten",Rows:"Zeilen",Save:"Speichern",Table:"Tabelle"}};var Fr=class extends l{static get name(){return"table"}static get dependencies(){return[d,O,I]}init(){this._i18n(go),this._tag({name:s.TABLE,group:r.TABLE,children:[r.TABLESECTION],deletable:!0,navigable:!0}),this._tag({name:s.THEAD,group:r.TABLESECTION,children:[r.TABLEROW]}),this._tag({name:s.TBODY,group:r.TABLESECTION,children:[r.TABLEROW]}),this._tag({name:s.TFOOT,group:r.TABLESECTION,children:[r.TABLEROW]}),this._tag({name:s.TR,group:r.TABLEROW,children:[r.TABLECELL]}),this._tag({name:s.TH,group:r.TABLECELL,children:[r.BREAK,r.FORMAT],editable:!0,empty:!0}),this._tag({name:s.TD,group:r.TABLECELL,children:[r.BREAK,r.FORMAT],editable:!0,empty:!0}),new po(this.editor),this.editor.filters.add(new fo(this.editor)),this.editor.dialogs.set(new ho(this.editor)),this.editor.commands.set(new co(this.editor)),this._toolbar("Table")}},bo=Fr;var Ur=class extends T{constructor(e){super(e,"time")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Time")})),e.appendChild(this._createInput("datetime","text",this._("Machine-readable Datetime"),{placeholder:this._("Insert date/time or leave empty to remove it")}))}},Eo=Ur;var To={de:{Cancel:"Abbrechen","Insert date/time or leave empty to remove it":"Datum/Zeit eingeben oder zum Entfernen leer lassen","Machine-readable Datetime":"Maschinenlesbare Datums-/Zeitangabe",Save:"Speichern",Time:"Zeit"}};var Gr=class extends l{static get name(){return"time"}static get dependencies(){return[d]}init(){this._i18n(To),this._tag({name:s.TIME,group:r.FORMAT,attributes:["datetime"]}),this.editor.dialogs.set(new Eo(this.editor)),this._command(s.TIME),this._toolbar("Time",a.T,!0)}},jo=Gr;var Lo={de:{underline:"unterstrichen"}};var vr=class extends l{static get name(){return"underline"}static get dependencies(){return[d]}init(){this._i18n(Lo),this._tag({name:s.U,group:r.FORMAT}),this._command(s.U),this._toolbar("underline",a.U,!0)}},xo=vr;var Ao={de:{"Unordered List":"Ungeordnete Liste"}};var Kr=class extends l{static get name(){return"unorderedlist"}static get dependencies(){return[d,ve]}init(){this._i18n(Ao),this._tag({name:s.UL,group:r.LIST,children:[r.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(s.UL),this._toolbar("Unordered List")}},wo=Kr;var _o={de:{Variable:"Variable"}};var zr=class extends l{static get name(){return"variable"}static get dependencies(){return[d]}init(){this._i18n(_o),this._tag({name:s.VAR,group:r.FORMAT}),this._command(s.VAR),this._toolbar("Variable",a.V,!0)}},yo=zr;var qr=class extends T{constructor(e){super(e,"video")}_initFieldset(e){e.appendChild(this.editor.dom.createElement("legend",{html:this._("Video")})),e.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to video"),required:"required"})),e.appendChild(this._createInput("width","number",this._("Width"))),e.appendChild(this._createInput("height","number",this._("Height")))}},Co=qr;var _e,Io,Vr=class extends g{constructor(e){super(e);m(this,_e);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertvideo",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName("video")).forEach(t=>f(this,_e,Io).call(this,t))}insertvideo(e){f(this,_e,Io).call(this,e.detail.element)}};_e=new WeakSet,Io=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.controls=!0,this.editor.dom.wrap(e,"figure",{attributes:{class:"video"}})):e.parentElement.removeChild(e)};var Bo=Vr;var Ro={de:{Cancel:"Abbrechen",Height:"H\xF6he","Insert URL to video":"URL zur Videodatei eingeben",Save:"Speichern",URL:"URL",Video:"Video",Width:"Breite"}};var Wr=class extends l{static get name(){return"video"}static get dependencies(){return[d,I]}static get config(){return{browser:null}}init(){this._i18n(Ro),this._tag({name:s.VIDEO,group:r.VIDEO,attributes:["controls","height","src","width"],empty:!0,navigable:!0}),new Bo(this.editor);let e=this.editor.config.video.browser;e?this.editor.dialogs.set(new R(this.editor,this.constructor.name,e)):this.editor.dialogs.set(new Co(this.editor)),this._command(s.VIDEO),this._toolbar("Video")}},Oo=Wr;var Qr=class extends C{static get defaultConfig(){return{base:{plugins:[Gi,ws,so,ns,xo,ro,Os,Ds,eo,Yi,Ai,Ws,Ki,qi,ys,$s,yo,lo,uo,jo,Qi,xs,Ji,Gs,ds,ao,wo,ks,us,Fi,js,Oo,Ri,ps,bo,qs,Js,Ge,os,Si]}}}},gp=Qr;export{gp as default};
