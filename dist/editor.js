var ua=Object.defineProperty;var ha=(o,e,t)=>e in o?ua(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var w=(o,e,t)=>(ha(o,typeof e!="symbol"?e+"":e,t),t),wt=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var m=(o,e,t)=>(wt(o,e,"read from private field"),t?t.call(o):e.get(o)),l=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},b=(o,e,t,s)=>(wt(o,e,"write to private field"),s?s.call(o,t):e.set(o,t),t);var c=(o,e,t)=>(wt(o,e,"access private method"),t);var O=Object.freeze({CENTER:"center",LEFT:"left",NONE:"none",RIGHT:"right"}),p=Object.freeze({INVALID_ARGUMENT:"Invalid argument",MISSING_NAME:"Missing name",NOT_IMPLEMENTED:"Not implemented"}),a=Object.freeze({A:"a",B:"b",BACKSPACE:"Backspace",C:"c",D:"d",DEL:"Delete",DOWN:"ArrowDown",E:"e",END:"End",ENTER:"Enter",ESC:"Escape",F:"f",G:"g",HOME:"Home",I:"i",J:"j",K:"k",L:"l",LEFT:"ArrowLeft",M:"m",O:"o",Q:"q",R:"r",RIGHT:"ArrowRight",S:"s",SPACE:" ",T:"t",U:"u",UP:"ArrowUp",V:"v",W:"w",X:"x",Y:"y",Z:"z"}),j=Object.freeze({AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"}),i=Object.freeze({AUDIO:"audio",BLOCK:"block",BREAK:"break",CAPTION:"caption",CONTAINER:"container",FIGURE:"figure",FORMAT:"format",HEADING:"heading",IFRAME:"iframe",IMAGE:"image",LIST:"list",LISTITEM:"listitem",PARAGRAPH:"paragraph",PREFORMAT:"preformat",QUOTE:"quote",ROOT:"root",RULE:"rule",SLOT:"slot",SUMMARY:"summary",TABLE:"table",TABLECELL:"tablecell",TABLEROW:"tablerow",TABLESECTION:"tablesection",VIDEO:"video"}),r=Object.freeze({A:"a",ABBR:"abbr",ALL:"*",AUDIO:"audio",B:"b",BLOCK:"app-block",BLOCKQUOTE:"blockquote",BR:"br",BUTTON:"button",CITE:"cite",CODE:"code",DATA:"data",DEL:"del",DETAILS:"details",DFN:"dfn",DIALOG:"editor-dialog",DIV:"div",EDITOR:"akilli-editor",EM:"em",FIELDSET:"fieldset",FIGCAPTION:"figcaption",FIGURE:"figure",FOCUSBAR:"editor-focusbar",FORM:"form",FORMATBAR:"editor-formatbar",H2:"h2",H3:"h3",HR:"hr",I:"i",IFRAME:"iframe",IMG:"img",INPUT:"input",INS:"ins",KBD:"kbd",LABEL:"label",LEGEND:"legend",LI:"li",MARK:"mark",OL:"ol",P:"p",PRE:"pre",Q:"q",ROOT:"editor-root",S:"s",SAMP:"samp",SECTION:"section",SLOT:"slot",SMALL:"small",STRONG:"strong",SUB:"sub",SUMMARY:"summary",SUP:"sup",TABLE:"table",TBODY:"tbody",TD:"td",TFOOT:"tfoot",TH:"th",THEAD:"thead",TIME:"time",TOOLBAR:"editor-toolbar",TR:"tr",U:"u",UL:"ul",VAR:"var",VIDEO:"video"}),de=Object.freeze({FUNCTION:"function",STRING:"string",UNDEFINED:"undefined"});function x(o,e,{alt:t=!1,ctrl:s=!1,shift:n=!1}={}){return(Array.isArray(e)&&e.includes(o.key)||o.key===e)&&o.altKey===t&&o.ctrlKey===s&&o.shiftKey===n}function Fi(o){return typeof o===de.UNDEFINED}function U(o){return typeof o===de.FUNCTION}function I(o){return o&&typeof o===de.STRING}function G(o){return!o||typeof o===de.STRING}function Ot(o){return!o||Array.isArray(o)&&o.length>0}function Bt(o){return!o||o instanceof HTMLElement}var ue,he,ce,fe,pe,Ui,ge,Gi,Dt=class{constructor(e,t,s=void 0){l(this,pe);l(this,ge);l(this,ue,void 0);l(this,he,void 0);l(this,ce,void 0);l(this,fe,void 0);if(!(e instanceof B)||!I(t)||!G(s))throw p.INVALID_ARGUMENT;b(this,ue,e),b(this,he,t),b(this,ce,s&&this.editor.tags.get(s)),b(this,fe,this.editor.dialogs.get(t))}get editor(){return m(this,ue)}get name(){return m(this,he)}get tag(){return m(this,ce)}get dialog(){return m(this,fe)}execute(){this.dialog?this.openDialog():this.insert(c(this,pe,Ui).call(this))}insert(e={}){if(!this.tag)return;c(this,ge,Gi).call(this,e);let t=this.editor.dom.getSelectedElementByName(this.tag.name);this.tag.group!==i.FORMAT?this.editor.dom.insert(this.editor.dom.createElement(this.tag.name,{attributes:e})):t&&Object.keys(e).length>0?t.parentElement.replaceChild(this.editor.dom.createElement(this.tag.name,{attributes:e,html:t.textContent}),t):t?t.parentElement.replaceChild(this.editor.dom.createText(t.textContent),t):this.editor.dom.format(this.editor.dom.createElement(this.tag.name,{attributes:e}))}openDialog(){this.dialog?.open(e=>this.insert(e),c(this,pe,Ui).call(this))}};ue=new WeakMap,he=new WeakMap,ce=new WeakMap,fe=new WeakMap,pe=new WeakSet,Ui=function(){if(!this.tag)return{};let e=this.editor.dom.getSelectedAttributesByName(this.tag.name);return c(this,ge,Gi).call(this,e),e},ge=new WeakSet,Gi=function(e){Object.keys(e).forEach(t=>this.tag.attributes.includes(t)&&e[t]||delete e[t])};var k=Dt;var z,yt=class{constructor(e=[]){l(this,z,new Map);e.forEach(t=>this.set(t))}get(e){return m(this,z).get(e)}set(e){if(!(e instanceof k))throw p.INVALID_ARGUMENT;m(this,z).set(e.name,e)}execute(e){this.get(e).execute()}freeze(){m(this,z).forEach(e=>Object.freeze(e)),Object.freeze(m(this,z)),Object.freeze(this)}};z=new WeakMap;var ki=yt;var v,Mt=class{constructor(e=[]){l(this,v,new Map);e.forEach(t=>this.set(t))}get(e){return m(this,v).get(e)}set(e){if(!(e instanceof L))throw p.INVALID_ARGUMENT;m(this,v).set(e.name,e)}freeze(){m(this,v).forEach(e=>Object.freeze(e)),Object.freeze(m(this,v)),Object.freeze(this)}};v=new WeakMap;var Hi=Mt;var X,ee,St,Ze,ca,Ct=class{constructor(e){l(this,ee);l(this,Ze);l(this,X,void 0);if(!(e instanceof HTMLElement))throw p.INVALID_ARGUMENT;b(this,X,e),this.register(c(this,Ze,ca).bind(this))}dispatch(e,t=void 0,s=void 0){if(!I(e)||!Bt(t)||!Bt(s))throw p.INVALID_ARGUMENT;m(this,X).dispatchEvent(new CustomEvent(e,{detail:{element:t,target:s}}))}register(e,t={childList:!0,subtree:!0}){if(!U(e))throw p.INVALID_ARGUMENT;new MutationObserver(e).observe(m(this,X),t)}};X=new WeakMap,ee=new WeakSet,St=function(e,t,s){t instanceof HTMLElement&&s instanceof HTMLElement&&(this.dispatch(e,t,s),this.dispatch(`${e}${t.localName.replace("-","")}`,t,s))},Ze=new WeakSet,ca=function(e){e.forEach(t=>{t.addedNodes.forEach(s=>{s instanceof HTMLElement&&(c(this,ee,St).call(this,"insert",s,t.target),Array.from(s.getElementsByTagName(r.ALL)).forEach(n=>c(this,ee,St).call(this,"insert",n,t.target)))}),t.removedNodes.forEach(s=>s instanceof HTMLElement&&c(this,ee,St).call(this,"delete",s,t.target))})};var be=Ct;var Ee,Te,je,Je,Xe,fa,Pt=class{constructor(e,t){l(this,Xe);l(this,Ee,void 0);l(this,Te,void 0);l(this,je,void 0);l(this,Je,{alwaysRaised:"yes",dependent:"yes",height:"",location:"no",menubar:"no",minimizable:"no",modal:"yes",resizable:"yes",scrollbars:"yes",toolbar:"no",width:""});if(!(e instanceof B)||!(t instanceof Document))throw p.INVALID_ARGUMENT;b(this,Ee,e),b(this,Te,t),b(this,je,this.document.defaultView)}get editor(){return m(this,Ee)}get document(){return m(this,Te)}get window(){return m(this,je)}getSelection(){return this.window.getSelection()}getRange(){let e=this.window.getSelection();return e.rangeCount>0?e.getRangeAt(0):void 0}setRange(e){let t=this.getSelection();t.removeAllRanges(),t.addRange(e)}registerElement(e,t,s=void 0){Fi(this.window.customElements.get(e))&&this.window.customElements.define(e,t,s?{extends:s}:void 0)}createElement(e,{attributes:t={},html:s=""}={}){let n=this.document.createElement(e);return n.innerHTML=s,Object.entries(t).forEach(([h,f])=>f&&n.setAttribute(h,`${f}`)),n}insert(e){if(!(e instanceof HTMLElement))throw p.INVALID_ARGUMENT;let t=this.getSelectedEditable();if(t instanceof HTMLSlotElement&&this.editor.tags.allowed(t.parentElement,e))t.insertAdjacentElement(j.BEFOREBEGIN,e);else if(t)this.closest(t,e)?.insertAdjacentElement(j.AFTEREND,e),t.hasAttribute("data-deletable")&&!t.textContent.trim()&&t.parentElement.removeChild(t);else if(this.editor.tags.allowed(this.editor.root,e))this.editor.root.appendChild(e);else throw p.INVALID_ARGUMENT}insertText(e){let t=this.getSelectedEditable();if(t){let s=this.getRange();s.deleteContents(),s.insertNode(this.createText(e)),s.collapse(),t.normalize()}}format(e){if(!(e instanceof HTMLElement))throw p.INVALID_ARGUMENT;let t=this.getRange(),s=this.getSelectedEditable();if(!t||t.collapsed||!t.toString().trim()||!s||!this.editor.tags.allowed(s,e))return;t.startContainer instanceof Text&&t.startContainer.parentElement!==s&&t.setStartBefore(t.startContainer.parentElement),t.endContainer instanceof Text&&t.endContainer.parentElement!==s&&t.setEndAfter(t.endContainer.parentElement);let n=t.toString(),h=Array.from(t.cloneContents().childNodes).every(f=>f instanceof Text&&!f.textContent.trim()||f instanceof HTMLElement&&f.localName===e.localName);t.deleteContents(),h?t.insertNode(this.createText(n)):(e.textContent=n,t.insertNode(e)),s.normalize()}createText(e){return this.document.createTextNode(e)}arbitrary(e){return e===this.editor.root||e?.hasAttribute("data-arbitrary")}contains(e){if(!(e instanceof HTMLElement))throw p.INVALID_ARGUMENT;return this.editor.root.contains(e)||!e.closest(this.editor.root.localName)?.parentElement}closest(e,t){if(!(e instanceof HTMLElement)||!this.contains(e.parentElement))throw p.INVALID_ARGUMENT;let s=e,n=e.parentElement;do if(this.arbitrary(n)&&this.editor.tags.allowed(n,t))return s;while((s=n)&&(n=n.parentElement)&&this.contains(n))}wrap(e,t,s={}){let n;if(e instanceof HTMLElement){if(e.parentElement.localName!==t&&(n=this.editor.dom.closest(e,t))){let h=this.createElement(t,s);n.insertAdjacentElement(j.AFTEREND,h),h.appendChild(e)}}else throw p.INVALID_ARGUMENT}getActiveElement(){let e=this.document.activeElement;return e&&this.contains(e)?e:void 0}getSelectedElement(){let e=this.getSelection(),t=e.anchorNode instanceof Text?e.anchorNode.parentElement:e.anchorNode,s=e.focusNode instanceof Text?e.focusNode.parentElement:e.focusNode;if(t instanceof HTMLElement&&s instanceof HTMLElement&&t===s&&this.contains(t))return t}getSelectedElementByName(e){let t=this.getSelectedElement();return t?.localName===e&&t}getSelectedAttributesByName(e){let t=this.getSelectedElementByName(e),s={};return t&&Array.from(t.attributes).forEach(n=>s[n.nodeName]=n.nodeValue),s}getSelectedEditable(){let e=this.getSelection(),t=e.anchorNode instanceof Text?e.anchorNode.parentElement:e.anchorNode,s=e.focusNode instanceof Text?e.focusNode.parentElement:e.focusNode;if(t instanceof HTMLElement&&s instanceof HTMLElement){let n=t.closest("[contenteditable=true]"),h=s.closest("[contenteditable=true]");if(n instanceof HTMLElement&&n===h&&this.contains(n))return n}}focusEnd(e){if(!(e instanceof HTMLElement))throw p.INVALID_ARGUMENT;e.focus();let t=this.document.createRange();t.selectNodeContents(e),t.collapse(),this.setRange(t)}open({url:e,name:t,call:s,params:n={}}){if(!I(e)||!I(t)||!U(s))throw p.INVALID_ARGUMENT;let h=this.createElement(r.A,{attributes:{href:e}}),f=new URL(h.href);Object.entries(n).forEach(([T,_])=>f.searchParams.set(T,`${_}`));let E=this.window.open(f.toString(),t,c(this,Xe,fa).call(this));this.window.addEventListener("message",T=>{T.origin===f.origin&&T.source===E&&(s(T.data),E.close())},!1)}getWidth(){return this.window.screen.width}getHeight(){return this.window.screen.height}};Ee=new WeakMap,Te=new WeakMap,je=new WeakMap,Je=new WeakMap,Xe=new WeakSet,fa=function(){let e=Object.assign({},m(this,Je),{height:`${this.getHeight()}`,width:`${this.getWidth()}`},this.editor.config.base.browser);return Object.entries(e).filter(([,t])=>!!t).map(([t,s])=>`${t}=${s}`).join(",")};var et=Pt;var Le,Ft=class{constructor(e){l(this,Le,void 0);if(!(e instanceof B))throw p.INVALID_ARGUMENT;b(this,Le,e)}get editor(){return m(this,Le)}filter(e){throw p.NOT_IMPLEMENTED}};Le=new WeakMap;var R=Ft;var q,Ut=class{constructor(){l(this,q,new Set)}add(e){if(!(e instanceof R))throw p.INVALID_ARGUMENT;m(this,q).add(e)}filter(e){if(!(e instanceof HTMLElement))throw p.INVALID_ARGUMENT;m(this,q).forEach(t=>{e.normalize(),t.filter(e)})}freeze(){m(this,q).forEach(e=>Object.freeze(e)),Object.freeze(m(this,q)),Object.freeze(this)}};q=new WeakMap;var Ki=Ut;var Gt=class{constructor({name:e,group:t,...s}={}){w(this,"name");w(this,"group");w(this,"children");w(this,"attributes");w(this,"alignable");w(this,"arbitrary");w(this,"deletable");w(this,"editable");w(this,"empty");w(this,"focusable");w(this,"navigable");w(this,"slotable");w(this,"sortable");w(this,"enter");if(!I(e)||!I(t)||!G(s.enter)||!Ot(s.children)||!Ot(s.attributes))throw p.INVALID_ARGUMENT;this.name=e,this.group=t,this.children=s.children||[],this.attributes=s.attributes||[],this.arbitrary=s.arbitrary===!0,this.alignable=s.alignable===!0,this.deletable=s.deletable===!0,this.editable=s.editable===!0,this.empty=s.empty===!0,this.focusable=s.focusable===!0,this.navigable=s.navigable===!0,this.slotable=s.slotable===!0,this.sortable=s.sortable===!0,this.enter=s.enter||void 0}},tt=Gt;var Ae,te,Ht,kt=class{constructor(e){l(this,te);l(this,Ae,void 0);if(!(e instanceof B))throw p.INVALID_ARGUMENT;b(this,Ae,e)}get editor(){return m(this,Ae)}static get name(){throw p.MISSING_NAME}static get dependencies(){return[]}static get config(){return{}}init(){throw p.NOT_IMPLEMENTED}_(e){return this.editor.translator.translate(this.constructor.name,e)}_i18n(e){e[this.editor.config.base.lang]&&this.editor.translator.set(this.constructor.name,e[this.editor.config.base.lang])}_tag(e){this.editor.tags.set(new tt(e))}_command(e){this.editor.commands.set(new k(this.editor,this.constructor.name,e))}_toolbar(e,t=void 0){this.editor.toolbar.appendChild(c(this,te,Ht).call(this,e,void 0,t))}_formatbar(e,t=void 0,s=void 0){this.editor.formatbar.appendChild(c(this,te,Ht).call(this,e,t,void 0))}_focusbar(e,t=void 0){this.editor.focusbar.appendChild(c(this,te,Ht).call(this,e,void 0,t))}};Ae=new WeakMap,te=new WeakSet,Ht=function(e,t=void 0,s=void 0){if(!I(e)||!G(t))throw p.INVALID_ARGUMENT;return this.editor.dom.createElement(r.BUTTON,{attributes:{type:"button",title:e,"data-command":s||this.constructor.name,"data-key":t},html:e})};var d=kt;var H,Kt=class{constructor(e=[]){l(this,H,new Map);e.forEach(t=>this.set(t))}get(e){return m(this,H).get(e)}set(e){if(!(e instanceof d))throw p.INVALID_ARGUMENT;m(this,H).set(e.constructor.name,e)}init(){m(this,H).forEach(e=>e.init())}freeze(){m(this,H).forEach(e=>Object.freeze(e)),Object.freeze(m(this,H)),Object.freeze(this)}};H=new WeakMap;var Vi=Kt;var W,Vt=class{constructor(e=[]){l(this,W,new Map);e.forEach(t=>this.set(t))}get(e){return m(this,W).get(e instanceof HTMLElement?e.localName:e)}set(e){if(!(e instanceof tt))throw p.INVALID_ARGUMENT;m(this,W).set(e.name,e)}allowed(e,t,s=!1){let n=s?t:this.get(t)?.group;return!!this.get(e)?.children.includes(n)}freeze(){m(this,W).forEach(e=>{Object.freeze(e.children),Object.freeze(e.attributes),Object.freeze(e)}),Object.freeze(m(this,W)),Object.freeze(this)}};W=new WeakMap;var zi=Vt;var $,zt=class{constructor(){l(this,$,new Map)}get(e){return m(this,$).get(e)}set(e,t){if(!I(e)||!(t instanceof Object))throw p.INVALID_ARGUMENT;m(this,$).set(e,t)}translate(e,t){return this.get(e)?.[t]||t}freeze(){m(this,$).forEach(e=>Object.freeze(e)),Object.freeze(m(this,$)),Object.freeze(this)}};$=new WeakMap;var vi=zt;var xe,re,Ie,Ne,_e,Re,we,Oe,Be,De,ye,Me,rt,it,st,ot,at,nt,vt=class{constructor(e,t={}){l(this,xe,void 0);l(this,re,{});l(this,Ie,void 0);l(this,Ne,void 0);l(this,_e,void 0);l(this,Re,void 0);l(this,we,void 0);l(this,Oe,void 0);l(this,Be,void 0);l(this,De,void 0);l(this,ye,void 0);l(this,Me,void 0);l(this,rt,new vi);l(this,it,new zi);l(this,st,new Ki);l(this,ot,new Hi);l(this,at,new ki);l(this,nt,new Vi);if(!(e instanceof HTMLElement)||!(t instanceof Object))throw p.INVALID_ARGUMENT;b(this,xe,e),b(this,re,t),b(this,Ie,new et(this,this.orig.ownerDocument)),b(this,Ne,this.dom.createElement(r.EDITOR)),b(this,_e,this.dom.createElement(r.TOOLBAR,{attributes:{role:"toolbar"}})),this.element.appendChild(this.toolbar),b(this,Re,new be(this.toolbar)),b(this,we,this.dom.createElement(r.FORMATBAR,{attributes:{role:"toolbar"}})),this.formatbar.hidden=!0,this.element.appendChild(this.formatbar),b(this,Oe,new be(this.formatbar)),b(this,Be,this.dom.createElement(r.FOCUSBAR,{attributes:{role:"toolbar"}})),this.focusbar.hidden=!0,this.element.appendChild(this.focusbar),b(this,De,new be(this.focusbar)),b(this,ye,this.dom.createElement(r.ROOT)),this.element.appendChild(this.root),b(this,Me,new be(this.root))}get orig(){return m(this,xe)}get config(){return m(this,re)}get dom(){return m(this,Ie)}get element(){return m(this,Ne)}get toolbar(){return m(this,_e)}get toolbarDispatcher(){return m(this,Re)}get formatbar(){return m(this,we)}get formatbarDispatcher(){return m(this,Oe)}get focusbar(){return m(this,Be)}get focusbarDispatcher(){return m(this,De)}get root(){return m(this,ye)}get rootDispatcher(){return m(this,Me)}get translator(){return m(this,rt)}get tags(){return m(this,it)}get filters(){return m(this,st)}get dialogs(){return m(this,ot)}get commands(){return m(this,at)}get plugins(){return m(this,nt)}static get defaultConfig(){return{}}init(){let e=this.config;b(this,re,{});let t=this.constructor.defaultConfig.base?.plugins||[],s=t;Array.isArray(e.base?.plugins)&&e.base.plugins.length>0&&(s=[],e.base.plugins.forEach(f=>{let E=t.find(T=>T.name===f);E&&s.push(E)}));let n=new Set,h=f=>{f.dependencies?.forEach(h),n.add(f)};s.map(h),n.forEach(f=>{Object.entries(f.config).forEach(([E,T])=>{var _,M;(_=this.config)[M=f.name]??(_[M]={}),this.config[f.name][E]=e[f.name]?.[E]||this.constructor.defaultConfig[f.name]?.[E]||T}),this.plugins.set(new f(this))}),this.plugins.init(),this.toolbarDispatcher.dispatch("init"),this.formatbarDispatcher.dispatch("init"),this.focusbarDispatcher.dispatch("init"),this.rootDispatcher.dispatch("init")}freeze(){Object.freeze(this.config),this.translator.freeze(),this.tags.freeze(),this.filters.freeze(),this.dialogs.freeze(),this.commands.freeze(),this.plugins.freeze()}load(){this.orig instanceof HTMLTextAreaElement?(this.orig.form.addEventListener("submit",()=>this.save()),this.setHtml(this.orig.value.replace("/&nbsp;/g"," "))):this.setHtml(this.orig.innerHTML),this.orig.insertAdjacentElement(j.AFTEREND,this.element),this.orig.hidden=!0}destroy(){this.element.parentElement.removeChild(this.element),this.orig.hidden=!1}getHtml(){let e=this.dom.createElement(this.root.localName,{html:this.root.innerHTML});return this.filters.filter(e),this.rootDispatcher.dispatch("gethtml",e),e.innerHTML}setHtml(e){let t=this.dom.createElement(this.root.localName,{html:e});this.rootDispatcher.dispatch("sethtml",t),this.filters.filter(t),this.root.innerHTML=t.innerHTML}save(){this.orig instanceof HTMLTextAreaElement?this.orig.value=this.getHtml():this.orig.innerHTML=this.getHtml()}url(e){let t=this.dom.window.origin||this.dom.window.location.origin,s=this.dom.createElement(r.A,{attributes:{href:e}});return t===s.origin?s.pathname:s.href}static create(e,t={}){let s=new this(e,t);return s.init(),s.freeze(),s.load(),s}};xe=new WeakMap,re=new WeakMap,Ie=new WeakMap,Ne=new WeakMap,_e=new WeakMap,Re=new WeakMap,we=new WeakMap,Oe=new WeakMap,Be=new WeakMap,De=new WeakMap,ye=new WeakMap,Me=new WeakMap,rt=new WeakMap,it=new WeakMap,st=new WeakMap,ot=new WeakMap,at=new WeakMap,nt=new WeakMap;var B=vt;var y,K,V,lt,pa,mt,ga,qt=class{constructor(e,t,s,n){l(this,lt);l(this,mt);l(this,y,void 0);l(this,K,void 0);l(this,V,void 0);var h,f;if(!(e instanceof et)||!I(t)||!I(s)||!U(n))throw p.INVALID_ARGUMENT;b(this,y,e),b(this,K,m(this,y).createElement(r.FORM,{attributes:{method:"dialog"}})),c(f=c(h=this.addFieldset(),lt,pa).call(h,s,n),mt,ga).call(f,t)}get form(){return m(this,K)}addFieldset(){let e=m(this,y).createElement(r.FIELDSET);return m(this,V)?m(this,V).insertAdjacentElement(j.AFTEREND,e):m(this,K).insertAdjacentElement(j.AFTERBEGIN,e),b(this,V,e),this}addLegend(e){if(!I(e))throw p.INVALID_ARGUMENT;return m(this,V).appendChild(m(this,y).createElement(r.LEGEND,{html:e})),this}addTextInput(e,t,s={}){return this.addInput(e,t,s,"text")}addNumberInput(e,t,s={}){return this.addInput(e,t,s,"number")}addInput(e,t,s={},n="text"){if(!I(e)||!I(t)||!I(n))throw p.INVALID_ARGUMENT;Object.assign(s,{id:`editor-${e}`,name:e,type:n});let h=m(this,y).createElement(r.DIV);return h.appendChild(m(this,y).createElement(r.LABEL,{attributes:{for:s.id},html:t})),h.appendChild(m(this,y).createElement(r.INPUT,{attributes:s})),s.required&&h.setAttribute("data-required",""),m(this,V).appendChild(h),this}};y=new WeakMap,K=new WeakMap,V=new WeakMap,lt=new WeakSet,pa=function(e,t){let s=m(this,y).createElement(r.BUTTON,{attributes:{type:"button"},html:e});return s.addEventListener("click",t),m(this,K).appendChild(s),this},mt=new WeakSet,ga=function(e){return m(this,K).appendChild(m(this,y).createElement(r.BUTTON,{html:e})),this};var qi=qt;var Ce,Se,Pe,Fe,dt,ba,ut,Ea,Ue,Wi,Wt=class{constructor(e,t,s=void 0){l(this,dt);l(this,ut);l(this,Ue);l(this,Ce,void 0);l(this,Se,void 0);l(this,Pe,void 0);l(this,Fe,void 0);if(!(e instanceof B)||!I(t)||!G(s))throw p.INVALID_ARGUMENT;b(this,Ce,e),b(this,Se,t),b(this,Pe,s||void 0)}get editor(){return m(this,Ce)}get name(){return m(this,Se)}get url(){return m(this,Pe)}get formCreator(){return m(this,Fe)}open(e,t={}){this.url?c(this,dt,ba).call(this,e,t):c(this,ut,Ea).call(this,e,t)}_(e){return this.editor.translator.translate(this.name,e)}_prepareForm(){throw p.NOT_IMPLEMENTED}};Ce=new WeakMap,Se=new WeakMap,Pe=new WeakMap,Fe=new WeakMap,dt=new WeakSet,ba=function(e,t={}){this.editor.dom.open({url:this.url,name:this.name,call:e,params:t})},ut=new WeakSet,Ea=function(e,t={}){let s=this.editor.dom.getRange(),n=()=>{s&&this.editor.dom.setRange(s),c(this,Ue,Wi).call(this)};c(this,Ue,Wi).call(this),b(this,Fe,new qi(this.editor.dom,this._("Save"),this._("Cancel"),n)),this._prepareForm();let h=this.formCreator.form;h.addEventListener("submit",E=>{E.preventDefault(),E.stopPropagation(),n();let T={};Array.from(h.elements).forEach(_=>T[_.name]=_.value),e(T)}),Object.entries(t).forEach(([E,T])=>h.elements[E]&&(h.elements[E].value=T));let f=this.editor.dom.createElement(r.DIALOG);f.addEventListener("close",n),f.appendChild(h),f.show(),this.editor.element.appendChild(f)},Ue=new WeakSet,Wi=function(){Array.from(this.editor.element.getElementsByTagName(r.DIALOG)).forEach(e=>{e.parentElement.removeChild(e)})};var L=Wt;var $t=class extends L{constructor(e){super(e,ht.name)}_prepareForm(){this.formCreator.addLegend(this._("Abbreviation")).addTextInput("title",this._("Full term"),{placeholder:this._("Insert full term or leave empty to remove it")})}},$i=$t;var ie,Qt=class extends k{constructor(e,t){let s=Object.entries(O).find(([,n])=>n===t)?.[0].toLowerCase();if(!s)throw p.INVALID_ARGUMENT;super(e,"align-"+s);l(this,ie,void 0);b(this,ie,t)}execute(){let e=this.editor.dom.getActiveElement();e?.hasAttribute("data-alignable")&&(e.classList.remove(...Object.values(O)),m(this,ie)!==O.NONE&&e.classList.add(m(this,ie)))}};ie=new WeakMap;var Qi=Qt;var Ge,Yt=class{constructor(e){l(this,Ge,void 0);if(!(e instanceof B))throw p.INVALID_ARGUMENT;b(this,Ge,e)}get editor(){return m(this,Ge)}handleEvent(e){U(this[e.type])&&this[e.type](e)}};Ge=new WeakMap;var g=Yt;var Zt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-alignable")&&e.detail.element.addEventListener("keydown",this)}keydown(e){let t={[a.UP]:O.NONE,[a.LEFT]:O.LEFT,[a.DOWN]:O.CENTER,[a.RIGHT]:O.RIGHT};e.target===e.currentTarget&&x(e,Object.keys(t),{shift:!0})&&(e.preventDefault(),e.stopPropagation(),e.target.classList.remove(...Object.values(t)),t[e.key]!==O.NONE&&e.target.classList.add(t[e.key]))}},Yi=Zt;var ct,Ta,ke,Zi,Jt=class extends R{constructor(){super(...arguments);l(this,ct);l(this,ke)}filter(e){let t=this.editor.tags.get(e),s=this.editor.tags.allowed(e,r.P),n=t.editable||t.group===i.FORMAT,h=[],f=(E=null)=>{s&&h.length>0&&(e.insertBefore(this.editor.dom.createElement(r.P,{html:h.join(" ")}),E),h=[])};Array.from(e.childNodes).forEach(E=>{let T=E.textContent.trim();if(E instanceof HTMLElement){let _=c(this,ct,Ta).call(this,E),M=this.editor.tags.get(_);if(M&&this.editor.tags.allowed(e,_))f(_),c(this,ke,Zi).call(this,_,M);else if(M&&M.group===i.FORMAT&&s){let N=c(this,ke,Zi).call(this,_,M);N&&(h.push(N.outerHTML),e.removeChild(N))}else!n&&T&&s?(h.push(T),e.removeChild(_)):n&&T?e.replaceChild(this.editor.dom.createText(T),_):e.removeChild(_)}else E instanceof Text?(!n&&T&&s&&h.push(T),(!n||!T)&&e.removeChild(E)):E instanceof Node&&e.removeChild(E)}),f()}};ct=new WeakSet,Ta=function(e){let t=this.editor.config.base.filter[e.localName];if(!t)return e;let s=this.editor.dom.createElement(t,{html:e.innerHTML});return e.parentElement.replaceChild(s,e),s},ke=new WeakSet,Zi=function(e,t){if(Array.from(e.attributes).forEach(s=>!t.attributes.includes(s.name)&&e.removeAttribute(s.name)),e.hasChildNodes()&&this.editor.filters.filter(e),e.hasChildNodes()||t.empty)return e;e.parentElement?.removeChild(e)};var Ji=Jt;var Xt=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-deletable")&&e.detail.element.addEventListener("keydown",this)}keydown(e){e.target===e.currentTarget&&x(e,a.DEL,{ctrl:!0})&&(e.target.previousElementSibling instanceof HTMLElement&&this.editor.dom.focusEnd(e.target.previousElementSibling),e.target.parentElement.removeChild(e.target),e.preventDefault(),e.stopPropagation())}},Xi=Xt;var er=class extends HTMLElement{get open(){return this.hasAttribute("open")}set open(e){e===!0?this.setAttribute("open",""):this.removeAttribute("open")}constructor(){super();this.addEventListener("keydown",e=>e.key===a.ESC&&this.close()),this.addEventListener("click",e=>e.target===this&&this.close())}connectedCallback(){this.setAttribute("role","dialog"),this.tabIndex=-1,this.focus()}show(){this.open=!0,this.dispatchEvent(new CustomEvent("show",{detail:{element:this,target:this}}))}close(){this.open=!1,this.dispatchEvent(new CustomEvent("close",{detail:{element:this,target:this}}))}},es=er;var tr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.contentEditable==="true"&&e.detail.element.addEventListener("keydown",this)}keydown(e){if(x(e,a.ENTER,{shift:!0})&&!this.editor.tags.allowed(e.target,r.BR))e.preventDefault(),e.stopPropagation();else if(x(e,a.ENTER)){e.preventDefault(),e.stopPropagation();let t=this.editor.tags.get(e.target)?.enter;t&&(e.target.textContent.trim()||!e.target.hasAttribute("data-deletable")?this.editor.dom.closest(e.target,t)?.insertAdjacentElement(j.AFTEREND,this.editor.dom.createElement(t)):e.target instanceof HTMLParagraphElement||(this.editor.dom.closest(e.target,r.P)?.insertAdjacentElement(j.AFTEREND,this.editor.dom.createElement(r.P)),e.target.parentElement.removeChild(e.target)))}else x(e,a.BACKSPACE)&&!e.target.textContent&&e.target.hasAttribute("data-deletable")?(e.target.previousElementSibling instanceof HTMLElement&&this.editor.dom.focusEnd(e.target.previousElementSibling),e.target.parentElement.removeChild(e.target),e.preventDefault(),e.stopPropagation()):/^[A-Z]$/.test(e.key)&&x(e,e.key,{alt:!0,shift:!0})&&(e.preventDefault(),e.stopPropagation(),this.editor.formatbar.querySelector(`${r.BUTTON}[data-key=${e.key.toLowerCase()}]`)?.click())}},ts=tr;var rr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-focusable")&&e.detail.element.focus()}},rs=rr;var ir=class extends g{insertbutton(e){let t=e.detail.element.getAttribute("data-key");if(t){let s=this.editor.translator.translate(u.name,"Alt"),n=this.editor.translator.translate(u.name,"Shift");e.detail.element.title+=` [${s} + ${n} + ${t}]`}e.detail.element.getAttribute("data-command")&&e.detail.element.addEventListener("click",this)}click(e){this.editor.commands.execute(e.target.getAttribute("data-command"))}keydown(e){if(x(e,[a.LEFT,a.RIGHT,a.HOME,a.END])){let t=e.target.previousElementSibling,s=e.target.nextElementSibling,n=e.target.parentElement.firstElementChild,h=e.target.parentElement.lastElementChild,f=e.target===n,E=e.target===h;e.key===a.LEFT&&!f?t.focus():e.key===a.RIGHT&&!E?s.focus():e.key===a.HOME||e.key===a.RIGHT&&E?n.focus():(e.key===a.END||e.key===a.LEFT&&f)&&h.focus(),e.preventDefault(),e.stopPropagation()}}},se=ir;var sr=class extends se{constructor(e){super(e);this.editor.focusbar.addEventListener("insertbutton",this),this.editor.root.addEventListener("focusin",this),this.editor.root.addEventListener("focusout",this)}insertbutton(e){super.insertbutton(e),e.detail.element.getAttribute("data-command")&&e.detail.element.addEventListener("mousedown",this)}mousedown(e){e.preventDefault(),e.stopPropagation()}focusin(e){this.editor.focusbar.hidden=!1;let t=e.target.offsetTop+e.target.offsetParent.offsetTop-this.editor.focusbar.clientHeight;this.editor.focusbar.style.top=`${t}px`}focusout(e){this.editor.focusbar.hidden=!0,this.editor.focusbar.removeAttribute("style")}},is=sr;var or=class extends se{constructor(e){super(e);this.editor.formatbar.addEventListener("insertbutton",this),this.editor.dom.document.addEventListener("selectionchange",this)}selectionchange(){let e=this.editor.dom.getSelectedEditable();if(e&&!this.editor.dom.getSelection().isCollapsed&&this.editor.tags.allowed(e,i.FORMAT,!0)){this.editor.formatbar.hidden=!1;let t=e.offsetTop+e.offsetParent.offsetTop-this.editor.formatbar.clientHeight;this.editor.formatbar.style.top=`${t}px`}else this.editor.formatbar.hidden=!0,this.editor.formatbar.removeAttribute("style")}},ss=or;var ft,ja,ar=class extends g{constructor(e){super(e);l(this,ft);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-navigable")&&(e.detail.element.tabIndex=0,e.detail.element.addEventListener("keydown",this))}keydown(e){if(e.target===e.currentTarget&&x(e,[a.UP,a.DOWN,a.HOME,a.END])&&c(this,ft,ja).call(this,e.target)){let t=e.target.previousElementSibling,s=e.target.nextElementSibling,n=e.target.parentElement.firstElementChild,h=e.target.parentElement.lastElementChild,f=e.target===n,E=e.target===h;e.key===a.UP&&!f&&t.hasAttribute("data-navigable")?t.focus():e.key===a.DOWN&&!E&&s.hasAttribute("data-navigable")?s.focus():(e.key===a.HOME||e.key===a.DOWN&&E)&&n.hasAttribute("data-navigable")?n.focus():(e.key===a.END||e.key===a.UP&&f)&&h.hasAttribute("data-navigable")&&h.focus(),e.preventDefault(),e.stopPropagation()}}};ft=new WeakSet,ja=function(e){if(e.contentEditable!=="true")return!0;let t=this.editor.dom.getSelection(),s=this.editor.dom.getSelectedEditable(),n=this.editor.dom.getSelectedElement();return t.isCollapsed&&t.anchorOffset===0&&[s,e.firstChild].includes(n)};var os=ar;var nr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element instanceof HTMLSlotElement?e.detail.element.addEventListener("keydown",this):e.detail.element.hasAttribute("data-slotable")&&!e.detail.element.querySelector(":scope > "+r.SLOT)&&e.detail.element.appendChild(this.editor.dom.createElement(r.SLOT))}keydown(e){e.preventDefault(),e.stopPropagation()}},as=nr;var He,ns,Ke,ls,lr=class extends g{constructor(e){super(e);l(this,He);l(this,Ke);this.editor.root.addEventListener("insert",this)}insert(e){e.detail.element.hasAttribute("data-sortable")&&(e.detail.element.addEventListener("keydown",this),e.detail.element.addEventListener("pointerdown",this),e.detail.element.addEventListener("pointermove",this),e.detail.element.addEventListener("pointerup",this))}keydown(e){if(e.target===e.currentTarget&&x(e,[a.UP,a.DOWN,a.HOME,a.END],{ctrl:!0})){let t=e.target.parentElement,s=e.target.previousElementSibling,n=e.target.nextElementSibling,h=t.firstElementChild,f=t.lastElementChild,E=e.target===h,T=e.target===f;e.key===a.UP&&!E&&s.hasAttribute("data-sortable")?(s.insertAdjacentHTML(j.BEFOREBEGIN,e.target.outerHTML),t.removeChild(e.target)):e.key===a.DOWN&&!T&&n.hasAttribute("data-sortable")?(n.insertAdjacentHTML(j.AFTEREND,e.target.outerHTML),t.removeChild(e.target)):(e.key===a.HOME&&!E||e.key===a.DOWN&&T)&&h.hasAttribute("data-sortable")?(h.insertAdjacentHTML(j.BEFOREBEGIN,e.target.outerHTML),t.removeChild(e.target)):(e.key===a.END&&!T||e.key===a.UP&&E)&&f.hasAttribute("data-sortable")&&(f.insertAdjacentHTML(j.AFTEREND,e.target.outerHTML),t.removeChild(e.target)),e.preventDefault(),e.stopPropagation()}}pointerdown(e){e.target.hasAttribute("data-sortable")&&(e.target.setAttribute("data-sort",""),e.target.setPointerCapture(e.pointerId))}pointermove(e){let t=this.editor.dom.document.elementFromPoint(e.x,e.y);c(this,He,ns).call(this),c(this,Ke,ls).call(this,e.target,t)&&t.setAttribute("data-sortover","")}pointerup(e){if(e.target.hasAttribute("data-sortable")){let t=this.editor.dom.document.elementFromPoint(e.x,e.y);c(this,He,ns).call(this),e.target.removeAttribute("data-sort"),e.target.releasePointerCapture(e.pointerId),c(this,Ke,ls).call(this,e.target,t)&&t.insertAdjacentElement(j.BEFOREBEGIN,e.target)}}};He=new WeakSet,ns=function(){this.editor.root.querySelectorAll("[data-sortover]").forEach(e=>e.removeAttribute("data-sortover"))},Ke=new WeakSet,ls=function(e,t){return e instanceof HTMLElement&&t instanceof HTMLElement&&this.editor.dom.contains(t)&&![this.editor.root,e].includes(t)&&t.hasAttribute("data-sortable")&&(e.parentElement===t.parentElement||this.editor.dom.arbitrary(e.parentElement)&&this.editor.dom.arbitrary(t.parentElement))&&this.editor.tags.allowed(t.parentElement,e)};var ms=lr;var mr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insert",this)}insert(e){let t=this.editor.tags.get(e.detail.element);t&&(t.editable&&(e.detail.element.contentEditable="true"),["alignable","arbitrary","deletable","focusable","navigable","slotable","sortable"].forEach(s=>{t[s]&&(e.detail.element.dataset[s]="")}))}},ds=mr;var dr=class extends se{constructor(e){super(e);this.editor.toolbar.addEventListener("insertbutton",this)}insertbutton(e){super.insertbutton(e),e.detail.element.tabIndex=-1,e.detail.element.addEventListener("keydown",this)}},us=dr;var hs={de:{"Align center":"zentriert","Align left":"linksb\xFCndig","Align none":"Keine Ausrichtung","Align right":"rechtsb\xFCndig",Alt:"Alt",Shift:"Umschalt"}};var ur=class extends d{static get name(){return"base"}static get config(){return{browser:{},filter:{},lang:void 0,plugins:[]}}init(){this._i18n(hs),this.editor.dom.registerElement(r.DIALOG,es),this._tag({name:r.ROOT,group:i.ROOT,children:[i.AUDIO,i.BLOCK,i.CONTAINER,i.FIGURE,i.HEADING,i.IFRAME,i.IMAGE,i.LIST,i.PARAGRAPH,i.PREFORMAT,i.QUOTE,i.RULE,i.TABLE,i.VIDEO]}),this._tag({name:r.SLOT,group:i.SLOT,editable:!0,focusable:!0,navigable:!0,sortable:!0}),new ds(this.editor),new us(this.editor),new ss(this.editor),new is(this.editor),new ts(this.editor),new Xi(this.editor),new os(this.editor),new ms(this.editor),new Yi(this.editor),new rs(this.editor),new as(this.editor),this.editor.filters.add(new Ji(this.editor));let e={[O.NONE]:this._("Align none"),[O.LEFT]:this._("Align left"),[O.CENTER]:this._("Align center"),[O.RIGHT]:this._("Align right")};Object.entries(e).forEach(([t,s])=>{let n=new Qi(this.editor,t);this.editor.commands.set(n),this._focusbar(s,n.name)})}},u=ur;var cs={de:{Abbreviation:"Abk\xFCrzung",Cancel:"Abbrechen","Full term":"Langform","Insert full term or leave empty to remove it":"Langform eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var hr=class extends d{static get name(){return"abbreviation"}static get dependencies(){return[u]}init(){this._i18n(cs),this._tag({name:r.ABBR,group:i.FORMAT,attributes:["title"]}),this.editor.dialogs.set(new $i(this.editor)),this._command(r.ABBR),this._formatbar(this._("Abbreviation"),a.A)}},ht=hr;var cr=class extends L{constructor(e,t=void 0){super(e,oe.name,t)}_prepareForm(){this.formCreator.addLegend(this._("Audio")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to audio"),required:"required"})}},fs=cr;var Ve,ps,fr=class extends g{constructor(e){super(e);l(this,Ve);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertaudio",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.AUDIO)).forEach(t=>c(this,Ve,ps).call(this,t))}insertaudio(e){c(this,Ve,ps).call(this,e.detail.element)}};Ve=new WeakSet,ps=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.controls=!0,this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:oe.name}})):e.parentElement.removeChild(e)};var gs=fr;var pr=class extends R{filter(e){e.querySelectorAll(`${r.FIGURE} > ${r.FIGCAPTION}:only-child`).forEach(t=>t.parentElement.removeChild(t))}},bs=pr;var gr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertfigure",this)}insertfigure(e){e.detail.element.querySelector(":scope > "+r.FIGCAPTION)||e.detail.element.appendChild(this.editor.dom.createElement(r.FIGCAPTION))}},Es=gr;var br=class extends d{static get name(){return"figure"}static get dependencies(){return[u]}init(){this._tag({name:r.FIGURE,group:i.FIGURE,children:[i.AUDIO,i.CAPTION,i.IFRAME,i.IMAGE,i.PREFORMAT,i.QUOTE,i.TABLE,i.VIDEO],attributes:["class"],alignable:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._tag({name:r.FIGCAPTION,group:i.CAPTION,children:[i.FORMAT],editable:!0,navigable:!0,enter:r.P}),new Es(this.editor),this.editor.filters.add(new bs(this.editor))}},D=br;var Ts={de:{Audio:"Audio",Cancel:"Abbrechen","Insert URL to audio":"URL zur Audiodatei eingeben",Save:"Speichern",URL:"URL"}};var Er=class extends d{static get name(){return"audio"}static get dependencies(){return[u,D]}static get config(){return{browser:void 0}}init(){this._i18n(Ts),this._tag({name:r.AUDIO,group:i.AUDIO,attributes:["controls","src"],empty:!0,navigable:!0}),new gs(this.editor),this.editor.dialogs.set(new fs(this.editor,this.editor.config.audio.browser)),this._command(r.AUDIO),this._toolbar(this._("Audio"))}},oe=Er;var Tr=class extends L{constructor(e,t=void 0){super(e,pt.name,t)}_prepareForm(){this.formCreator.addLegend(this._("Block")).addTextInput("id",this._("ID"),{required:"required"})}},js=Tr;var jr=class extends HTMLElement{get content(){return this.shadowRoot.innerHTML}set content(e){this.shadowRoot.innerHTML=e}constructor(){super();this.attachShadow({mode:"open"})}},Ls=jr;var Lr=class extends g{constructor(e){super(e);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertappblock",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.BLOCK)).forEach(t=>t.id||t.parentElement.removeChild(t))}async insertappblock(e){if(!e.detail.element.id){e.detail.element.parentElement.removeChild(e.detail.element);return}if(!this.editor.config.block.api)return;let t=this.editor.config.block.api.replace("{id}",e.detail.element.id),s=await fetch(t,{mode:"no-cors"});if(!s.ok)return;let n="";this.editor.config.block.css&&(n=this.editor.config.block.css.split(",").map(f=>`<link rel="stylesheet" href="${f}">`).join(""));let h=await s.text();e.detail.element.content=n+h}},As=Lr;var gt={de:{Cancel:"Abbrechen",Height:"H\xF6he",Ifrane:"Iframe","Insert URL to embedded page":"URL zur eingebetteten Seite eingeben",Save:"Speichern",URL:"URL",Width:"Breite"}};var Ar=class extends d{static get name(){return"block"}static get dependencies(){return[u]}static get config(){return{api:void 0,browser:void 0,css:void 0}}init(){this._i18n(gt),this.editor.dom.registerElement(r.BLOCK,Ls),this._tag({name:r.BLOCK,group:i.BLOCK,attributes:["id"],deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),new As(this.editor),this.editor.dialogs.set(new js(this.editor,this.editor.config.block.browser)),this._command(r.BLOCK),this._toolbar(this._("Block"))}},pt=Ar;var xr=class extends R{filter(e){e instanceof HTMLElement&&e.localName===r.FIGURE&&e.classList.contains(Q.name)&&e.querySelector(":scope > "+r.BLOCKQUOTE)&&!e.querySelector(":scope > "+r.FIGCAPTION)&&(e.insertAdjacentElement(j.BEFOREBEGIN,e.querySelector(":scope > "+r.BLOCKQUOTE)),e.parentElement.removeChild(e))}},xs=xr;var Ir=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertblockquote",this),this.editor.root.addEventListener("deleteblockquote",this)}insertblockquote(e){this.editor.dom.wrap(e.detail.element,r.FIGURE,{attributes:{class:Q.name}})}deleteblockquote(e){e.detail.target.localName===r.FIGURE&&e.detail.target.classList.contains(Q.name)&&e.detail.target.parentElement.removeChild(e.detail.target)}},Is=Ir;var Nr=class extends R{filter(e){if(e instanceof HTMLPreElement){e.outerHTML=e.outerHTML.replace(/(<br\s*\/?>)/gi,`
`);return}e.innerHTML=e.innerHTML.replace(/^\s*(<br\s*\/?>\s*)+/gi,"").replace(/\s*(<br\s*\/?>\s*)+$/gi,""),e instanceof HTMLParagraphElement?e.outerHTML=e.outerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"</p><p>"):e.innerHTML=e.innerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"<br>")}},Ns=Nr;var _r=class extends d{static get name(){return"break"}static get dependencies(){return[u]}init(){this._tag({name:r.BR,group:i.BREAK,empty:!0}),this.editor.filters.add(new Ns(this.editor))}},P=_r;var _s={de:{Blockquote:"Blockzitat"}};var Rr=class extends d{static get name(){return"blockquote"}static get dependencies(){return[u,P,D]}init(){this._i18n(_s),this._tag({name:r.BLOCKQUOTE,group:i.QUOTE,children:[i.BREAK,i.FORMAT],deletable:!0,editable:!0,navigable:!0,enter:r.P}),new Is(this.editor),this._command(r.BLOCKQUOTE),this._toolbar(this._("Blockquote")),this.editor.filters.add(new xs(this.editor))}},Q=Rr;var Rs={de:{bold:"fett"}};var wr=class extends d{static get name(){return"bold"}static get dependencies(){return[u]}init(){this._i18n(Rs),this._tag({name:r.B,group:i.FORMAT}),this._command(r.B),this._formatbar(this._("bold"),a.B)}},ws=wr;var Os={de:{Citation:"Zitatquelle"}};var Or=class extends d{static get name(){return"cite"}static get dependencies(){return[u]}init(){this._i18n(Os),this._tag({name:r.CITE,group:i.FORMAT}),this._command(r.CITE),this._formatbar(this._("Citation"),a.Z)}},Bs=Or;var Ds={de:{Code:"Quelltext"}};var Br=class extends d{static get name(){return"code"}static get dependencies(){return[u]}init(){this._i18n(Ds),this._tag({name:r.CODE,group:i.FORMAT}),this._command(r.CODE),this._formatbar(this._("Code"),a.C)}},ys=Br;var Dr=class extends L{constructor(e){super(e,bt.name)}_prepareForm(){this.formCreator.addLegend(this._("Data")).addTextInput("value",this._("Machine-readable Value"),{placeholder:this._("Insert value or leave empty to remove it")})}},Ms=Dr;var Cs={de:{Cancel:"Abbrechen",Data:"Data","Machine-readable Value":"Maschinenlesbarer Wert","Insert value or leave empty to remove it":"Wert eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};var yr=class extends d{static get name(){return"data"}static get dependencies(){return[u]}init(){this._i18n(Cs),this._tag({name:r.DATA,group:i.FORMAT,attributes:["value"]}),this.editor.dialogs.set(new Ms(this.editor)),this._command(r.DATA),this._formatbar(this._("Data"),a.J)}},bt=yr;var Ss={de:{Definition:"Definition"}};var Mr=class extends d{static get name(){return"definition"}static get dependencies(){return[u]}init(){this._i18n(Ss),this._tag({name:r.DFN,group:i.FORMAT}),this._command(r.DFN),this._formatbar(this._("Definition"),a.D)}},Ps=Mr;var Fs={de:{"Text Deletion":"Textl\xF6schung"}};var Cr=class extends d{static get name(){return"deletion"}static get dependencies(){return[u]}init(){this._i18n(Fs),this._tag({name:r.DEL,group:i.FORMAT}),this._command(r.DEL),this._formatbar(this._("Text Deletion"),a.G)}},Us=Cr;var Sr=class extends R{filter(e){e.querySelectorAll(`${r.SUMMARY}:not(:first-child)`).forEach(t=>t.parentElement.removeChild(t)),e.querySelectorAll(`${r.SUMMARY}:only-child`).forEach(t=>t.parentElement.removeChild(t))}},Gs=Sr;var ze,ks,Pr=class extends g{constructor(e){super(e);l(this,ze);this.editor.root.addEventListener("insertdetails",this),this.editor.root.addEventListener("insertsummary",this)}insertdetails(e){e.detail.element.open=!0,e.detail.element.querySelector(`:scope > ${r.SUMMARY}:first-child`)||e.detail.element.insertAdjacentElement(j.AFTERBEGIN,this.editor.dom.createElement(r.SUMMARY))}insertsummary(e){c(this,ze,ks).call(this,e.detail.element),e.detail.element.addEventListener("blur",this),e.detail.element.addEventListener("keydown",this)}blur(e){c(this,ze,ks).call(this,e.target)}keydown(e){x(e,a.SPACE)?(e.preventDefault(),e.stopPropagation(),this.editor.dom.insertText(" ")):x(e,a.ENTER)&&(e.preventDefault(),e.stopPropagation(),e.target.parentElement.open=!0)}};ze=new WeakSet,ks=function(e){e.textContent.trim()?e.querySelectorAll(r.BR+":not(:last-child)").forEach(t=>t.parentElement.removeChild(t)):e.textContent=this.editor.translator.translate(Et.name,"Details"),e.lastElementChild instanceof HTMLBRElement||e.appendChild(this.editor.dom.createElement(r.BR))};var Hs=Pr;var Ks={de:{Details:"Details"}};var Fr=class extends d{static get name(){return"details"}static get dependencies(){return[u]}init(){this._i18n(Ks),this._tag({name:r.DETAILS,group:i.CONTAINER,children:[i.AUDIO,i.FIGURE,i.IFRAME,i.IMAGE,i.LIST,i.PARAGRAPH,i.PREFORMAT,i.QUOTE,i.RULE,i.SUMMARY,i.TABLE,i.VIDEO],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._tag({name:r.SUMMARY,group:i.SUMMARY,editable:!0,navigable:!0,enter:r.P}),new Hs(this.editor),this._command(r.DETAILS),this._toolbar(this._("Details")),this.editor.filters.add(new Gs(this.editor))}},Et=Fr;var Ur=class extends L{constructor(e){super(e,Tt.name)}_prepareForm(){this.formCreator.addLegend(this._("Division")).addTextInput("class",this._("CSS class"),{placeholder:this._("Insert CSS class")})}},Vs=Ur;var zs={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse",Division:"Division","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern"}};var Gr=class extends d{static get name(){return"division"}static get dependencies(){return[u]}init(){this._i18n(zs),this._tag({name:r.DIV,group:i.CONTAINER,children:[i.AUDIO,i.BLOCK,i.FIGURE,i.IFRAME,i.IMAGE,i.PREFORMAT,i.QUOTE,i.RULE,i.TABLE,i.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new Vs(this.editor)),this._command(r.DIV),this._toolbar(this._("Division"))}},Tt=Gr;var vs={de:{emphasized:"betont"}};var kr=class extends d{static get name(){return"emphasis"}static get dependencies(){return[u]}init(){this._i18n(vs),this._tag({name:r.EM,group:i.FORMAT}),this._command(r.EM),this._formatbar(this._("emphasized"),a.E)}},qs=kr;var Ws={de:{Heading:"\xDCberschrift"}};var Hr=class extends d{static get name(){return"heading"}static get dependencies(){return[u]}init(){this._i18n(Ws),this._tag({name:r.H2,group:i.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.P}),this._command(r.H2),this._toolbar(this._("Heading"))}},$s=Hr;var Qs={de:{"Horizontal Rule":"Horizontale Linie"}};var Kr=class extends d{static get name(){return"horizontalrule"}static get dependencies(){return[u]}init(){this._i18n(Qs),this._tag({name:r.HR,group:i.RULE,deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(r.HR),this._toolbar(this._("Horizontal Rule"))}},Ys=Kr;var Vr=class extends L{constructor(e,t=void 0){super(e,ae.name,t)}_prepareForm(){this.formCreator.addLegend(this._("Iframe")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to embedded page"),required:"required"}).addNumberInput("width",this._("Width")).addNumberInput("height",this._("Height"))}},Zs=Vr;var ve,Js,zr=class extends g{constructor(e){super(e);l(this,ve);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertiframe",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.IFRAME)).forEach(t=>c(this,ve,Js).call(this,t))}insertiframe(e){c(this,ve,Js).call(this,e.detail.element)}};ve=new WeakSet,Js=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.allowFullscreen=!0,this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:ae.name}})):e.parentElement.removeChild(e)};var Xs=zr;var vr=class extends d{static get name(){return"iframe"}static get dependencies(){return[u,D]}static get config(){return{browser:void 0}}init(){this._i18n(gt),this._tag({name:r.IFRAME,group:i.IFRAME,attributes:["allowfullscreen","height","src","width"],empty:!0,navigable:!0}),new Xs(this.editor),this.editor.dialogs.set(new Zs(this.editor,this.editor.config.iframe.browser)),this._command(r.IFRAME),this._toolbar(this._("Iframe"))}},ae=vr;var qr=class extends L{constructor(e,t=void 0){super(e,ne.name,t)}_prepareForm(){this.formCreator.addLegend(this._("Image")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to image"),required:"required"}).addTextInput("alt",this._("Alternative text"),{placeholder:this._("Text shown when media element is not available")}).addNumberInput("width",this._("Width")).addNumberInput("height",this._("Height"))}},eo=qr;var qe,to,Wr=class extends g{constructor(e){super(e);l(this,qe);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertimg",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.IMG)).forEach(t=>c(this,qe,to).call(this,t))}insertimg(e){c(this,qe,to).call(this,e.detail.element)}};qe=new WeakSet,to=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:ne.name}})):e.parentElement.removeChild(e)};var ro=Wr;var io={de:{"Alternative text":"Alternativtext",Cancel:"Abbrechen",Height:"H\xF6he",Image:"Bild","Insert URL to image":"URL zur Bilddatei eingeben",Save:"Speichern","Text shown when media element is not available":"Ersatztext, falls Medienelement nicht verf\xFCgbar ist",URL:"URL",Width:"Breite"}};var $r=class extends d{static get name(){return"image"}static get dependencies(){return[u,D]}static get config(){return{browser:void 0}}init(){this._i18n(io),this._tag({name:r.IMG,group:i.IMAGE,attributes:["alt","height","src","width"],empty:!0,navigable:!0}),new ro(this.editor),this.editor.dialogs.set(new eo(this.editor,this.editor.config.image.browser)),this._command(r.IMG),this._toolbar(this._("Image"))}},ne=$r;var so={de:{"Text Insertion":"Texteinf\xFCgung"}};var Qr=class extends d{static get name(){return"insertion"}static get dependencies(){return[u]}init(){this._i18n(so),this._tag({name:r.INS,group:i.FORMAT}),this._command(r.INS),this._formatbar(this._("Text Insertion"),a.F)}},oo=Qr;var ao={de:{italic:"kursiv"}};var Yr=class extends d{static get name(){return"italic"}static get dependencies(){return[u]}init(){this._i18n(ao),this._tag({name:r.I,group:i.FORMAT}),this._command(r.I),this._formatbar(this._("italic"),a.I)}},no=Yr;var lo={de:{"User Input":"Benutzereingabe"}};var Zr=class extends d{static get name(){return"keyboard"}static get dependencies(){return[u]}init(){this._i18n(lo),this._tag({name:r.KBD,group:i.FORMAT}),this._command(r.KBD),this._formatbar(this._("User Input"),a.K)}},mo=Zr;var Jr=class extends L{constructor(e){super(e,jt.name)}_prepareForm(){this.formCreator.addLegend(this._("Link")).addTextInput("href",this._("URL"),{pattern:"(https?|/|mailto:|tel:).+",placeholder:this._("Insert link or leave empty to unlink")})}},uo=Jr;var We,ho,Xr=class extends g{constructor(e){super(e);l(this,We);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("inserta",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.A)).forEach(t=>c(this,We,ho).call(this,t))}inserta(e){c(this,We,ho).call(this,e.detail.element)}};We=new WeakSet,ho=function(e){let t=e.getAttribute("href");t?e.setAttribute("href",this.editor.url(t)):e.parentElement.replaceChild(this.editor.dom.createText(e.textContent),e)};var co=Xr;var fo={de:{Cancel:"Abbrechen","Insert link or leave empty to unlink":"Link eingeben oder zum Entfernen leer lassen",Link:"Link",Save:"Speichern",URL:"URL"}};var ei=class extends d{static get name(){return"link"}static get dependencies(){return[u]}init(){this._i18n(fo),this._tag({name:r.A,group:i.FORMAT,attributes:["href"]}),new co(this.editor),this.editor.dialogs.set(new uo(this.editor)),this._command(r.A),this._formatbar(this._("Link"),a.L)}},jt=ei;var po={de:{mark:"markiert"}};var ti=class extends d{static get name(){return"mark"}static get dependencies(){return[u]}init(){this._i18n(po),this._tag({name:r.MARK,group:i.FORMAT}),this._command(r.MARK),this._formatbar(this._("mark"),a.M)}},go=ti;var $e,bo,ri=class extends g{constructor(e){super(e);l(this,$e);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertli",this),this.editor.root.addEventListener("deleteli",this),this.editor.root.addEventListener("insertol",this),this.editor.root.addEventListener("insertul",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.LI)).forEach(t=>c(this,$e,bo).call(this,t))}insertli(e){c(this,$e,bo).call(this,e.detail.element)}deleteli(e){e.detail.target.children.length===0&&e.detail.target.parentElement.removeChild(e.detail.target)}insertol(e){e.detail.element.children.length===0&&e.detail.element.appendChild(this.editor.dom.createElement(r.LI))}insertul(e){this.insertol(e)}};$e=new WeakSet,bo=function(e){!(e.parentElement instanceof HTMLOListElement)&&!(e.parentElement instanceof HTMLUListElement)&&this.editor.dom.wrap(e,r.UL)};var Eo=ri;var ii=class extends d{static get name(){return"list"}static get dependencies(){return[u,P]}init(){this._tag({name:r.LI,group:i.LISTITEM,children:[i.BREAK,i.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.LI}),new Eo(this.editor)}},Lt=ii;var To={de:{"Ordered List":"Geordnete Liste"}};var si=class extends d{static get name(){return"orderedlist"}static get dependencies(){return[u,Lt]}init(){this._i18n(To),this._tag({name:r.OL,group:i.LIST,children:[i.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(r.OL),this._toolbar(this._("Ordered List"))}},jo=si;var Qe,Lo,oi=class extends g{constructor(e){super(e);l(this,Qe);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertp",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.P)).forEach(t=>c(this,Qe,Lo).call(this,t))}insertp(e){c(this,Qe,Lo).call(this,e.detail.element)}paste(e){this.editor.dom.window.setTimeout(()=>this.editor.filters.filter(e.target))}};Qe=new WeakSet,Lo=function(e){e.addEventListener("paste",this)};var Ao=oi;var xo={de:{Paragraph:"Absatz"}};var ai=class extends d{static get name(){return"paragraph"}static get dependencies(){return[u,P]}init(){this._i18n(xo),this._tag({name:r.P,group:i.PARAGRAPH,children:[i.BREAK,i.FORMAT],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.P}),new Ao(this.editor),this._command(r.P),this._toolbar(this._("Paragraph"))}},Io=ai;var ni=class extends R{filter(e){e instanceof HTMLElement&&e.localName===r.FIGURE&&e.classList.contains(Y.name)&&e.querySelector(":scope > "+r.PRE)&&!e.querySelector(":scope > "+r.FIGCAPTION)&&(e.insertAdjacentElement(j.BEFOREBEGIN,e.querySelector(":scope > "+r.PRE)),e.parentElement.removeChild(e))}},No=ni;var li=class extends g{constructor(e){super(e);this.editor.root.addEventListener("insertpre",this),this.editor.root.addEventListener("deletepre",this)}insertpre(e){this.editor.dom.wrap(e.detail.element,r.FIGURE,{attributes:{class:Y.name}})}deletepre(e){e.detail.target.localName===r.FIGURE&&e.detail.target.classList.contains(Y.name)&&e.detail.target.parentElement.removeChild(e.detail.target)}},_o=li;var Ro={de:{"Preformatted Text":"Vorformatierter Text"}};var mi=class extends d{static get name(){return"preformat"}static get dependencies(){return[u,P,D]}init(){this._i18n(Ro),this._tag({name:r.PRE,group:i.PREFORMAT,children:[i.BREAK],deletable:!0,editable:!0,navigable:!0,enter:r.P}),new _o(this.editor),this._command(r.PRE),this._toolbar(this._("Preformatted Text")),this.editor.filters.add(new No(this.editor))}},Y=mi;var wo={de:{Quote:"Zitat"}};var di=class extends d{static get name(){return"quote"}static get dependencies(){return[u]}init(){this._i18n(wo),this._tag({name:r.Q,group:i.FORMAT}),this._command(r.Q),this._formatbar(this._("Quote"),a.Q)}},Oo=di;var Bo={de:{"Sample Output":"Beispielausgabe"}};var ui=class extends d{static get name(){return"sample"}static get dependencies(){return[u]}init(){this._i18n(Bo),this._tag({name:r.SAMP,group:i.FORMAT}),this._command(r.SAMP),this._formatbar(this._("Sample Output"),a.O)}},Do=ui;var hi=class extends L{constructor(e){super(e,At.name)}_prepareForm(){this.formCreator.addLegend(this._("Section")).addTextInput("class",this._("CSS class"),{placeholder:this._("Insert CSS class")})}},yo=hi;var Mo={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern",Section:"Sektion"}};var ci=class extends d{static get name(){return"section"}static get dependencies(){return[u]}init(){this._i18n(Mo),this._tag({name:r.SECTION,group:i.CONTAINER,children:[i.AUDIO,i.FIGURE,i.HEADING,i.IFRAME,i.IMAGE,i.LIST,i.PARAGRAPH,i.PREFORMAT,i.QUOTE,i.RULE,i.TABLE,i.VIDEO],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this.editor.dialogs.set(new yo(this.editor)),this._command(r.SECTION),this._toolbar(this._("Section"))}},At=ci;var Co={de:{small:"klein"}};var fi=class extends d{static get name(){return"small"}static get dependencies(){return[u]}init(){this._i18n(Co),this._tag({name:r.SMALL,group:i.FORMAT}),this._command(r.SMALL),this._formatbar(this._("small"),a.W)}},So=fi;var Po={de:{strikethrough:"durchgestrichen"}};var pi=class extends d{static get name(){return"strikethrough"}static get dependencies(){return[u]}init(){this._i18n(Po),this._tag({name:r.S,group:i.FORMAT}),this._command(r.S),this._formatbar(this._("strikethrough"),a.R)}},Fo=pi;var Uo={de:{"strongly emphasized":"stark betont"}};var gi=class extends d{static get name(){return"strong"}static get dependencies(){return[u]}init(){this._i18n(Uo),this._tag({name:r.STRONG,group:i.FORMAT}),this._command(r.STRONG),this._formatbar(this._("strongly emphasized"),a.S)}},Go=gi;var ko={de:{Subheading:"Unter\xFCberschrift"}};var bi=class extends d{static get name(){return"subheading"}static get dependencies(){return[u]}init(){this._i18n(ko),this._tag({name:r.H3,group:i.HEADING,deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:r.P}),this._command(r.H3),this._toolbar(this._("Subheading"))}},Ho=bi;var Ko={de:{subscript:"tiefgestellt"}};var Ei=class extends d{static get name(){return"subscript"}static get dependencies(){return[u]}init(){this._i18n(Ko),this._tag({name:r.SUB,group:i.FORMAT}),this._command(r.SUB),this._formatbar(this._("subscript"),a.X)}},Vo=Ei;var zo={de:{superscript:"hochgestellt"}};var Ti=class extends d{static get name(){return"superscript"}static get dependencies(){return[u]}init(){this._i18n(zo),this._tag({name:r.SUP,group:i.FORMAT}),this._command(r.SUP),this._formatbar(this._("superscript"),a.Y)}},vo=Ti;var ji=class extends k{constructor(e){super(e,C.name,r.TABLE)}insert({rows:e=1,cols:t=1}={}){let s=this.editor.dom.createElement(r.FIGURE,{attributes:{class:C.name}}),n=this.editor.dom.createElement(r.TABLE),h=this.editor.dom.createElement(r.TBODY);for(let f=0;f<e;f++){let E=this.editor.dom.createElement(r.TR);h.appendChild(E);for(let T=0;T<t;++T)E.appendChild(this.editor.dom.createElement(r.TD))}n.appendChild(h),s.appendChild(n),this.editor.dom.insert(s)}},qo=ji;var Li=class extends L{constructor(e){super(e,C.name)}_prepareForm(){this.formCreator.addLegend(this._("Table")).addNumberInput("rows",this._("Rows"),{min:"1",required:"required",value:"1"}).addNumberInput("cols",this._("Columns"),{min:"1",required:"required",value:"1"})}},Wo=Li;var Ai=class extends R{filter(e){e instanceof HTMLElement&&e.localName===r.FIGURE&&e.classList.contains(C.name)&&e.querySelector(":scope > "+r.TABLE)&&!e.querySelector(":scope > "+r.FIGCAPTION)?(e.insertAdjacentElement(j.BEFOREBEGIN,e.querySelector(":scope > "+r.TABLE)),e.parentElement.removeChild(e)):(e instanceof HTMLTableElement&&e.querySelector(`:scope > ${r.THEAD}, :scope > ${r.TFOOT}`)&&!e.querySelector(":scope > "+r.TBODY)||e instanceof HTMLTableSectionElement&&e.rows.length<=0||e instanceof HTMLTableRowElement&&!e.querySelector(`:scope > ${r.TH}:not(:empty), :scope > ${r.TD}:not(:empty)`))&&e.parentElement.removeChild(e)}},$o=Ai;var Z,xt,le,Ii,It,La,xi=class extends g{constructor(e){super(e);l(this,Z);l(this,le);l(this,It);this.editor.root.addEventListener("inserttable",this),this.editor.root.addEventListener("inserttd",this),this.editor.root.addEventListener("insertth",this)}inserttable(e){this.editor.dom.wrap(e.detail.element,r.FIGURE,{attributes:{class:C.name}}),e.detail.element.tBodies.length>0&&e.detail.element.tBodies[0].rows[0]&&(!e.detail.element.tHead||!e.detail.element.tFoot)&&(e.detail.element.tHead||c(this,Z,xt).call(this,e.detail.element.createTHead(),e.detail.element.tBodies[0].rows[0].cells.length),e.detail.element.tFoot||c(this,Z,xt).call(this,e.detail.element.createTFoot(),e.detail.element.tBodies[0].rows[0].cells.length))}inserttd(e){e.detail.element.addEventListener("keydown",this)}insertth(e){e.detail.element.addEventListener("keydown",this)}keydown(e){let t=e.target,s=t.parentElement,n=s.parentElement,h=n instanceof HTMLTableElement?n:n.parentElement,f=[a.LEFT,a.RIGHT,a.UP,a.DOWN],E=x(e,f),T=x(e,f,{ctrl:!0}),_=x(e,f,{alt:!0}),M=x(e,f,{alt:!0,shift:!0});if(t instanceof HTMLTableCellElement&&s instanceof HTMLTableRowElement&&(n instanceof HTMLTableElement||n instanceof HTMLTableSectionElement)&&h instanceof HTMLTableElement&&(E&&c(this,It,La).call(this,t,e.key)||T||_||M)){let N=t.cellIndex,F=s.cells.length,J=n.rows.length,S=n instanceof HTMLTableElement?s.rowIndex:s.sectionRowIndex,_t=N===0,Rt=N===F-1,ma=S===0,da=S===J-1,Si=s.rowIndex===0,Pi=s.rowIndex===h.rows.length-1;e.preventDefault(),e.stopPropagation(),E?e.key===a.LEFT&&!_t?this.editor.dom.focusEnd(s.cells[N-1]):e.key===a.LEFT&&Si?this.editor.dom.focusEnd(h.rows[h.rows.length-1].cells[F-1]):e.key===a.LEFT?this.editor.dom.focusEnd(h.rows[s.rowIndex-1].cells[F-1]):e.key===a.RIGHT&&!Rt?s.cells[N+1].focus():e.key===a.RIGHT&&Pi?h.rows[0].cells[0].focus():e.key===a.RIGHT?h.rows[s.rowIndex+1].cells[0].focus():e.key===a.UP&&Si?h.rows[h.rows.length-1].cells[N].focus():e.key===a.UP?h.rows[s.rowIndex-1].cells[N].focus():e.key===a.DOWN&&Pi?h.rows[0].cells[N].focus():e.key===a.DOWN&&h.rows[s.rowIndex+1].cells[N].focus():T?(e.key===a.LEFT&&F>1&&_t?Array.from(h.rows).forEach(A=>A.appendChild(A.cells[N])):e.key===a.LEFT&&F>1?Array.from(h.rows).forEach(A=>A.insertBefore(A.cells[N],A.cells[N-1])):e.key===a.RIGHT&&F>1&&Rt?Array.from(h.rows).forEach(A=>A.insertBefore(A.cells[N],A.cells[0])):e.key===a.RIGHT&&F>1?Array.from(h.rows).forEach(A=>A.insertBefore(A.cells[N+1],A.cells[N])):e.key===a.UP&&J>1&&ma?n.appendChild(s):e.key===a.UP&&J>1?n.insertBefore(s,n.rows[S-1]):e.key===a.DOWN&&J>1&&da?n.insertBefore(s,n.rows[0]):e.key===a.DOWN&&J>1&&n.insertBefore(n.rows[S+1],s),t.focus()):_?e.key===a.LEFT?Array.from(h.rows).forEach(A=>c(this,le,Ii).call(this,A,A.cells[N])):e.key===a.RIGHT?Array.from(h.rows).forEach(A=>c(this,le,Ii).call(this,A,A.cells[N+1])):e.key===a.UP?c(this,Z,xt).call(this,n,F,S):e.key===a.DOWN&&c(this,Z,xt).call(this,n,F,S+1):M&&(e.key===a.LEFT&&!_t?Array.from(h.rows).forEach(A=>A.deleteCell(N-1)):e.key===a.RIGHT&&!Rt?Array.from(h.rows).forEach(A=>A.deleteCell(N+1)):e.key===a.UP&&S>0?n.deleteRow(S-1):e.key===a.DOWN&&S<J-1&&n.deleteRow(S+1))}}};Z=new WeakSet,xt=function(e,t,s=0){let n=e.insertRow(s);for(let h=0;h<t;h++)c(this,le,Ii).call(this,n)},le=new WeakSet,Ii=function(e,t=null){let s=e.parentElement.localName===r.THEAD?r.TH:r.TD;e.insertBefore(this.editor.dom.createElement(s),t)},It=new WeakSet,La=function(e,t){if([a.UP,a.DOWN].includes(t))return!0;let s=this.editor.dom.getSelection(),n=s.anchorNode instanceof HTMLElement&&s.anchorNode;if(!s.isCollapsed)return!1;if(t===a.LEFT){let f=e.firstChild;return f instanceof HTMLElement&&(f=f.firstChild),s.anchorOffset===0&&[e,f].includes(n)}let h=e.lastChild;return e.lastChild instanceof HTMLBRElement&&e.lastChild.previousSibling&&(h=e.lastChild.previousSibling),h instanceof HTMLElement&&(h=h.lastChild),s.anchorOffset===n.textContent.length&&[e,h].includes(n)};var Qo=xi;var Yo={de:{Cancel:"Abbrechen",Columns:"Spalten",Rows:"Zeilen",Save:"Speichern",Table:"Tabelle"}};var Ni=class extends d{static get name(){return"table"}static get dependencies(){return[u,P,D]}init(){this._i18n(Yo),this._tag({name:r.TABLE,group:i.TABLE,children:[i.TABLESECTION],deletable:!0,navigable:!0}),this._tag({name:r.THEAD,group:i.TABLESECTION,children:[i.TABLEROW]}),this._tag({name:r.TBODY,group:i.TABLESECTION,children:[i.TABLEROW]}),this._tag({name:r.TFOOT,group:i.TABLESECTION,children:[i.TABLEROW]}),this._tag({name:r.TR,group:i.TABLEROW,children:[i.TABLECELL]}),this._tag({name:r.TH,group:i.TABLECELL,children:[i.BREAK,i.FORMAT],editable:!0,empty:!0}),this._tag({name:r.TD,group:i.TABLECELL,children:[i.BREAK,i.FORMAT],editable:!0,empty:!0}),new Qo(this.editor),this.editor.filters.add(new $o(this.editor)),this.editor.dialogs.set(new Wo(this.editor)),this.editor.commands.set(new qo(this.editor)),this._toolbar(this._("Table"))}},C=Ni;var _i=class extends L{constructor(e){super(e,Nt.name)}_prepareForm(){this.formCreator.addLegend(this._("Data")).addTextInput("datetime",this._("Machine-readable Datetime"),{placeholder:this._("Insert date/time or leave empty to remove it")})}},Zo=_i;var Jo={de:{Cancel:"Abbrechen","Insert date/time or leave empty to remove it":"Datum/Zeit eingeben oder zum Entfernen leer lassen","Machine-readable Datetime":"Maschinenlesbare Datums-/Zeitangabe",Save:"Speichern",Time:"Zeit"}};var Ri=class extends d{static get name(){return"time"}static get dependencies(){return[u]}init(){this._i18n(Jo),this._tag({name:r.TIME,group:i.FORMAT,attributes:["datetime"]}),this.editor.dialogs.set(new Zo(this.editor)),this._command(r.TIME),this._formatbar(this._("Time"),a.T)}},Nt=Ri;var Xo={de:{underline:"unterstrichen"}};var wi=class extends d{static get name(){return"underline"}static get dependencies(){return[u]}init(){this._i18n(Xo),this._tag({name:r.U,group:i.FORMAT}),this._command(r.U),this._formatbar(this._("underline"),a.U)}},ea=wi;var ta={de:{"Unordered List":"Ungeordnete Liste"}};var Oi=class extends d{static get name(){return"unorderedlist"}static get dependencies(){return[u,Lt]}init(){this._i18n(ta),this._tag({name:r.UL,group:i.LIST,children:[i.LISTITEM],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command(r.UL),this._toolbar(this._("Unordered List"))}},ra=Oi;var ia={de:{Variable:"Variable"}};var Bi=class extends d{static get name(){return"variable"}static get dependencies(){return[u]}init(){this._i18n(ia),this._tag({name:r.VAR,group:i.FORMAT}),this._command(r.VAR),this._formatbar(this._("Variable"),a.V)}},sa=Bi;var Di=class extends L{constructor(e,t=void 0){super(e,me.name,t)}_prepareForm(){this.formCreator.addLegend(this._("Video")).addTextInput("src",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to video"),required:"required"}).addNumberInput("width",this._("Width")).addNumberInput("height",this._("Height"))}},oa=Di;var Ye,aa,yi=class extends g{constructor(e){super(e);l(this,Ye);this.editor.root.addEventListener("sethtml",this),this.editor.root.addEventListener("insertvideo",this)}sethtml(e){Array.from(e.detail.element.getElementsByTagName(r.VIDEO)).forEach(t=>c(this,Ye,aa).call(this,t))}insertvideo(e){c(this,Ye,aa).call(this,e.detail.element)}};Ye=new WeakSet,aa=function(e){let t=e.getAttribute("src");t?(e.setAttribute("src",this.editor.url(t)),e.controls=!0,this.editor.dom.wrap(e,r.FIGURE,{attributes:{class:me.name}})):e.parentElement.removeChild(e)};var na=yi;var la={de:{Cancel:"Abbrechen",Height:"H\xF6he","Insert URL to video":"URL zur Videodatei eingeben",Save:"Speichern",URL:"URL",Video:"Video",Width:"Breite"}};var Mi=class extends d{static get name(){return"video"}static get dependencies(){return[u,D]}static get config(){return{browser:void 0}}init(){this._i18n(la),this._tag({name:r.VIDEO,group:i.VIDEO,attributes:["controls","height","src","width"],empty:!0,navigable:!0}),new na(this.editor),this.editor.dialogs.set(new oa(this.editor,this.editor.config.video.browser)),this._command(r.VIDEO),this._toolbar(this._("Video"))}},me=Mi;var Ci=class extends B{static get defaultConfig(){return{base:{plugins:[ws,no,Go,qs,ea,Fo,jt,go,So,Ps,ht,Oo,Bs,ys,mo,Do,sa,Vo,vo,Nt,bt,oo,Us,Io,$s,Ho,ra,jo,Ys,Q,ne,me,oe,ae,C,Y,At,Et,Tt,pt]}}}},fb=Ci;export{fb as default};
