class y{constructor(a,b,c=null){this._editor=void 0,this.name=void 0,this._tag=null,this._dialog=null;if(!(a instanceof v)||!b||typeof b!=="string"||c&&typeof c!=="string")throw"Invalid argument";this._editor=a,this.name=b,this._tag=c?this._editor.tags.get(c):null,this._dialog=this._editor.dialogs.get(b)}execute(){this._dialog?this._openDialog():this._insert(this._selectedAttributes())}_insert(a={}){if(this._tag){Object.keys(a).forEach(c=>this._tag.attributes.includes(c)&&a[c]||delete a[c]);const b=this._selectedElement();this._tag.group!=="format"?this._editor.insert(this._editor.createElement(this._tag.name,{attributes:a})):b&&Object.keys(a).length>0?b.parentElement.replaceChild(this._editor.createElement(this._tag.name,{attributes:a,html:b.textContent}),b):b?b.parentElement.replaceChild(this._editor.createText(b.textContent),b):this._editor.format(this._editor.createElement(this._tag.name,{attributes:a}))}}_openDialog(){this._dialog.open(a=>this._insert(a),this._selectedAttributes())}_selectedElement(){var a;const b=this._editor.getSelectedElement();return b&&b.localName===((a=this._tag)==null?void 0:a.name)?b:null}_selectedAttributes(){const a=this._selectedElement(),b={};return a&&this._tag&&Array.from(a.attributes).forEach(c=>{this._tag.attributes.includes(c.nodeName)&&(b[c.nodeName]=c.nodeValue)}),b}}class I{constructor(a=[]){this.__items=new Map(),a.forEach(b=>this.set(b))}get(a){return this.__items.get(a)||null}set(a){if(!(a instanceof y))throw"Invalid argument";this.__items.set(a.name,a)}execute(a){this.get(a).execute()}}class J{constructor(a=[]){this.__items=new Map(),a.forEach(b=>this.set(b))}get(a){return this.__items.get(a)||null}set(a){if(!(a instanceof p))throw"Invalid argument";this.__items.set(a.name,a)}}class z{constructor(a){this.__element=void 0;if(!(a instanceof HTMLElement))throw"Invalid argument";this.__element=a,this.register(this.__observe.bind(this))}dispatch(a,b,c){if(!a||typeof a!=="string"||!(b instanceof HTMLElement)||!(c instanceof HTMLElement))throw"Invalid argument";this.__element.dispatchEvent(new CustomEvent(a,{detail:{element:b,target:c}}))}register(a,b={childList:!0,subtree:!0}){if(typeof a!=="function")throw"Invalid argument";const c=new MutationObserver(a);c.observe(this.__element,b)}__dispatch(a,b,c){b instanceof HTMLElement&&c instanceof HTMLElement&&(this.dispatch(a,b,c),this.dispatch(`${a}${b.localName.replace("-","")}`,b,c))}__observe(a){a.forEach(b=>{b.addedNodes.forEach(c=>{c instanceof HTMLElement&&(this.__dispatch("insert",c,b.target),Array.from(c.getElementsByTagName("*")).forEach(d=>this.__dispatch("insert",d,b.target)))}),b.removedNodes.forEach(c=>c instanceof HTMLElement&&this.__dispatch("delete",c,b.target))})}}class t{constructor(a){this._editor=void 0;if(!(a instanceof v))throw"Invalid argument";this._editor=a}filter(a){throw"Not implemented"}}class K{constructor(){this.__items=new Set()}add(a){if(!(a instanceof t))throw"Invalid argument";this.__items.add(a)}filter(a){if(!(a instanceof HTMLElement))throw"Invalid argument";this.__items.forEach(b=>{a.normalize(),b.filter(a)})}}var L=Object.prototype.hasOwnProperty,C=Object.getOwnPropertySymbols,M=Object.prototype.propertyIsEnumerable,N=(a,b)=>{var c={};for(var d in a)L.call(a,d)&&b.indexOf(d)<0&&(c[d]=a[d]);if(a!=null&&C)for(var d of C(a))b.indexOf(d)<0&&M.call(a,d)&&(c[d]=a[d]);return c};class D{constructor(a={}){this.name=void 0,this.group=void 0,this.children=[],this.attributes=[],this.alignable=!1,this.arbitrary=!1,this.deletable=!1,this.editable=!1,this.empty=!1,this.focusable=!1,this.navigable=!1,this.slotable=!1,this.sortable=!1,this.enter=null;var{name:b,group:c}=a,d=N(a,["name","group"]);const e=g=>g&&typeof g==="string",j=g=>typeof g==="undefined"||g&&typeof g==="string",f=g=>typeof g==="undefined"||Array.isArray(g)&&!g.find(n=>!e(n));if(!e(b)||!e(c)||!j(d.enter)||!f(d.children)||!f(d.attributes))throw"Invalid argument";this.name=b,this.group=c,this.children=d.children||[],this.attributes=d.attributes||[],this.arbitrary=d.arbitrary===!0,this.alignable=d.alignable===!0,this.deletable=d.deletable===!0,this.editable=d.editable===!0,this.empty=d.empty===!0,this.focusable=d.focusable===!0,this.navigable=d.navigable===!0,this.slotable=d.slotable===!0,this.sortable=d.sortable===!0,this.enter=d.enter||null}}class h{constructor(a){this._editor=void 0;if(!(a instanceof v))throw"Invalid argument";this._editor=a}static get name(){throw"Missing plugin name"}static get dependencies(){return[]}static get config(){return{}}init(){throw"Not implemented"}_(a){return this._editor.translator.translate(this.constructor.name,a)}_i18n(a){a[this._editor.config.base.lang]&&this._editor.translator.set(this.constructor.name,a[this._editor.config.base.lang])}_command(a){this._editor.commands.set(new y(this._editor,this.constructor.name,a))}_tag(a){this._editor.tags.set(new D(a))}_toolbar(a,b=null,c=!1){if(!a||typeof a!=="string"||b&&typeof b!=="string")throw"Invalid argument";a=this._(a);const d=this._editor.createElement("button",{attributes:{type:"button","data-command":this.constructor.name,title:a,"data-key":b},html:a});c?this._editor.formats.appendChild(d):this._editor.toolbar.appendChild(d)}}class O{constructor(a=[]){this.__items=new Map(),a.forEach(b=>this.set(b))}get(a){return this.__items.get(a)||null}set(a){if(!(a instanceof h))throw"Invalid argument";this.__items.set(a.constructor.name,a)}init(){this.__items.forEach(a=>a.init())}}class P{constructor(a=[]){this.__items=new Map(),a.forEach(b=>this.set(b))}get(a){return this.__items.get(a instanceof HTMLElement?a.localName:a)||null}set(a){if(!(a instanceof D))throw"Invalid argument";this.__items.set(a.name,a)}allowed(a,b,c=!1){var d,e;const j=c?b:(d=this.get(b))==null?void 0:d.group;return!!((e=this.get(a))==null?void 0:e.children.includes(j))}}class Q{constructor(){this.__items=new Map()}get(a){return this.__items.get(a)||null}set(a,b){if(!a||typeof a!=="string"||!(b instanceof Object))throw"Invalid argument";this.__items.set(a,b)}translate(a,b){var c;return((c=this.get(a))==null?void 0:c[b])||b}}class v{constructor(a,b={}){this.orig=void 0,this.document=void 0,this.window=void 0,this.element=void 0,this.toolbar=void 0,this.toolbarEvents=void 0,this.formats=void 0,this.formatsEvents=void 0,this.root=void 0,this.rootEvents=void 0,this.config={},this.translator=new Q(),this.tags=new P(),this.filters=new K(),this.dialogs=new J(),this.commands=new I(),this.plugins=new O();if(!(a instanceof HTMLElement)||!(b instanceof Object))throw"Invalid argument";this.orig=a,this.document=this.orig.ownerDocument,this.window=this.document.defaultView,this.element=this.createElement("akilli-editor"),this.toolbar=this.createElement("editor-toolbar",{attributes:{role:"toolbar"}}),this.element.appendChild(this.toolbar),this.toolbarEvents=new z(this.toolbar),this.formats=this.createElement("editor-formats",{attributes:{role:"toolbar"}}),this.formats.hidden=!0,this.element.appendChild(this.formats),this.formatsEvents=new z(this.formats),this.root=this.createElement("editor-root"),this.element.appendChild(this.root),this.rootEvents=new z(this.root),this.config=b}static get defaultConfig(){return{}}init(){var a,b;const c=this.config;this.config={};const d=((a=this.constructor.defaultConfig.base)==null?void 0:a.plugins)||[];let e=d;Array.isArray((b=c.base)==null?void 0:b.plugins)&&c.base.plugins.length>0&&(e=[],c.base.plugins.forEach(g=>{const n=d.find(q=>q.name===g);n&&e.push(n)}));const j=new Set(),f=g=>{g.dependencies&&g.dependencies.forEach(f),j.add(g)};e.map(f),j.forEach(g=>{Object.entries(g.config).forEach(([n,q])=>{var k,o;this.config.hasOwnProperty(g.name)||(this.config[g.name]={}),this.config[g.name][n]=((k=c[g.name])==null?void 0:k[n])||((o=this.constructor.defaultConfig[g.name])==null?void 0:o[n])||q}),this.plugins.set(new g(this))}),this.plugins.init()}load(){this.orig instanceof HTMLTextAreaElement?(this.orig.form.addEventListener("submit",()=>this.save()),this.setHtml(this.orig.value.replace("/&nbsp;/g"," "))):this.setHtml(this.orig.innerHTML),this.orig.insertAdjacentElement("afterend",this.element),this.orig.hidden=!0}destroy(){this.element.parentElement.removeChild(this.element),this.orig.hidden=!1}getHtml(){const a=this.createElement(this.root.localName,{html:this.root.innerHTML});return this.filters.filter(a),this.rootEvents.dispatch("gethtml",a,this.root),a.innerHTML}setHtml(a){const b=this.createElement(this.root.localName,{html:a});this.rootEvents.dispatch("sethtml",b,this.root),this.filters.filter(b),this.root.innerHTML=b.innerHTML}save(){this.orig instanceof HTMLTextAreaElement?this.orig.value=this.getHtml():this.orig.innerHTML=this.getHtml()}insert(a){var b;if(!(a instanceof HTMLElement))throw"Invalid argument";const c=this.getSelectedEditable();if(c&&c instanceof HTMLSlotElement&&this.tags.allowed(c.parentElement,a))c.insertAdjacentElement("beforebegin",a);else if(c)(b=this.closest(c,a))==null||b.insertAdjacentElement("afterend",a),c.hasAttribute("data-deletable")&&!c.textContent.trim()&&c.parentElement.removeChild(c);else if(this.tags.allowed(this.root,a))this.root.appendChild(a);else throw"Invalid argument"}insertText(a){const b=this.getSelectedEditable();if(b){const c=this.window.getSelection().getRangeAt(0);c.deleteContents(),c.insertNode(this.createText(a)),c.collapse(),b.normalize()}}format(a){if(!(a instanceof HTMLElement))throw"Invalid argument";const b=this.window.getSelection(),c=b.rangeCount>0?b.getRangeAt(0):null,d=this.getSelectedEditable();if(!c||c.collapsed||!c.toString().trim()||!d||!this.tags.allowed(d,a))return;c.startContainer instanceof Text&&c.startContainer.parentElement!==d&&c.setStartBefore(c.startContainer.parentElement),c.endContainer instanceof Text&&c.endContainer.parentElement!==d&&c.setEndAfter(c.endContainer.parentElement);const e=c.toString(),j=Array.from(c.cloneContents().childNodes).every(f=>f instanceof Text&&!f.textContent.trim()||f instanceof HTMLElement&&f.localName===a.localName);c.deleteContents(),j?c.insertNode(this.createText(e)):(a.textContent=e,c.insertNode(a)),d.normalize()}arbitrary(a){return a instanceof HTMLElement&&(a===this.root||a.hasAttribute("data-arbitrary"))}closest(a,b){if(!(a instanceof HTMLElement)||!this.contains(a.parentElement))throw"Invalid argument";let c=a,d=a.parentElement;do if(this.arbitrary(d)&&this.tags.allowed(d,b))return c;while((c=d)&&(d=d.parentElement)&&this.contains(d));return null}wrap(a,b,c={}){let d;if(a instanceof HTMLElement){if(a.parentElement.localName!==b&&(d=this.closest(a,b))){const e=this.createElement(b,c);d.insertAdjacentElement("afterend",e),e.appendChild(a)}}else throw"Invalid argument"}contains(a){var b;if(!(a instanceof HTMLElement))throw"Invalid argument";return this.root.contains(a)||((b=a.closest(this.root.localName))==null?void 0:b.parentElement)===null}registerElement(a,b,c=null){typeof this.window.customElements.get(a)==="undefined"&&this.window.customElements.define(a,b,c?{extends:c}:null)}createElement(a,{attributes:b={},html:c=""}={}){const d=this.document.createElement(a);return d.innerHTML=c,Object.entries(b).forEach(([e,j])=>j&&d.setAttribute(e,`${j}`)),d}createText(a){return this.document.createTextNode(a)}getSelectedElement(){try{const a=this.window.getSelection(),b=a.anchorNode instanceof Text?a.anchorNode.parentElement:a.anchorNode,c=a.focusNode instanceof Text?a.focusNode.parentElement:a.focusNode;if(b instanceof HTMLElement&&c instanceof HTMLElement&&b===c&&this.contains(b))return b}catch(a){this.window.console.error(a)}return null}getSelectedEditable(){try{const a=this.window.getSelection(),b=a.anchorNode instanceof Text?a.anchorNode.parentElement:a.anchorNode,c=a.focusNode instanceof Text?a.focusNode.parentElement:a.focusNode;if(b instanceof HTMLElement&&c instanceof HTMLElement){const d=b.closest("[contenteditable=true]"),e=c.closest("[contenteditable=true]");if(d instanceof HTMLElement&&d===e&&this.contains(d))return d}}catch(a){this.window.console.error(a)}return null}focusEnd(a){if(!(a instanceof HTMLElement))throw"Invalid argument";const b=this.document.createRange(),c=this.window.getSelection();a.focus(),b.selectNodeContents(a),b.collapse(),c.removeAllRanges(),c.addRange(b)}isKey(a,b,{alt:c=!1,ctrl:d=!1,shift:e=!1}={}){return(Array.isArray(b)&&b.includes(a.key)||a.key===b)&&a.altKey===c&&a.ctrlKey===d&&a.shiftKey===e}url(a){const b=this.window.origin||this.window.location.origin,c=this.createElement("a",{attributes:{href:a}});return b===c.origin?c.pathname:c.href}static create(a,b={}){const c=new this(a,b);return c.init(),c.load(),c}}class p{constructor(a,b){this._editor=void 0,this.name=void 0;if(!(a instanceof v)||!b||typeof b!=="string")throw"Invalid argument";this._editor=a,this.name=b}open(a,b={}){const c=()=>Array.from(this._editor.element.getElementsByTagName("editor-dialog")).forEach(k=>{k.parentElement.removeChild(k)}),d=this._editor.window.getSelection(),e=d.rangeCount>0?d.getRangeAt(0):null,j=()=>{e&&(d.removeAllRanges(),d.addRange(e)),c()};c();const f=this._editor.createElement("form"),g=this._editor.createElement("fieldset"),n=this._editor.createElement("button",{attributes:{type:"button"},html:this._("Cancel")});n.addEventListener("click",j),f.appendChild(g),f.appendChild(n),f.appendChild(this._editor.createElement("button",{html:this._("Save")})),this._initFieldset(g),f.addEventListener("submit",k=>{k.preventDefault(),k.stopPropagation(),j();const o={};Array.from(g.elements).forEach(s=>o[s.name]=s.value),a(o)}),Object.entries(b).forEach(([k,o])=>g.elements[k]&&(g.elements[k].value=o));const q=this._editor.createElement("editor-dialog");q.addEventListener("close",j),q.appendChild(f),q.show(),this._editor.element.appendChild(q)}_(a){return this._editor.translator.translate(this.name,a)}_initFieldset(a){throw"Not implemented"}_createInput(a,b,c,d={}){if(!a||typeof a!=="string"||!b||typeof b!=="string"||!c||typeof c!=="string")throw"Invalid argument";Object.assign(d,{id:`editor-${a}`,name:a,type:b});const e=this._editor.createElement("div");return e.appendChild(this._editor.createElement("label",{attributes:{for:d.id},html:c})),e.appendChild(this._editor.createElement("input",{attributes:d})),d.required&&e.setAttribute("data-required",""),e}}class R extends p{constructor(a){super(a,"abbreviation")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Abbreviation")})),a.appendChild(this._createInput("title","text",this._("Full term"),{placeholder:this._("Insert full term or leave empty to remove it")}))}}class m{constructor(a){this._editor=void 0;if(!(a instanceof v))throw"Invalid argument";this._editor=a}handleEvent(a){typeof this[a.type]==="function"&&this[a.type](a)}}class S extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){a.detail.element.hasAttribute("data-alignable")&&a.detail.element.addEventListener("keydown",this)}keydown(a){const b={ArrowUp:null,ArrowLeft:"left",ArrowDown:"center",ArrowRight:"right"};a.target===a.currentTarget&&this._editor.isKey(a,Object.keys(b),{shift:!0})&&(a.preventDefault(),a.stopPropagation(),a.target.classList.remove(...Object.values(b)),b[a.key]&&a.target.classList.add(b[a.key]))}}class T extends t{filter(a){const b=this._editor.tags.get(a),c=this._editor.tags.allowed(a,"p"),d=b.editable||b.group==="format";let e=[];const j=(f=null)=>{c&&e.length>0&&(a.insertBefore(this._editor.createElement("p",{html:e.join(" ")}),f),e=[])};Array.from(a.childNodes).forEach(f=>{const g=f.textContent.trim();if(f instanceof HTMLElement){f=this.__convert(f);const n=this._editor.tags.get(f);n&&this._editor.tags.allowed(a,f)?(j(f),this.__element(f,n)):n&&n.group==="format"&&c?(f=this.__element(f,n))&&(e.push(f.outerHTML),a.removeChild(f)):!d&&g&&c?(e.push(g),a.removeChild(f)):d&&g?a.replaceChild(this._editor.createText(g),f):a.removeChild(f)}else f instanceof Text?(!d&&g&&c&&e.push(g),(!d||!g)&&a.removeChild(f)):f instanceof Node&&a.removeChild(f)}),j()}__convert(a){const b=this._editor.config.base.filter[a.localName];if(!b)return a;const c=this._editor.createElement(b,{html:a.innerHTML});return a.parentElement.replaceChild(c,a),c}__element(a,b){return Array.from(a.attributes).forEach(c=>!b.attributes.includes(c.name)&&a.removeAttribute(c.name)),a.hasChildNodes()&&this._editor.filters.filter(a),a.hasChildNodes()||b.empty?a:(a.parentElement.removeChild(a),null)}}class U extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){a.detail.element.hasAttribute("data-deletable")&&a.detail.element.addEventListener("keydown",this)}keydown(a){a.target===a.currentTarget&&this._editor.isKey(a,"Delete",{ctrl:!0})&&(a.target.previousElementSibling instanceof HTMLElement&&this._editor.focusEnd(a.target.previousElementSibling),a.target.parentElement.removeChild(a.target),a.preventDefault(),a.stopPropagation())}}class V extends HTMLElement{constructor(){super();this.addEventListener("keydown",a=>a.key==="Escape"&&this.close()),this.addEventListener("click",a=>a.target===this&&this.close())}connectedCallback(){this.setAttribute("role","dialog"),this.tabIndex=-1,this.focus()}get open(){return this.hasAttribute("open")}set open(a){a===!0?this.setAttribute("open",""):this.removeAttribute("open")}show(){this.open=!0,this.dispatchEvent(new CustomEvent("show",{detail:{element:this,target:this}}))}close(){this.open=!1,this.dispatchEvent(new CustomEvent("close",{detail:{element:this,target:this}}))}}class W extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){a.detail.element.contentEditable==="true"&&a.detail.element.addEventListener("keydown",this)}keydown(a){var b,c,d,e;if(this._editor.isKey(a,"Enter",{shift:!0})&&!this._editor.tags.allowed(a.target,"br"))a.preventDefault(),a.stopPropagation();else if(this._editor.isKey(a,"Enter")){a.preventDefault(),a.stopPropagation();const j=(b=this._editor.tags.get(a.target))==null?void 0:b.enter;j&&(a.target.textContent.trim()||!a.target.hasAttribute("data-deletable")?(c=this._editor.closest(a.target,j))==null||c.insertAdjacentElement("afterend",this._editor.createElement(j)):a.target instanceof HTMLParagraphElement||((d=this._editor.closest(a.target,"p"))==null||d.insertAdjacentElement("afterend",this._editor.createElement("p")),a.target.parentElement.removeChild(a.target)))}else this._editor.isKey(a,"Backspace")&&!a.target.textContent&&a.target.hasAttribute("data-deletable")?(a.target.previousElementSibling instanceof HTMLElement&&this._editor.focusEnd(a.target.previousElementSibling),a.target.parentElement.removeChild(a.target),a.preventDefault(),a.stopPropagation()):/^[A-Z]$/.test(a.key)&&this._editor.isKey(a,a.key,{alt:!0,shift:!0})&&(a.preventDefault(),a.stopPropagation(),(e=this._editor.formats.querySelector(`button[data-key=${a.key.toLowerCase()}]`))==null||e.click())}}class X extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){a.detail.element.hasAttribute("data-focusable")&&a.detail.element.focus()}}class Y extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){a.detail.element.hasAttribute("data-navigable")&&(a.detail.element.tabIndex=0,a.detail.element.addEventListener("keydown",this))}keydown(a){if(a.target===a.currentTarget&&this._editor.isKey(a,["ArrowUp","ArrowDown","Home","End"])&&this.__enabled(a.target)){const b=a.target.previousElementSibling,c=a.target.nextElementSibling,d=a.target.parentElement.firstElementChild,e=a.target.parentElement.lastElementChild,j=a.target===d,f=a.target===e;a.key==="ArrowUp"&&!j&&b.hasAttribute("data-navigable")?b.focus():a.key==="ArrowDown"&&!f&&c.hasAttribute("data-navigable")?c.focus():(a.key==="Home"||a.key==="ArrowDown"&&f)&&d.hasAttribute("data-navigable")?d.focus():(a.key==="End"||a.key==="ArrowUp"&&j)&&e.hasAttribute("data-navigable")&&e.focus(),a.preventDefault(),a.stopPropagation()}}__enabled(a){if(a.contentEditable!=="true")return!0;const b=this._editor.window.getSelection(),c=this._editor.getSelectedEditable(),d=this._editor.getSelectedElement();return b.isCollapsed&&b.anchorOffset===0&&[c,a.firstChild].includes(d)}}class Z extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){a.detail.element instanceof HTMLSlotElement?a.detail.element.addEventListener("keydown",this):a.detail.element.hasAttribute("data-slotable")&&!a.detail.element.querySelector(":scope > slot")&&a.detail.element.appendChild(this._editor.createElement("slot"))}keydown(a){a.preventDefault(),a.stopPropagation()}}class _ extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){a.detail.element.hasAttribute("data-sortable")&&(a.detail.element.addEventListener("keydown",this),a.detail.element.addEventListener("pointerdown",this),a.detail.element.addEventListener("pointermove",this),a.detail.element.addEventListener("pointerup",this))}keydown(a){if(a.target===a.currentTarget&&this._editor.isKey(a,["ArrowUp","ArrowDown","Home","End"],{ctrl:!0})){const b=a.target.parentElement,c=a.target.previousElementSibling,d=a.target.nextElementSibling,e=b.firstElementChild,j=b.lastElementChild,f=a.target===e,g=a.target===j;a.key==="ArrowUp"&&!f&&c.hasAttribute("data-sortable")?(c.insertAdjacentHTML("beforebegin",a.target.outerHTML),b.removeChild(a.target)):a.key==="ArrowDown"&&!g&&d.hasAttribute("data-sortable")?(d.insertAdjacentHTML("afterend",a.target.outerHTML),b.removeChild(a.target)):(a.key==="Home"&&!f||a.key==="ArrowDown"&&g)&&e.hasAttribute("data-sortable")?(e.insertAdjacentHTML("beforebegin",a.target.outerHTML),b.removeChild(a.target)):(a.key==="End"&&!g||a.key==="ArrowUp"&&f)&&j.hasAttribute("data-sortable")&&(j.insertAdjacentHTML("afterend",a.target.outerHTML),b.removeChild(a.target)),a.preventDefault(),a.stopPropagation()}}pointerdown(a){a.target.hasAttribute("data-sortable")&&(a.target.setAttribute("data-sort",""),a.target.setPointerCapture(a.pointerId))}pointermove(a){const b=this._editor.document.elementFromPoint(a.x,a.y);this.__sortover(),this.__droppable(a.target,b)&&b.setAttribute("data-sortover","")}pointerup(a){if(a.target.hasAttribute("data-sortable")){const b=this._editor.document.elementFromPoint(a.x,a.y);this.__sortover(),a.target.removeAttribute("data-sort"),a.target.releasePointerCapture(a.pointerId),this.__droppable(a.target,b)&&b.insertAdjacentElement("beforebegin",a.target)}}__sortover(){this._editor.root.querySelectorAll("[data-sortover]").forEach(a=>a.removeAttribute("data-sortover"))}__droppable(a,b){return a instanceof HTMLElement&&b instanceof HTMLElement&&this._editor.contains(b)&&![this._editor.root,a].includes(b)&&b.hasAttribute("data-sortable")&&(a.parentElement===b.parentElement||this._editor.arbitrary(a.parentElement)&&this._editor.arbitrary(b.parentElement))&&this._editor.tags.allowed(b.parentElement,a)}}class $ extends m{constructor(a){super(a);this._editor.root.addEventListener("insert",this)}insert(a){const b=this._editor.tags.get(a.detail.element);b&&(b.editable&&(a.detail.element.contentEditable="true"),["alignable","arbitrary","deletable","focusable","navigable","slotable","sortable"].forEach(c=>{b[c]&&(a.detail.element.dataset[c]="")}))}}class aa extends m{constructor(a){super(a);this._editor.toolbar.addEventListener("insertbutton",this),this._editor.formats.addEventListener("insertbutton",this),this._editor.document.addEventListener("selectionchange",this)}insertbutton(a){const b=a.detail.element.getAttribute("data-key");if(b){const c=this._editor.translator.translate("base","Alt"),d=this._editor.translator.translate("base","Shift");a.detail.element.title+=` [${c} + ${d} + ${b}]`}a.detail.element.getAttribute("data-command")&&a.detail.element.addEventListener("click",this),a.detail.element.parentElement===this._editor.toolbar&&(a.detail.element.tabIndex=-1,a.detail.element.addEventListener("keydown",this))}click(a){this._editor.commands.execute(a.target.getAttribute("data-command"))}keydown(a){if(this._editor.isKey(a,["ArrowLeft","ArrowRight","Home","End"])){const b=a.target.previousElementSibling,c=a.target.nextElementSibling,d=a.target.parentElement.firstElementChild,e=a.target.parentElement.lastElementChild,j=a.target===d,f=a.target===e;a.key==="ArrowLeft"&&!j?b.focus():a.key==="ArrowRight"&&!f?c.focus():a.key==="Home"||a.key==="ArrowRight"&&f?d.focus():(a.key==="End"||a.key==="ArrowLeft"&&j)&&e.focus(),a.preventDefault(),a.stopPropagation()}}selectionchange(){const a=this._editor.getSelectedEditable();a&&!this._editor.window.getSelection().isCollapsed&&this._editor.tags.allowed(a,"format",!0)?(this._editor.formats.hidden=!1,this._editor.formats.style.top=`${a.offsetTop+a.offsetParent.offsetTop-this._editor.formats.clientHeight}px`):(this._editor.formats.hidden=!0,this._editor.formats.removeAttribute("style"))}}const ba={de:{Alt:"Alt",Shift:"Umschalt"}};class i extends h{static get name(){return"base"}static get config(){return{browser:{},filter:{},lang:null,plugins:[]}}init(){this._i18n(ba),this._editor.registerElement("editor-dialog",V),this._tag({name:"editor-root",group:"root",children:["audio","block","container","figure","heading","iframe","image","list","paragraph","preformat","quote","rule","table","video"]}),this._tag({name:"slot",group:"slot",editable:!0,focusable:!0,navigable:!0,sortable:!0}),new aa(this._editor),new $(this._editor),new W(this._editor),new U(this._editor),new Y(this._editor),new _(this._editor),new S(this._editor),new X(this._editor),new Z(this._editor),this._editor.filters.add(new T(this._editor))}}const ca={de:{Abbreviation:"Abkürzung",Cancel:"Abbrechen","Full term":"Langform","Insert full term or leave empty to remove it":"Langform eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};class da extends h{static get name(){return"abbreviation"}static get dependencies(){return[i]}init(){this._i18n(ca),this._tag({name:"abbr",group:"format",attributes:["title"]}),this._editor.dialogs.set(new R(this._editor)),this._command("abbr"),this._toolbar("Abbreviation","a",!0)}}class ea extends p{constructor(a){super(a,"audio")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Audio")})),a.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to audio"),required:"required"}))}}class fa extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("insertaudio",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("audio")).forEach(b=>this.__init(b))}insertaudio(a){this.__init(a.detail.element)}__init(a){const b=a.getAttribute("src");b?(a.setAttribute("src",this._editor.url(b)),a.controls=!0,this._editor.wrap(a,"figure",{attributes:{class:"audio"}})):a.parentElement.removeChild(a)}}class w extends p{constructor(a,b,c){super(a,b);this.__url=void 0,this.opts=Object.assign({alwaysRaised:"yes",dependent:"yes",height:`${this._editor.window.screen.height}`,location:"no",menubar:"no",minimizable:"no",modal:"yes",resizable:"yes",scrollbars:"yes",toolbar:"no",width:`${this._editor.window.screen.width}`},this._editor.config.base.browser);if(!c||typeof c!=="string")throw"Invalid argument";this.__url=c}open(a,b={}){const c=Object.entries(this.opts).map(f=>`${f[0]}=${f[1]}`).join(","),d=this._editor.createElement("a",{attributes:{href:this.__url}}),e=new URL(d.href);Object.entries(b).forEach(([f,g])=>e.searchParams.set(f,`${g}`));const j=this._editor.window.open(e.toString(),this.name,c);this._editor.window.addEventListener("message",f=>{f.origin===e.origin&&f.source===j&&(a(f.data),j.close())},!1)}}class ga extends t{filter(a){a.querySelectorAll("figure > figcaption:only-child").forEach(b=>b.parentElement.removeChild(b))}}class ha extends m{constructor(a){super(a);this._editor.root.addEventListener("insertfigure",this)}insertfigure(a){a.detail.element.querySelector(":scope > figcaption")||a.detail.element.appendChild(this._editor.createElement("figcaption"))}}class u extends h{static get name(){return"figure"}static get dependencies(){return[i]}init(){this._tag({name:"figure",group:"figure",children:["audio","caption","iframe","image","preformat","quote","table","video"],attributes:["class"],alignable:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._tag({name:"figcaption",group:"caption",children:["format"],editable:!0,navigable:!0,enter:"p"}),new ha(this._editor),this._editor.filters.add(new ga(this._editor))}}const ia={de:{Audio:"Audio",Cancel:"Abbrechen","Insert URL to audio":"URL zur Audiodatei eingeben",Save:"Speichern",URL:"URL"}};class ja extends h{static get name(){return"audio"}static get dependencies(){return[i,u]}static get config(){return{browser:null}}init(){this._i18n(ia),this._tag({name:"audio",group:"audio",attributes:["controls","src"],empty:!0,navigable:!0}),new fa(this._editor),this._editor.config.audio.browser?this._editor.dialogs.set(new w(this._editor,"audio",this._editor.config.audio.browser)):this._editor.dialogs.set(new ea(this._editor)),this._command("audio"),this._toolbar("Audio")}}class ka extends p{constructor(a){super(a,"block")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Block")})),a.appendChild(this._createInput("id","text",this._("ID"),{required:"required"}))}}class la extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}get content(){return this.shadowRoot.innerHTML}set content(a){this.shadowRoot.innerHTML=a}}class ma extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("inserteditorblock",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("editor-block")).forEach(b=>b.id||b.parentElement.removeChild(b))}async inserteditorblock(a){if(a.detail.element.id){if(!this._editor.config.block.api)return}else{a.detail.element.parentElement.removeChild(a.detail.element);return}try{const b=await fetch(this._editor.config.block.api.replace("{id}",a.detail.element.id),{mode:"no-cors"});if(b.ok){let c="";this._editor.config.block.css&&(c=this._editor.config.block.css.split(",").map(e=>`<link rel="stylesheet" href="${e}">`).join(""));const d=await b.text();a.detail.element.content=c+d}}catch(b){this._editor.window.console.error(b)}}}const E={de:{Cancel:"Abbrechen",Height:"Höhe",Ifrane:"Iframe","Insert URL to embedded page":"URL zur eingebetteten Seite eingeben",Save:"Speichern",URL:"URL",Width:"Breite"}};class na extends h{static get name(){return"block"}static get dependencies(){return[i]}static get config(){return{api:null,browser:null,css:null}}init(){this._i18n(E),this._editor.registerElement("editor-block",la),this._tag({name:"editor-block",group:"block",attributes:["id"],deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),new ma(this._editor),this._editor.config.block.browser?this._editor.dialogs.set(new w(this._editor,"block",this._editor.config.block.browser)):this._editor.dialogs.set(new ka(this._editor)),this._command("editor-block"),this._toolbar("Block")}}class oa extends t{filter(a){a instanceof HTMLElement&&a.localName==="figure"&&a.classList.contains("quote")&&a.querySelector(":scope > blockquote")&&!a.querySelector(":scope > figcaption")&&(a.insertAdjacentElement("beforebegin",a.querySelector(":scope > blockquote")),a.innerHTML="")}}class pa extends m{constructor(a){super(a);this._editor.root.addEventListener("insertblockquote",this),this._editor.root.addEventListener("deleteblockquote",this)}insertblockquote(a){this._editor.wrap(a.detail.element,"figure",{attributes:{class:"quote"}})}deleteblockquote(a){a.detail.target.localName==="figure"&&a.detail.target.classList.contains("quote")&&a.detail.target.parentElement.removeChild(a.detail.target)}}class qa extends t{filter(a){if(a instanceof HTMLPreElement){a.outerHTML=a.outerHTML.replace(/(<br\s*\/?>)/gi,`
`);return}a.innerHTML=a.innerHTML.replace(/^\s*(<br\s*\/?>\s*)+/gi,"").replace(/\s*(<br\s*\/?>\s*)+$/gi,""),a instanceof HTMLParagraphElement?a.outerHTML=a.outerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"</p><p>"):a.innerHTML=a.innerHTML.replace(/\s*(<br\s*\/?>\s*){2,}/gi,"<br>")}}class x extends h{static get name(){return"break"}static get dependencies(){return[i]}init(){this._tag({name:"br",group:"break",empty:!0}),this._editor.filters.add(new qa(this._editor))}}const ra={de:{"Block Quote":"Blockzitat"}};class sa extends h{static get name(){return"blockquote"}static get dependencies(){return[i,x,u]}init(){this._i18n(ra),this._tag({name:"blockquote",group:"quote",children:["break","format"],deletable:!0,editable:!0,navigable:!0,enter:"p"}),new pa(this._editor),this._command("blockquote"),this._toolbar("Block Quote"),this._editor.filters.add(new oa(this._editor))}}const ta={de:{bold:"fett"}};class ua extends h{static get name(){return"bold"}static get dependencies(){return[i]}init(){this._i18n(ta),this._tag({name:"b",group:"format"}),this._command("b"),this._toolbar("bold","b",!0)}}const va={de:{Citation:"Zitatquelle"}};class wa extends h{static get name(){return"cite"}static get dependencies(){return[i]}init(){this._i18n(va),this._tag({name:"cite",group:"format"}),this._command("cite"),this._toolbar("Citation","z",!0)}}const xa={de:{Code:"Quelltext"}};class ya extends h{static get name(){return"code"}static get dependencies(){return[i]}init(){this._i18n(xa),this._tag({name:"code",group:"format"}),this._command("code"),this._toolbar("Code","c",!0)}}class za extends p{constructor(a){super(a,"data")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Data")})),a.appendChild(this._createInput("value","text",this._("Machine-readable Value"),{placeholder:this._("Insert value or leave empty to remove it")}))}}const Aa={de:{Cancel:"Abbrechen",Data:"Data","Machine-readable Value":"Maschinenlesbarer Wert","Insert value or leave empty to remove it":"Wert eingeben oder zum Entfernen leer lassen",Save:"Speichern"}};class Ba extends h{static get name(){return"data"}static get dependencies(){return[i]}init(){this._i18n(Aa),this._tag({name:"data",group:"format",attributes:["value"]}),this._editor.dialogs.set(new za(this._editor)),this._command("data"),this._toolbar("Data","j",!0)}}const Ca={de:{Definition:"Definition"}};class Da extends h{static get name(){return"definition"}static get dependencies(){return[i]}init(){this._i18n(Ca),this._tag({name:"dfn",group:"format"}),this._command("dfn"),this._toolbar("Definition","d",!0)}}const Ea={de:{"Text Deletion":"Textlöschung"}};class Fa extends h{static get name(){return"deletion"}static get dependencies(){return[i]}init(){this._i18n(Ea),this._tag({name:"del",group:"format"}),this._command("del"),this._toolbar("Text Deletion","g",!0)}}class Ga extends t{filter(a){a.querySelectorAll("summary:not(:first-child)").forEach(b=>b.parentElement.removeChild(b)),a.querySelectorAll("summary:only-child").forEach(b=>b.parentElement.removeChild(b))}}class Ha extends m{constructor(a){super(a);this._editor.root.addEventListener("insertdetails",this),this._editor.root.addEventListener("insertsummary",this)}insertdetails(a){a.detail.element.open=!0,a.detail.element.querySelector(":scope > summary:first-child")||a.detail.element.insertAdjacentElement("afterbegin",this._editor.createElement("summary"))}insertsummary(a){this.__empty(a.detail.element),a.detail.element.addEventListener("blur",this),a.detail.element.addEventListener("keydown",this)}blur(a){this.__empty(a.target)}keydown(a){this._editor.isKey(a," ")?(a.preventDefault(),a.stopPropagation(),this._editor.insertText(" ")):this._editor.isKey(a,"Enter")&&(a.preventDefault(),a.stopPropagation(),a.target.parentElement.open=!0)}__empty(a){a.textContent.trim()?a.querySelectorAll("br:not(:last-child)").forEach(b=>b.parentElement.removeChild(b)):a.textContent=this._editor.translator.translate("details","Details"),a.lastElementChild instanceof HTMLBRElement||a.appendChild(this._editor.createElement("br"))}}const Ia={de:{Details:"Details"}};class Ja extends h{static get name(){return"details"}static get dependencies(){return[i]}init(){this._i18n(Ia),this._tag({name:"details",group:"container",children:["audio","figure","iframe","image","list","paragraph","preformat","quote","rule","summary","table","video"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._tag({name:"summary",group:"summary",editable:!0,navigable:!0,enter:"p"}),new Ha(this._editor),this._command("details"),this._toolbar("Details"),this._editor.filters.add(new Ga(this._editor))}}class Ka extends p{constructor(a){super(a,"division")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Division")})),a.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}}const La={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse",Division:"Division","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern"}};class Ma extends h{static get name(){return"division"}static get dependencies(){return[i]}init(){this._i18n(La),this._tag({name:"div",group:"container",children:["audio","block","figure","iframe","image","preformat","quote","rule","table","video"],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._editor.dialogs.set(new Ka(this._editor)),this._command("div"),this._toolbar("Division")}}const Na={de:{emphasized:"betont"}};class Oa extends h{static get name(){return"emphasis"}static get dependencies(){return[i]}init(){this._i18n(Na),this._tag({name:"em",group:"format"}),this._command("em"),this._toolbar("emphasized","e",!0)}}const Pa={de:{Heading:"Überschrift"}};class Qa extends h{static get name(){return"heading"}static get dependencies(){return[i]}init(){this._i18n(Pa),this._tag({name:"h2",group:"heading",deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"p"}),this._command("h2"),this._toolbar("Heading")}}const Ra={de:{"Horizontal Rule":"Horizontale Linie"}};class Sa extends h{static get name(){return"horizontalrule"}static get dependencies(){return[i]}init(){this._i18n(Ra),this._tag({name:"hr",group:"rule",deletable:!0,empty:!0,focusable:!0,navigable:!0,sortable:!0}),this._command("hr"),this._toolbar("Horizontal Rule")}}class Ta extends p{constructor(a){super(a,"iframe")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Iframe")})),a.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to embedded page"),required:"required"})),a.appendChild(this._createInput("width","number",this._("Width"))),a.appendChild(this._createInput("height","number",this._("Height")))}}class Ua extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("insertiframe",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("iframe")).forEach(b=>this.__init(b))}insertiframe(a){this.__init(a.detail.element)}__init(a){const b=a.getAttribute("src");b?(a.setAttribute("src",this._editor.url(b)),a.allowFullscreen=!0,this._editor.wrap(a,"figure",{attributes:{class:"iframe"}})):a.parentElement.removeChild(a)}}class Va extends h{static get name(){return"iframe"}static get dependencies(){return[i,u]}static get config(){return{browser:null}}init(){this._i18n(E),this._tag({name:"iframe",group:"iframe",attributes:["allowfullscreen","height","src","width"],empty:!0,navigable:!0}),new Ua(this._editor),this._editor.config.iframe.browser?this._editor.dialogs.set(new w(this._editor,"iframe",this._editor.config.iframe.browser)):this._editor.dialogs.set(new Ta(this._editor)),this._command("iframe"),this._toolbar("Iframe")}}class Wa extends p{constructor(a){super(a,"image")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Image")})),a.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to image"),required:"required"})),a.appendChild(this._createInput("alt","text",this._("Alternative text"),{placeholder:this._("Replacement text for use when media elements are not available")})),a.appendChild(this._createInput("width","number",this._("Width"))),a.appendChild(this._createInput("height","number",this._("Height")))}}class Xa extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("insertimg",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("img")).forEach(b=>this.__init(b))}insertimg(a){this.__init(a.detail.element)}__init(a){const b=a.getAttribute("src");b?(a.setAttribute("src",this._editor.url(b)),this._editor.wrap(a,"figure",{attributes:{class:"image"}})):a.parentElement.removeChild(a)}}const Ya={de:{"Alternative text":"Alternativtext",Cancel:"Abbrechen",Height:"Höhe",Image:"Bild","Insert URL to image":"URL zur Bilddatei eingeben","Replacement text for use when media elements are not available":"Ersatztext, falls Medienelemente nicht verfügbar sind",Save:"Speichern",URL:"URL",Width:"Breite"}};class Za extends h{static get name(){return"image"}static get dependencies(){return[i,u]}static get config(){return{browser:null}}init(){this._i18n(Ya),this._tag({name:"img",group:"image",attributes:["alt","height","src","width"],empty:!0,navigable:!0}),new Xa(this._editor),this._editor.config.image.browser?this._editor.dialogs.set(new w(this._editor,"image",this._editor.config.image.browser)):this._editor.dialogs.set(new Wa(this._editor)),this._command("img"),this._toolbar("Image")}}const _a={de:{"Text Insertion":"Texteinfügung"}};class $a extends h{static get name(){return"insertion"}static get dependencies(){return[i]}init(){this._i18n(_a),this._tag({name:"ins",group:"format"}),this._command("ins"),this._toolbar("Text Insertion","f",!0)}}const ab={de:{italic:"kursiv"}};class bb extends h{static get name(){return"italic"}static get dependencies(){return[i]}init(){this._i18n(ab),this._tag({name:"i",group:"format"}),this._command("i"),this._toolbar("italic","i",!0)}}const cb={de:{"User Input":"Benutzereingabe"}};class db extends h{static get name(){return"keyboard"}static get dependencies(){return[i]}init(){this._i18n(cb),this._tag({name:"kbd",group:"format"}),this._command("kbd"),this._toolbar("User Input","k",!0)}}class eb extends p{constructor(a){super(a,"link")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Link")})),a.appendChild(this._createInput("href","text",this._("URL"),{pattern:"(https?|/|mailto:).+",placeholder:this._("Insert URL to add a link or leave empty to unlink")}))}}class fb extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("inserta",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("a")).forEach(b=>this.__init(b))}inserta(a){this.__init(a.detail.element)}__init(a){const b=a.getAttribute("href");b?a.setAttribute("href",this._editor.url(b)):a.parentElement.replaceChild(this._editor.createText(a.textContent),a)}}const gb={de:{Cancel:"Abbrechen","Insert URL to add a link or leave empty to unlink":"URL zum Verlinken eingeben oder zum Entfernen leer lassen",Link:"Link",Save:"Speichern",URL:"URL"}};class hb extends h{static get name(){return"link"}static get dependencies(){return[i]}init(){this._i18n(gb),this._tag({name:"a",group:"format",attributes:["href"]}),new fb(this._editor),this._editor.dialogs.set(new eb(this._editor)),this._command("a"),this._toolbar("Link","l",!0)}}const ib={de:{mark:"markiert"}};class jb extends h{static get name(){return"mark"}static get dependencies(){return[i]}init(){this._i18n(ib),this._tag({name:"mark",group:"format"}),this._command("mark"),this._toolbar("mark","m",!0)}}class kb extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("insertli",this),this._editor.root.addEventListener("deleteli",this),this._editor.root.addEventListener("insertol",this),this._editor.root.addEventListener("insertul",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("li")).forEach(b=>this.__init(b))}insertli(a){this.__init(a.detail.element)}deleteli(a){a.detail.target.children.length===0&&a.detail.target.parentElement.removeChild(a.detail.target)}insertol(a){a.detail.element.children.length===0&&a.detail.element.appendChild(this._editor.createElement("li"))}insertul(a){this.insertol(a)}__init(a){!(a.parentElement instanceof HTMLOListElement)&&!(a.parentElement instanceof HTMLUListElement)&&this._editor.wrap(a,"ul")}}class F extends h{static get name(){return"list"}static get dependencies(){return[i,x]}init(){this._tag({name:"li",group:"listitem",children:["break","format"],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"li"}),new kb(this._editor)}}const lb={de:{"Ordered List":"Geordnete Liste"}};class mb extends h{static get name(){return"orderedlist"}static get dependencies(){return[i,F]}init(){this._i18n(lb),this._tag({name:"ol",group:"list",children:["listitem"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command("ol"),this._toolbar("Ordered List")}}class nb extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("insertp",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("p")).forEach(b=>this.__init(b))}insertp(a){this.__init(a.detail.element)}__init(a){a.addEventListener("paste",this)}paste(a){this._editor.window.setTimeout(()=>this._editor.filters.filter(a.target))}}const ob={de:{Paragraph:"Absatz"}};class pb extends h{static get name(){return"paragraph"}static get dependencies(){return[i,x]}init(){this._i18n(ob),this._tag({name:"p",group:"paragraph",children:["break","format"],deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"p"}),new nb(this._editor),this._command("p"),this._toolbar("Paragraph")}}class qb extends t{filter(a){a instanceof HTMLElement&&a.localName==="figure"&&a.classList.contains("preformat")&&a.querySelector(":scope > pre")&&!a.querySelector(":scope > figcaption")&&(a.insertAdjacentElement("beforebegin",a.querySelector(":scope > pre")),a.innerHTML="")}}class rb extends m{constructor(a){super(a);this._editor.root.addEventListener("insertpre",this),this._editor.root.addEventListener("deletepre",this)}insertpre(a){this._editor.wrap(a.detail.element,"figure",{attributes:{class:"preformat"}})}deletepre(a){a.detail.target.localName==="figure"&&a.detail.target.classList.contains("preformat")&&a.detail.target.parentElement.removeChild(a.detail.target)}}const sb={de:{"Preformatted Text":"Vorformatierter Text"}};class tb extends h{static get name(){return"preformat"}static get dependencies(){return[i,x,u]}init(){this._i18n(sb),this._tag({name:"pre",group:"preformat",children:["break"],deletable:!0,editable:!0,navigable:!0,enter:"p"}),new rb(this._editor),this._command("pre"),this._toolbar("Preformatted Text"),this._editor.filters.add(new qb(this._editor))}}const ub={de:{Quote:"Zitat"}};class vb extends h{static get name(){return"quote"}static get dependencies(){return[i]}init(){this._i18n(ub),this._tag({name:"q",group:"format"}),this._command("q"),this._toolbar("Quote","q",!0)}}const wb={de:{"Sample Output":"Beispielausgabe"}};class xb extends h{static get name(){return"sample"}static get dependencies(){return[i]}init(){this._i18n(wb),this._tag({name:"samp",group:"format"}),this._command("samp"),this._toolbar("Sample Output","o",!0)}}class yb extends p{constructor(a){super(a,"section")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Section")})),a.appendChild(this._createInput("class","text",this._("CSS class"),{placeholder:this._("Insert CSS class")}))}}const zb={de:{Cancel:"Abbrechen","CSS class":"CSS-Klasse","Insert CSS class":"CSS-Klasse eingeben",Save:"Speichern",Section:"Sektion"}};class Ab extends h{static get name(){return"section"}static get dependencies(){return[i]}init(){this._i18n(zb),this._tag({name:"section",group:"container",children:["audio","figure","heading","iframe","image","list","paragraph","preformat","quote","rule","table","video"],attributes:["class"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,slotable:!0,sortable:!0}),this._editor.dialogs.set(new yb(this._editor)),this._command("section"),this._toolbar("Section")}}const Bb={de:{small:"klein"}};class Cb extends h{static get name(){return"small"}static get dependencies(){return[i]}init(){this._i18n(Bb),this._tag({name:"small",group:"format"}),this._command("small"),this._toolbar("small","w",!0)}}const Db={de:{strikethrough:"durchgestrichen"}};class Eb extends h{static get name(){return"strikethrough"}static get dependencies(){return[i]}init(){this._i18n(Db),this._tag({name:"s",group:"format"}),this._command("s"),this._toolbar("strikethrough","r",!0)}}const Fb={de:{"strongly emphasized":"stark betont"}};class Gb extends h{static get name(){return"strong"}static get dependencies(){return[i]}init(){this._i18n(Fb),this._tag({name:"strong",group:"format"}),this._command("strong"),this._toolbar("strongly emphasized","s",!0)}}const Hb={de:{Subheading:"Unterüberschrift"}};class Ib extends h{static get name(){return"subheading"}static get dependencies(){return[i]}init(){this._i18n(Hb),this._tag({name:"h3",group:"heading",deletable:!0,editable:!0,focusable:!0,navigable:!0,sortable:!0,enter:"p"}),this._command("h3"),this._toolbar("Subheading")}}const Jb={de:{subscript:"tiefgestellt"}};class Kb extends h{static get name(){return"subscript"}static get dependencies(){return[i]}init(){this._i18n(Jb),this._tag({name:"sub",group:"format"}),this._command("sub"),this._toolbar("subscript","x",!0)}}const Lb={de:{superscript:"hochgestellt"}};class Mb extends h{static get name(){return"superscript"}static get dependencies(){return[i]}init(){this._i18n(Lb),this._tag({name:"sup",group:"format"}),this._command("sup"),this._toolbar("superscript","y",!0)}}class Nb extends y{constructor(a){super(a,"table","table")}_insert({rows:a=1,cols:b=1}={}){a=a>1?a:1,b=b>1?b:1;const c=this._editor.createElement("figure",{attributes:{class:"table"}}),d=this._editor.createElement("table"),e=this._editor.createElement("tbody");for(let j=0;j<a;j++){const f=this._editor.createElement("tr");e.appendChild(f);for(let g=0;g<b;++g)f.appendChild(this._editor.createElement("td"))}d.appendChild(e),c.appendChild(d),this._editor.insert(c)}}class Ob extends p{constructor(a){super(a,"table")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Table")})),a.appendChild(this._createInput("rows","number",this._("Rows"),{min:"1",required:"required",value:"1"})),a.appendChild(this._createInput("cols","number",this._("Columns"),{min:"1",required:"required",value:"1"}))}}class Pb extends t{filter(a){a instanceof HTMLElement&&a.localName==="figure"&&a.classList.contains("table")&&a.querySelector(":scope > table")&&!a.querySelector(":scope > figcaption")?(a.insertAdjacentElement("beforebegin",a.querySelector(":scope > table")),a.innerHTML=""):a instanceof HTMLTableElement&&a.querySelector(":scope > thead, :scope > tfoot")&&!a.querySelector(":scope > tbody")?a.innerHTML="":a instanceof HTMLTableSectionElement&&a.rows.length<=0?a.innerHTML="":a instanceof HTMLTableRowElement&&!a.querySelector(":scope > th:not(:empty), :scope > td:not(:empty)")&&(a.innerHTML="")}}class Qb extends m{constructor(a){super(a);this._editor.root.addEventListener("inserttable",this),this._editor.root.addEventListener("inserttd",this),this._editor.root.addEventListener("insertth",this)}inserttable(a){this._editor.wrap(a.detail.element,"figure",{attributes:{class:"table"}}),a.detail.element.tBodies.length>0&&a.detail.element.tBodies[0].rows[0]&&(!a.detail.element.tHead||!a.detail.element.tFoot)&&(a.detail.element.tHead||this.__row(a.detail.element.createTHead(),a.detail.element.tBodies[0].rows[0].cells.length),a.detail.element.tFoot||this.__row(a.detail.element.createTFoot(),a.detail.element.tBodies[0].rows[0].cells.length))}inserttd(a){a.detail.element.addEventListener("keydown",this)}insertth(a){a.detail.element.addEventListener("keydown",this)}keydown(a){const b=a.target,c=b.parentElement,d=c.parentElement,e=d instanceof HTMLTableElement?d:d.parentElement,j=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],f=this._editor.isKey(a,j),g=this._editor.isKey(a,j,{ctrl:!0}),n=this._editor.isKey(a,j,{alt:!0}),q=this._editor.isKey(a,j,{alt:!0,shift:!0});if(b instanceof HTMLTableCellElement&&c instanceof HTMLTableRowElement&&(d instanceof HTMLTableElement||d instanceof HTMLTableSectionElement)&&e instanceof HTMLTableElement&&(f&&this.__enabled(b,a.key)||g||n||q)){const k=b.cellIndex,o=c.cells.length,s=d.rows.length,r=d instanceof HTMLTableElement?c.rowIndex:c.sectionRowIndex,A=k===0,B=k===o-1,fc=r===0,gc=r===s-1,G=c.rowIndex===0,H=c.rowIndex===e.rows.length-1;a.preventDefault(),a.stopPropagation(),f?a.key==="ArrowLeft"&&!A?this._editor.focusEnd(c.cells[k-1]):a.key==="ArrowLeft"&&G?this._editor.focusEnd(e.rows[e.rows.length-1].cells[o-1]):a.key==="ArrowLeft"?this._editor.focusEnd(e.rows[c.rowIndex-1].cells[o-1]):a.key==="ArrowRight"&&!B?c.cells[k+1].focus():a.key==="ArrowRight"&&H?e.rows[0].cells[0].focus():a.key==="ArrowRight"?e.rows[c.rowIndex+1].cells[0].focus():a.key==="ArrowUp"&&G?e.rows[e.rows.length-1].cells[k].focus():a.key==="ArrowUp"?e.rows[c.rowIndex-1].cells[k].focus():a.key==="ArrowDown"&&H?e.rows[0].cells[k].focus():a.key==="ArrowDown"&&e.rows[c.rowIndex+1].cells[k].focus():g?(a.key==="ArrowLeft"&&o>1&&A?Array.from(e.rows).forEach(l=>l.appendChild(l.cells[k])):a.key==="ArrowLeft"&&o>1?Array.from(e.rows).forEach(l=>l.insertBefore(l.cells[k],l.cells[k-1])):a.key==="ArrowRight"&&o>1&&B?Array.from(e.rows).forEach(l=>l.insertBefore(l.cells[k],l.cells[0])):a.key==="ArrowRight"&&o>1?Array.from(e.rows).forEach(l=>l.insertBefore(l.cells[k+1],l.cells[k])):a.key==="ArrowUp"&&s>1&&fc?d.appendChild(c):a.key==="ArrowUp"&&s>1?d.insertBefore(c,d.rows[r-1]):a.key==="ArrowDown"&&s>1&&gc?d.insertBefore(c,d.rows[0]):a.key==="ArrowDown"&&s>1&&d.insertBefore(d.rows[r+1],c),b.focus()):n?a.key==="ArrowLeft"?Array.from(e.rows).forEach(l=>this.__cell(l,l.cells[k])):a.key==="ArrowRight"?Array.from(e.rows).forEach(l=>this.__cell(l,l.cells[k+1])):a.key==="ArrowUp"?this.__row(d,o,r):a.key==="ArrowDown"&&this.__row(d,o,r+1):q&&(a.key==="ArrowLeft"&&!A?Array.from(e.rows).forEach(l=>l.deleteCell(k-1)):a.key==="ArrowRight"&&!B?Array.from(e.rows).forEach(l=>l.deleteCell(k+1)):a.key==="ArrowUp"&&r>0?d.deleteRow(r-1):a.key==="ArrowDown"&&r<s-1&&d.deleteRow(r+1))}}__row(a,b,c=0){const d=a.insertRow(c);for(let e=0;e<b;e++)this.__cell(d)}__cell(a,b=null){const c=a.parentElement.localName==="thead"?"th":"td";a.insertBefore(this._editor.createElement(c),b)}__enabled(a,b){if(["ArrowUp","ArrowDown"].includes(b))return!0;const c=this._editor.window.getSelection();if(!c.isCollapsed)return!1;if(b==="ArrowLeft"){const e=a.firstChild instanceof HTMLElement?a.firstChild.firstChild:a.firstChild;return c.anchorOffset===0&&[a,e].includes(c.anchorNode)}let d=a.lastChild;return a.lastChild instanceof HTMLBRElement&&a.lastChild.previousSibling&&(d=a.lastChild.previousSibling),d instanceof HTMLElement&&(d=d.lastChild),c.anchorOffset===c.anchorNode.textContent.length&&[a,d].includes(c.anchorNode)}}const Rb={de:{Cancel:"Abbrechen",Columns:"Spalten",Rows:"Zeilen",Save:"Speichern",Table:"Tabelle"}};class Sb extends h{static get name(){return"table"}static get dependencies(){return[i,x,u]}init(){this._i18n(Rb),this._tag({name:"table",group:"table",children:["tablesection"],deletable:!0,navigable:!0}),this._tag({name:"thead",group:"tablesection",children:["tablerow"]}),this._tag({name:"tbody",group:"tablesection",children:["tablerow"]}),this._tag({name:"tfoot",group:"tablesection",children:["tablerow"]}),this._tag({name:"tr",group:"tablerow",children:["tablecell"]}),this._tag({name:"th",group:"tablecell",children:["break","format"],editable:!0,empty:!0}),this._tag({name:"td",group:"tablecell",children:["break","format"],editable:!0,empty:!0}),new Qb(this._editor),this._editor.filters.add(new Pb(this._editor)),this._editor.dialogs.set(new Ob(this._editor)),this._editor.commands.set(new Nb(this._editor)),this._toolbar("Table")}}class Tb extends p{constructor(a){super(a,"time")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Time")})),a.appendChild(this._createInput("datetime","text",this._("Machine-readable Datetime"),{placeholder:this._("Insert date and/or time or leave empty to remove it")}))}}const Ub={de:{Cancel:"Abbrechen","Machine-readable Datetime":"Maschinenlesbare Datums-/Zeitangabe","Insert date and/or time or leave empty to remove it":"Datum und/oder Zeit eingeben oder zum Entfernen leer lassen",Save:"Speichern",Time:"Zeit"}};class Vb extends h{static get name(){return"time"}static get dependencies(){return[i]}init(){this._i18n(Ub),this._tag({name:"time",group:"format",attributes:["datetime"]}),this._editor.dialogs.set(new Tb(this._editor)),this._command("time"),this._toolbar("Time","t",!0)}}const Wb={de:{underline:"unterstrichen"}};class Xb extends h{static get name(){return"underline"}static get dependencies(){return[i]}init(){this._i18n(Wb),this._tag({name:"u",group:"format"}),this._command("u"),this._toolbar("underline","u",!0)}}const Yb={de:{"Unordered List":"Ungeordnete Liste"}};class Zb extends h{static get name(){return"unorderedlist"}static get dependencies(){return[i,F]}init(){this._i18n(Yb),this._tag({name:"ul",group:"list",children:["listitem"],arbitrary:!0,deletable:!0,focusable:!0,navigable:!0,sortable:!0}),this._command("ul"),this._toolbar("Unordered List")}}const _b={de:{Variable:"Variable"}};class $b extends h{static get name(){return"variable"}static get dependencies(){return[i]}init(){this._i18n(_b),this._tag({name:"var",group:"format"}),this._command("var"),this._toolbar("Variable","v",!0)}}class ac extends p{constructor(a){super(a,"video")}_initFieldset(a){a.appendChild(this._editor.createElement("legend",{html:this._("Video")})),a.appendChild(this._createInput("src","text",this._("URL"),{pattern:"(https?|/).+",placeholder:this._("Insert URL to video"),required:"required"})),a.appendChild(this._createInput("width","number",this._("Width"))),a.appendChild(this._createInput("height","number",this._("Height")))}}class bc extends m{constructor(a){super(a);this._editor.root.addEventListener("sethtml",this),this._editor.root.addEventListener("insertvideo",this)}sethtml(a){Array.from(a.detail.element.getElementsByTagName("video")).forEach(b=>this.__init(b))}insertvideo(a){this.__init(a.detail.element)}__init(a){const b=a.getAttribute("src");b?(a.setAttribute("src",this._editor.url(b)),a.controls=!0,this._editor.wrap(a,"figure",{attributes:{class:"video"}})):a.parentElement.removeChild(a)}}const cc={de:{Cancel:"Abbrechen",Height:"Höhe","Insert URL to video":"URL zur Videodatei eingeben",Save:"Speichern",URL:"URL",Video:"Video",Width:"Breite"}};class dc extends h{static get name(){return"video"}static get dependencies(){return[i,u]}static get config(){return{browser:null}}init(){this._i18n(cc),this._tag({name:"video",group:"video",attributes:["controls","height","src","width"],empty:!0,navigable:!0}),new bc(this._editor),this._editor.config.video.browser?this._editor.dialogs.set(new w(this._editor,"video",this._editor.config.video.browser)):this._editor.dialogs.set(new ac(this._editor)),this._command("video"),this._toolbar("Video")}}class ec extends v{static get defaultConfig(){return{base:{plugins:[ua,bb,Gb,Oa,Xb,Eb,hb,jb,Cb,Da,da,vb,wa,ya,db,xb,$b,Kb,Mb,Vb,Ba,$a,Fa,pb,Qa,Ib,Zb,mb,Sa,sa,Za,dc,ja,Va,Sb,tb,Ab,Ja,Ma,na]}}}}export default ec;
